var oldGWTK=window.GWTK,GWTK={version:"1.6.0",restoreGWTK:function(){window.GWTK=oldGWTK;return this}};window.GWTK=GWTK;window.GWTK&&(GWTK.DomEvent={addListener:function(a,b,c,d){},removeListener:function(a,b,c){},stopPropagation:function(a){a.stopPropagation?a.stopPropagation():a.cancelBubble=!0;return this},preventDefault:function(a){a.preventDefault?a.preventDefault():a.returnValue=!1;return this},stop:function(a){return GWTK.DomEvent.preventDefault(a).stopPropagation(a)},getMousePosition:function(a,b){var c=a.clientX?a.clientX:a.originalEvent.clientX,d=a.clientY?a.clientY:a.originalEvent.clientY;if(!b)return new GWTK.Point(c,
d);var e=b.getBoundingClientRect();return new GWTK.Point(Math.floor(c-e.left-b.clientLeft),Math.floor(d-e.top-b.clientTop))},getWheelDelta:function(a){var b=0;a.originalEvent.wheelDelta?b=a.originalEvent.wheelDelta/120:a.originalEvent.detail?b=-a.originalEvent.detail/3:a.originalEvent.deltaY&&(b=-a.originalEvent.deltaY/3);b!=Math.round(b)&&(0<b?b=1:b=-1);return b},getMouseGeoCoordinates:function(a){a&&(a=GWTK.DomEvent.getMousePosition(a,GWTK.maphandlers.map.panes.eventPane),a=GWTK.maphandlers.map.tiles.getLayersPointProjected(a),
a=GWTK.projection.xy2geo(GWTK.maphandlers.map.options.crs,a.y,a.x),a=GWTK.toLatLng(a),a=a.toDegreesMinutesSecondsString(),$(GWTK.maphandlers.map.panes.coordPane).html(a))},_getEvent:function(){var a=window.event;if(!a)for(var b=arguments.callee.caller;b&&!((a=b.arguments[0])&&window.Event===a.constructor);)b=b.caller;return a}},GWTK.DomEvent.on=GWTK.DomEvent.addListener,GWTK.DomEvent.off=GWTK.DomEvent.removeListener);GWTK.DomUtil={get:function(a){return"string"===typeof a?document.getElementById(a):a},getStyle:function(a,b){var c=a.style[b];!c&&a.currentStyle&&(c=a.currentStyle[b]);if((!c||"auto"===c)&&document.defaultView)c=(c=document.defaultView.getComputedStyle(a,null))?c[b]:null;return"auto"===c?null:c},getViewportOffset:function(a){var b=0,c=0,d=a,e=document.body,f=document.documentElement,g;do{b+=d.offsetTop||0;c+=d.offsetLeft||0;b+=parseInt(GWTK.DomUtil.getStyle(d,"borderTopWidth"),10)||0;c+=parseInt(GWTK.DomUtil.getStyle(d,
"borderLeftWidth"),10)||0;g=GWTK.DomUtil.getStyle(d,"position");if(d.offsetParent===e&&"absolute"===g)break;if("fixed"===g){b+=e.scrollTop||f.scrollTop||0;c+=e.scrollLeft||f.scrollLeft||0;break}if("relative"===g&&!d.offsetLeft){g=L.DomUtil.getStyle(d,"width");var m=L.DomUtil.getStyle(d,"max-width"),h=d.getBoundingClientRect();if("none"!==g||"none"!==m)c+=h.left+d.clientLeft;b+=h.top+(e.scrollTop||f.scrollTop||0);break}d=d.offsetParent}while(d);d=a;do{if(d===e)break;b-=d.scrollTop||0;c-=d.scrollLeft||
0;d=d.parentNode}while(d);return new GWTK.Point(c,b)},documentIsLtr:function(){GWTK.DomUtil._docIsLtrCached||(GWTK.DomUtil._docIsLtrCached=!0,GWTK.DomUtil._docIsLtr="ltr"===GWTK.DomUtil.getStyle(document.body,"direction"));return GWTK.DomUtil._docIsLtr},create:function(a,b,c){a=document.createElement(a);b&&0<b.length&&(a.className=b);c&&c.appendChild(a);return a},hasClass:function(a,b){if(void 0!==a.classList)return a.classList.contains(b);var c=GWTK.DomUtil._getClass(a);return 0<c.length&&RegExp("(^|\\s)"+
b+"(\\s|$)").test(c)},addClass:function(a,b){if(void 0!==a.classList)for(var c=GWTK.Util.splitWords(b),d=0,e=c.length;d<e;d++)a.classList.add(c[d]);else GWTK.DomUtil.hasClass(a,b)||(c=GWTK.DomUtil._getClass(a),GWTK.DomUtil._setClass(a,(c?c+" ":"")+b))},removeClass:function(a,b){void 0!==a.classList?a.classList.remove(b):GWTK.DomUtil._setClass(a,GWTK.Util.trim((" "+GWTK.DomUtil._getClass(a)+" ").replace(" "+b+" "," ")))},_setClass:function(a,b){void 0===a.className.baseVal?a.className=b:a.className.baseVal=
b},_getClass:function(a){return void 0===a.className.baseVal?a.className:a.className.baseVal},setOpacity:function(a,b){if("opacity"in a.style)a.style.opacity=b;else if("filter"in a.style){var c=!1;try{c=a.filters.item("DXImageTransform.Microsoft.Alpha")}catch(d){if(1===b)return}b=Math.round(100*b);c?(c.Enabled=100!==b,c.Opacity=b):a.style.filter+=" progid:DXImageTransform.Microsoft.Alpha(opacity="+b+")"}},testProp:function(a){for(var b=document.documentElement.style,c=0;c<a.length;c++)if(a[c]in b)return a[c];
return!1},getTranslateString:function(a){var b=L.Browser.webkit3d;return"translate"+(b?"3d":"")+"("+a.x+"px,"+a.y+"px"+((b?",0":"")+")")},getScaleString:function(a,b){return GWTK.DomUtil.getTranslateString(b.add(b.multiplyBy(-1*a)))+(" scale("+a+") ")},setPosition:function(a,b){null==b||void 0==b||(a._pos=b,a.style.left=b.x+"px",a.style.top=b.y+"px")},getPosition:function(a){return a._pos}};GWTK.DomUtil.TRANSFORM=GWTK.DomUtil.testProp(["transform","WebkitTransform","OTransform","MozTransform","msTransform"]);
GWTK.DomUtil.TRANSITION=GWTK.DomUtil.testProp(["webkitTransition","transition","OTransition","MozTransition","msTransition"]);GWTK.DomUtil.TRANSITION_END="webkitTransition"===GWTK.DomUtil.TRANSITION||"OTransition"===GWTK.DomUtil.TRANSITION?GWTK.DomUtil.TRANSITION+"End":"transitionend";window.GWTK&&(GWTK.LatLng=function(a,b,c){a=parseFloat(a);b=parseFloat(b);if(isNaN(a)||isNaN(b))throw Error("Invalid LatLng object: (NaN, NaN)");this.lat=a;this.lng=b;void 0!==c&&(this.alt=parseFloat(c));this.DEG_TO_RAD=Math.PI/180;this.RAD_TO_DEG=180/Math.PI;this.MAX_MARGIN=1E-9});
GWTK.LatLng.prototype={equals:function(a){if(!a)return!1;a=GWTK.toLatLng(a);return Math.max(Math.abs(this.lat-a.lat),Math.abs(this.lng-a.lng))<=GWTK.LatLng.MAX_MARGIN},toString:function(a){return GWTK.Util.formatNum(this.lat,a)+","+GWTK.Util.formatNum(this.lng,a)},distanceTo:function(a){a=GWTK.toLatLng(a);var b=this.DEG_TO_RAD,c=(a.lng-this.lng)*b,d=this.lat*b,e=a.lat*b;a=Math.sin((a.lat-this.lat)*b/2);c=Math.sin(c/2);d=a*a+c*c*Math.cos(d)*Math.cos(e);return 12756274*Math.atan2(Math.sqrt(d),Math.sqrt(1-
d))},wrap:function(a,b){var c=this.lng;a=a||-180;b=b||180;return new GWTK.LatLng(this.lat,(c+b)%(b-a)+(c<a||c===b?b:a))},toRadians:function(){return GWTK.toLatLng(this.lat*this.DEG_TO_RAD,this.lng*this.DEG_TO_RAD)},toDegreesMinutesSecondsString:function(){return"B = "+this.Degrees2DegreesMinutesSeconds(this.lat)+"   L = "+this.Degrees2DegreesMinutesSeconds(this.lng)},Degrees2DegreesMinutesSeconds:function(a){var b="",c=parseInt(a,10),b=60*(a-parseFloat(c));a=parseInt(b,10);var d=60*(b-parseFloat(a));
60<d+0.001&&(d=0,a+=1);parseInt(d,10);60<=a&&(a=0,c+=1);c%=360;0>c?(b="-",c=Math.abs(c)):b="";10>c?b+="00":100>c&&(b+="0");b=b+c.toString(10)+"\u00b0 ";a=Math.abs(a);10>a?b+="0"+a+"' ":b+=a+"' ";d=Math.abs(d);10>d&&(b+="0");return b+parseInt(d,10)+"''"}};
GWTK.toLatLng=function(a,b){return a instanceof GWTK.LatLng?a:void 0===a||null===a?null:GWTK.Util.isArray(a)?"number"===typeof a[0]||"string"===typeof a[0]?new GWTK.LatLng(a[0],a[1],a[2]):null:void 0===b?null:"object"===typeof a&&"lat"in a?new GWTK.LatLng(a.lat,"lng"in a?a.lng:a.lon):new GWTK.LatLng(a,b)};GWTK.LatLngBounds=function(a,b){if(a)for(var c=b?[a,b]:a,d=0,e=c.length;d<e;d++)this.extend(c[d])};
GWTK.LatLngBounds.prototype={extend:function(a){if(!a)return this;var b=GWTK.toLatLng(a);a=null!==b?b:GWTK.latLngBounds(a);a instanceof GWTK.LatLng?!this._southWest&&!this._northEast?(this._southWest=new GWTK.LatLng(a.lat,a.lng),this._northEast=new GWTK.LatLng(a.lat,a.lng)):(this._southWest.lat=Math.min(a.lat,this._southWest.lat),this._southWest.lng=Math.min(a.lng,this._southWest.lng),this._northEast.lat=Math.max(a.lat,this._northEast.lat),this._northEast.lng=Math.max(a.lng,this._northEast.lng)):
a instanceof GWTK.LatLngBounds&&(this.extend(a._southWest),this.extend(a._northEast));return this},pad:function(a){var b=this._southWest,c=this._northEast,d=Math.abs(b.lat-c.lat)*a;a*=Math.abs(b.lng-c.lng);return new L.LatLngBounds(new L.LatLng(b.lat-d,b.lng-a),new L.LatLng(c.lat+d,c.lng+a))},getCenter:function(){return new GWTK.LatLng((this._southWest.lat+this._northEast.lat)/2,(this._southWest.lng+this._northEast.lng)/2)},getSouthWest:function(){return this._southWest},getNorthEast:function(){return this._northEast},
getNorthWest:function(){return new GWTK.LatLng(this.getNorth(),this.getWest())},getSouthEast:function(){return new GWTK.LatLng(this.getSouth(),this.getEast())},getWest:function(){return this._southWest.lng},getSouth:function(){return this._southWest.lat},getEast:function(){return this._northEast.lng},getNorth:function(){return this._northEast.lat},contains:function(a){a="number"===typeof a[0]||a instanceof GWTK.LatLng?GWTK.latLng(a):GWTK.latLngBounds(a);var b=this._southWest,c=this._northEast,d;a instanceof
GWTK.LatLngBounds?(d=a.getSouthWest(),a=a.getNorthEast()):d=a;return d.lat>=b.lat&&a.lat<=c.lat&&d.lng>=b.lng&&a.lng<=c.lng},intersects:function(a){a=GWTK.latLngBounds(a);var b=this._southWest,c=this._northEast,d=a.getSouthWest();a=a.getNorthEast();var e=a.lng>=b.lng&&d.lng<=c.lng;return a.lat>=b.lat&&d.lat<=c.lat&&e},toBBoxString:function(){return[this.getWest(),this.getSouth(),this.getEast(),this.getNorth()].join()},equals:function(a){if(!a)return!1;a=GWTK.latLngBounds(a);return this._southWest.equals(a.getSouthWest())&&
this._northEast.equals(a.getNorthEast())},isValid:function(){return!(!this._southWest||!this._northEast)}};GWTK.latLngBounds=function(a,b){return!a||a instanceof GWTK.LatLngBounds?a:new GWTK.LatLngBounds(a,b)};window.GWTK&&(GWTK.placemark=function(a,b,c,d,e){this.latlong=GWTK.toLatLng(a);this.title=b;this.text=c;this.href=void 0!=d&&null!=d?d:GWTK.imgMarkerBlankRed;this.offset=GWTK.point(0,0);this.size=GWTK.point(30,50);this.origin=this.vertex=null;this.img=this.div="";this.imgSmall=GWTK.imgMarkerRedPoint;this.imgOrigin="";this.init();this.create()},GWTK.placemark.prototype={init:function(a){this.latlong=GWTK.toLatLng(this.latlong);if(void 0==this.title||null==this.title)this.title="";if(void 0==this.text||
null==this.text)this.text="";a=window.location.pathname;a.substring(0,a.lastIndexOf("/"));this.href=this.href;this.imgSmall=this.imgSmall;this.imgOrigin=this.href},create:function(a){a=document.createElement("div");var b=document.createElement("img");b.src=this.href;a.className="placemark";a.appendChild(b);this.div=a;this.img=b},position:function(a){if(!a)return a;var b=null;a instanceof GWTK.Point?b=new GWTK.Point(a.x,a.y):GWTK.Util.isArray(a)&&1<a.length&&(b=new GWTK.Point(a[0],a[1]));if(!b)return a;
this.origin=new GWTK.Point(b.x,b.y);void 0!=this.size&&null!=this.size&&(this.offset.x=-Math.round(this.size.x/2),this.offset.y=-this.size.y);b.x+=this.offset.x;b.y+=this.offset.y;GWTK.DomUtil.setPosition(this.div,b);return this.vertex=new GWTK.Point(b.x,b.y)},setSize:function(a){a&&(a instanceof GWTK.Point?this.size=a:GWTK.Util.isArray(a)&&(this.size=new GWTK.Point(a[0],a[1])))},toPoint:function(){return null===this.latlong?null:GWTK.point(this.latlong.lat,this.latlong.lng)},isgeopoint:function(){return null===
this.latlong?!1:!0},geopoint:function(){return this.div},setImage:function(a,b,c){if(!(void 0===b||null===b)){var d=10,e=10;b?(this.img.src=this.imgSmall,this.img.className="placemark-img-size-small",this.div.className="placemark"):(this.img.src=this.imgOrigin,$(this.img).removeClass("placemark-img-size-small"),$(this.img).addClass("placemark-img-size"),$(this.div).addClass("placemark-topmost"));c&&1<c.length?(d=c[0],e=c[1]):(d=parseInt($(this.img).css("width")),e=parseInt($(this.img).css("height")));
this.setSize([d,e]);this.vertex&&this.position(this.origin);void 0!=a&&a instanceof GWTK.Point&&this.position(a)}}});GWTK.browserSafariForiOS=navigator.userAgent.match(/(iPhone|iPad|iPod|Android|BlackBerry|webOS|IEMobile|Opera Mini)/);
GWTK.ScaleDenominatorGoogle=[5.590822640287178E8,2.795411320143589E8,1.397705660071794E8,6.988528300358972E7,3.494264150179486E7,1.747132075089743E7,8735660.375448715,4367830.187724357,2183915.093862179,1091957.546931089,545978.7734655447,272989.3867327723,136494.6933663862,68247.34668319309,34123.67334159654,17061.83667079827,8530.918335399136,4265.459167699568,2132.729583849784,1066.364791924891,533.1823959624459,266.59119798122293,133.29559899061147];
GWTK.ScaleDenominatorPixel=[7.951392199519541E8,3.975696099759771E8,1.987848049879885E8,1.325232033253257E8,6.626160166266284E7,3.313080083133142E7,1.325232033253257E7,6626160.166266284,3313080.083133142,1656540.041566571,552180.0138555235,331308.0083133142,110436.0027711047,55218.00138555237,33130.80083133142,11043.60027711047,3313.080083133142,1104.360027711047,552.1800138555237];
GWTK.ScaleDenominatorQuard=[5.590822640287178E8,2.795411320143589E8,1.397705660071794E8,6.988528300358972E7,3.494264150179486E7,1.747132075089743E7,8735660.375448715,4367830.187724357,2183915.093862179,1091957.546931089,545978.7734655447,272989.3867327723,136494.6933663862,68247.34668319309,34123.67334159654,17061.83667079827,8530.918335399136,4265.459167699568,2132.729583849784];GWTK.ScaleDenominatorScale=[5E8,25E7,1E8,5E7,25E6,1E7,5E6,25E5,1E6,5E5,25E4,1E5,5E4,25E3,1E4,5E3,2500,1E3,500];
GWTK.TileMatrixSets={GoogleMapsCompatible:{crs:"3857",scales:[5.590822640287178E8,2.795411320143589E8,1.397705660071794E8,6.988528300358972E7,3.494264150179486E7,1.747132075089743E7,8735660.375448715,4367830.187724357,2183915.093862179,1091957.546931089,545978.7734655447,272989.3867327723,136494.6933663862,68247.34668319309,34123.67334159654,17061.83667079827,8530.918335399136,4265.459167699568,2132.729583849784,1066.364791924891,533.1823959624459,266.59119798122293,133.29559899061147],topleft:{y:-2.003750834279E7,
x:2.003750834279E7}},"EPSG:3395":{crs:"3395",scales:[5.590822640287178E8,2.795411320143589E8,1.397705660071794E8,6.988528300358972E7,3.494264150179486E7,1.747132075089743E7,8735660.375448715,4367830.187724357,2183915.093862179,1091957.546931089,545978.7734655447,272989.3867327723,136494.6933663862,68247.34668319309,34123.67334159654,17061.83667079827,8530.918335399136,4265.459167699568,2132.729583849784,1066.364791924891,533.1823959624459,266.59119798122293,133.29559899061147],topleft:{y:-2.003750834279E7,
x:2.003750834279E7}},GlobalCRS84Scale:{crs:"4326",scales:[5E8,25E7,1E8,5E7,25E6,1E7,5E6,25E5,1E6,5E5,25E4,1E5,5E4,25E3,1E4,5E3,2500,1E3,500],topleft:{y:-180,x:90}}};GWTK.TileViewing=function(){this.screenScale=100;this.screenPrecision=4E3;this.metersPerUnit=111319.49079327358;this.originX=-2.0037508342789244E7;this.originY=2.0037508342789244E7;this.standardPixSizeOGC=0.28;this.standardPixelSize=2.8E-4};
GWTK.TileViewing.prototype={getScale:function(a,b){if(0===a)return a;if(!(b in GWTK.TileMatrixSets))return 0;for(var c=GWTK.TileMatrixSets[b].scales,d=this.screenScale,e=this.screenPrecision,f=1E3*d/(100*e),d=100*a/(d*e)/(standartPixSizeGis/1E3)/(this.standardPixSizeOGC/f),e=0,g,m=0,h=0;h<c.length;h++){var p=c[h]-d;0>p&&(m++,p*=-1);0==h&&(g=p);if(1<m)break;g>=p&&(g=p,e=h)}a=this.scaleDenominator[e];return 0.28*a/f},getpixelSpan:function(a,b){return null==a||0>=a?null:b?a*this.standardPixelSize/this.metersPerUnit:
a*this.standardPixelSize},getTileLayerData:function(a,b,c){if(null==b)return null;var d=4326==b.options.crs,e=GWTK.TileMatrixSets[b.options.tilematrixset];a=b.getZoomScale(a);a=this.getpixelSpan(a,d);if(null==a)return null;var f=256*a,g=256*a,m=e.topleft.y,h=e.topleft.x;90==parseInt(m,10)&&(m=e.topleft.y,h=e.topleft.x);e=null;e=void 0!=c?c:b.getMapTopLeft();c=e.x;e=e.y;d?(c.map.mapLatLngBounds.getWest(),e=b.mapLatLngBounds.getNorth(),b=(c-m)/f+1E-6,d=(h-e)/g+1E-6):(b=(c-m)/f-1E-6,d=(h-e)/g-1E-6);
m=parseInt((c-m)/a+1E-6,10);a=parseInt((h-e)/a+1E-6,10);h=256*(b-parseInt(b,10));g=256*(d-parseInt(d,10));return[parseInt(b,10),parseInt(d,10),h,g,m,a]},shiftTiles:function(a,b){if(void 0==b||null==b)return null;var c=256*a[0]+a[2]+b.x,d=256*a[1]+a[3]+b.y,e=parseFloat(c)/256,f=parseFloat(d)/256,g=256*(e-parseInt(e,10)),m=256*(f-parseInt(f,10));return[parseInt(e,10),parseInt(f,10),Math.round(g),Math.round(m),c,d]},tile2unit:function(a,b){if(null==b)return null;var c=GWTK.TileMatrixSets[b.options.tilematrixset],
d=this.getpixelSpan(c.scales[b.options.tilematrix],4326==b.options.crs);if(null==d)return null;var e=256*d,d=256*d,f=a[0]*e+c.topleft.y,c=c.topleft.x-(a[1]+1E-6)*d,f=f+e*(a[2]/256),c=c-d*(a[3]/256);return new GWTK.Point(f,c)},geo2pixelOffset:function(a,b){if(b){var c=GWTK.projection.geo2xy(a.options.crs,b.lat,b.lng),c=this.getTileLayerData(a.options.tilematrix,a,GWTK.point(c[1],c[0]));return a.tiles.getLayersPointOffset(c)}}};GWTK.tileViewing=function(){return new GWTK.TileViewing};
GWTK.MapsProjection=function(){this.tileSize=256;this.degreesToRadiansRatio=180/Math.PI;this.radiansToDegreesRatio=Math.PI/180;this.pixelGlobeCenter;this.xPixelsToDegreesRatio;this.yPixelsToRadiansRatio};
GWTK.MapsProjection.prototype={init:function(a){a=this.tileSize*Math.pow(2,a);this.xPixelsToDegreesRatio=a/360;this.yPixelsToRadiansRatio=a/(2*Math.PI);a/=2;this.pixelGlobeCenter=GWTK.point(a,a)},geo2Pixel:function(a){var b=Math.round(a.x*this.xPixelsToDegreesRatio-this.pixelGlobeCenter.x);Math.log(Math.tan(Math.PI/4+a.y*(Math.PI/180)/2));a=Math.min(Math.max(Math.sin(a.y*this.radiansToDegreesRatio),-0.9999),0.9999);a=Math.round(this.pixelGlobeCenter.y+0.5*Math.log((1+a)/(1-a))*-this.yPixelsToRadiansRatio);
return GWTK.point(parseInt(b),parseInt(a))},pixel2Geo:function(a){var b=(a.x-this.pixelGlobeCenter.x)/this.xPixelsToDegreesRatio;a=(2*Math.atan(Math.exp((a.y-this.pixelGlobeCenter.y)/-this.yPixelsToRadiansRatio))-Math.PI/2)*this.degreesToRadiansRatio;return GWTK.point(a,b)}};GWTK.featureinfo=function(a){null!=a&&(this.map=a,this.layers={},this.tilematrixset,this.style="default",this.format="image/jpg",this.tilematrix="",this.tilerow="#row",this.tilecol="#col",this.info_format="text/html",this.feature_count=-1,this.initialize())};
GWTK.featureinfo.prototype={initialize:function(){if(!1==this.map instanceof GWTK.Map)return this;this.options={layer:"",tilematrixset:"",style:"default",getid:"1",area:"1",length:"1",format:"image/jpg",tilematrix:"1",tilerow:0,tilecol:0,info_format:"text/xml",i:0,j:0,objlocal:"0,1,2,4"};return this},getOptions:function(a,b,c,d,e,f){if(null==a||null==this.map)return null;var g=this.options;g.layer=a;g.tilematrixset=this.map.options.tilematrixset;g.tilematrix=this.map.options.tilematrix;g.tilerow=
c;g.tilecol=b;g.i=d||0;g.j=e||0;null!=f&&(g.feature_count=f);return g}};GWTK.projections=function(){this.bigAxis=6378137;this.DEG_TO_RAD=Math.PI/180;this.RAD_TO_DEG=180/Math.PI};
GWTK.projections.prototype={geo2xy:function(a,b,c){return 3857===a||"3857"===a?this.geo2xy3857(b,c):3395===a||"3395"===a?this.geo2xy3395(b,c):4326===a||"4326"===a?this.geo2xy4326(b,c):null},xy2geo:function(a,b,c){return"3857"===a||3857===a?this.xy2geo3857(b,c):"3395"===a||3395===a?this.xy2geo3395(b,c):"4326"===a||4326===a?this.xy2geo4326(b,c):null},geo2xy4326:function(a,b){if(isNaN(a)||isNaN(b))return null;var c=this.DEG_TO_RAD;b*=c;return[parseFloat(a*c)*this.bigAxis,parseFloat(b)*this.bigAxis]},
xy2geo4326:function(a,b){return isNaN(a)||isNaN(b)?null:[parseFloat(a)/this.bigAxis,parseFloat(b)/this.bigAxis]},geo2xy3857:function(a,b){if(isNaN(a)||isNaN(b))return null;a=parseFloat(a);b=parseFloat(b);var c=this.DEG_TO_RAD,d=b*c*this.bigAxis,c=Math.tan(Math.PI/4+a*c/2);1E-6>c&&-1E-6<c&&(c=1E-6);return[Math.log(c)*this.bigAxis,d]},xy2geo3857:function(a,b){if(isNaN(a)||isNaN(b))return null;var c=parseFloat(-a)/this.bigAxis,c=Math.PI/2-2*Math.atan(Math.exp(c)),d=this.RAD_TO_DEG,c=c*d;l=parseFloat(b)/
this.bigAxis*d;return[c,l]},geo2xy3395:function(a,b){if(isNaN(a)||isNaN(b))return null;var c=1/298.257223563,d=2*c-c*c,c=Math.sqrt(d),e=parseFloat(d)*parseFloat(d),f=parseFloat(e)*parseFloat(d),g=parseFloat(f)*parseFloat(d);parseFloat(d);parseFloat(e);parseFloat(g);parseFloat(e);parseFloat(f);parseFloat(g);parseFloat(f);parseFloat(g);parseFloat(g);d=parseFloat(c)*Math.sin(parseFloat(a));d=(1-d)/(1+d);c=parseFloat(c)/2;d=Math.pow(d,c);d*=Math.tan(Math.PI/4+parseFloat(a)/2);1E-6>d&&-1E-6<d&&(d=1E-6);
c=this.DEG_TO_RAD;d=Math.log(d)*this.bigAxis*c;c*=parseFloat(b)*this.bigAxis;return[d,c]},xy2geo3395:function(a,b){if(isNaN(a)||isNaN(b))return null;var c=1/298.257223563,c=2*parseFloat(c)-parseFloat(c)*parseFloat(c);Math.sqrt(c);var d=parseFloat(c)*parseFloat(c),e=parseFloat(d)*parseFloat(c),f=parseFloat(e)*parseFloat(c),c=parseFloat(c)/2+5*parseFloat(d)/24+13*parseFloat(f)/360,d=7*parseFloat(d)/48+290*parseFloat(e)/240+811*parseFloat(f)/11520,e=7*parseFloat(e)/120+81*parseFloat(f)/1120,f=4279*parseFloat(f)/
161280,g=Math.exp(parseFloat(-a)/this.bigAxis),g=Math.PI/2-2*Math.atan(g),c=g+c*Math.sin(2*g)+d*Math.sin(4*g)+e*Math.sin(6*g)+f*Math.sin(8*g),d=parseFloat(b)/this.bigAxis,f=this.RAD_TO_DEG;return[c*f,d*f]},latLngBounds2Bounds:function(a,b){if(null==a||null==b||!1==a instanceof GWTK.LatLngBounds)return null;var c=this.geo2xy(b,a.getSouth(),a.getWest());if(null==c)return c;var d=this.geo2xy(b,a.getNorth(),a.getEast());return null==d?d:GWTK.bounds(new GWTK.point(c[1],c[0]),new GWTK.point(d[1],d[0]))}};window.GWTK&&(GWTK.selectedFeatures=function(a){this.map=a;this.map||(this.map=GWTK.maphandlers.map);this.selected=[];this.layers=[];this.mapobjects=[];this.drawselobject=this.drawcurrobject=null},GWTK.selectedFeatures.prototype={clear:function(){this.clearobjects();this.selected&&0!==this.selected.length&&(this.selected.splice(0,this.selected.length),this.layers.splice(0,this.layers.length))},getselection:function(){this.selected=[];this.layers=[];if(!this.map)return this.selected;var a=$(this.map.objectsPane).find(".panel-info-img-search");
if(void 0==$(a))return this.selected;for(var b=0;b<a.length;b++){var c=$(a[b]).attr("objId");void 0!=c&&(this.selected.push(c),(c=$(a[b]).attr("layerId"))&&(0==this.layers.length||-1==GWTK.Util.indexOf(this.layers,c,0))&&this.layers.push(c))}return this.selected},addWfs:function(a,b){var c=this.map.tiles.getLayerByGmlId(a);c&&(b=c.options.id,null!=a&&void 0!=a&&(c=a.split(":"),1<=c.length&&(this.layers.splice(this.layers.length,0,c[0]),this.selected.splice(this.selected.length,0,c[1]))),mapobject=
new GWTK.mapobject(this.map,a,b,null,null,this.mapobjects),mapobject.initwfs())},addXmlElem:function(a,b,c){if(null!=a&&void 0!=a){var d=a.split(":");1<=d.length&&(this.layers.splice(this.layers.length,0,d[0]),this.selected.splice(this.selected.length,0,d[1]))}mapobject=new GWTK.mapobject(this.map,a,b,null,null,this.mapobjects);mapobject.loadobjectXmlElem(c);this.mapobjects.splice(this.mapobjects.length,0,mapobject);return this.mapobjects[this.mapobjects.length-1]},add:function(a){if(null!=a&&void 0!=
a){var b=a.gid.split(":");1<=b.length&&(this.layers.splice(this.layers.length,0,b[0]),this.selected.splice(this.selected.length,0,b[1]))}a.mapobjects=this;this.mapobjects.splice(this.mapobjects.length,0,a);return this.mapobjects[this.mapobjects.length-1]},clearobjects:function(){if(!(null==this.mapobjects||void 0==this.mapobjects)){null!=this.drawselobject&&void 0!=this.drawselobject&&(this.drawselobject.clear(),this.drawselobject=null);for(var a=this.mapobjects.length,b=0;b<a;b++)this.mapobjects[b].clear();
this.mapobjects.splice(0,this.mapobjects.length);this.drawcurrobject=null}},findobjectsById:function(a,b){if(!(null==this.mapobjects||void 0==this.mapobjects))for(var c=this.mapobjects.length,d=0;d<c;d++)if(this.mapobjects[d].maplayerid==a&&this.mapobjects[d].gid==b)return this.mapobjects[d]},drawcontour:function(a,b,c){a>this.mapobjects.length||0>=a||this.drawcontour(this.mapobjects[a-1],c)},drawcontourById:function(a,b,c,d){if(a=this.map.tiles.getLayerByGmlId(b))a=a.options.id,b=this.findobjectsById(a,
b),void 0==b||null==b||this.drawcontour(b,c,d)},drawcontour:function(a,b,c){b&&(null!=this.drawcurrobject&&void 0!=this.drawcurrobject)&&this.drawcurrobject.cleardraw();this.drawcurrobject=a;void 0==c||null==c||!c?this.drawcurrobject.drawcontour(null):(void 0!=this.drawselobject&&null!=this.drawselobject&&this.drawselobject.clear(),this.drawselobject=this.drawcurrobject.createcopy(this.drawcurrobject),this.drawselobject.setDrawParam(c,!1,!1),this.drawselobject.drawcontour())}});GWTK.Util={extend:function(a){var b=Array.prototype.slice.call(arguments,1),c,d,e,f;d=0;for(e=b.length;d<e;d++)for(c in f=b[d]||{},f)f.hasOwnProperty(c)&&(a[c]=f[c]);return a},falseFn:function(){return!1},formatNum:function(a,b){var c=Math.pow(10,b||5);return Math.round(a*c)/c},trim:function(a){return a.trim?a.trim():a.replace(/^\s+|\s+$/g,"")},splitWords:function(a){return GWTK.Util.trim(a).split(/\s+/)},setOptions:function(a,b){a.options=GWTK.extend({},a.options,b);return a.options},getParamString:function(a,
b,c){var d=[],e;for(e in a)d.push(encodeURIComponent(c?e.toUpperCase():e)+"="+encodeURIComponent(a[e]));return(!b||-1===b.indexOf("?")?"?":"&")+d.join("&")},template:function(a,b){return a.replace(/\{ *([\w_]+) *\}/g,function(a,d){var e=b[d];if(void 0===e)throw Error("No value provided for variable "+a);"function"===typeof e&&(e=e(b));return e})},isArray:Array.isArray||function(a){return"[object Array]"===Object.prototype.toString.call(a)},parseBoolean:function(a){if("boolean"==typeof a)return a;
if("string"===typeof a){var b=void 0;a=a.toLowerCase();"true"===a?b=!0:"false"===a&&(b=!1);return b}},indexOf:function(a,b,c){if(!this.isArray(a))return-1;if(void 0!=Array.prototype.indexOf)return a.indexOf(b,c);Array.prototype.indexOf=function(a,b){b?0>b&&(b=Math.max(0,this.length+b)):b=0;for(var c=b,g=this.length;c<g;c++)if(this[c]===a)return c;return-1};return a.indexOf(b,c)},getParamsFromURL:function(a){a=a.replace(/\% ?/g,"");var b={},c,d;c=a.lastIndexOf("#");-1!==c&&(a=a.slice(c+1));c=a.indexOf("?");
if(-1!==c){a=a.slice(c+1);a=a.split("&");for(d=0;d<a.length;d++)c=a[d].split("="),2>c.length&&c.push(""),b[decodeURIComponent(c[0]).toLowerCase()]=decodeURIComponent(c[1])}return b},rulerCookieName:function(){return GWTK.cookies.getKey()+"_ruler"},parseUrl:function(a){var b=document.createElement("a");b.href=a;return{protocol:b.protocol,host:b.hostname,port:b.port,path:b.pathname,search:b.search,hash:b.hash}},createCss:function(a,b){if(a&&b){var c=document.getElementsByTagName("head");if(0!=c.length){var c=
c[0],d=$("<style type='text/css'> ."+a+b+"</style>");c.appendChild(d[0]);return!0}}},onLegendDataLoaded:function(a,b){var c;if(c=b&&b instanceof GWTK.classifier?b.layerid:b){var d=$.parseXML(a),e=$(d),f=e.context.documentElement.nodeName.toLowerCase();if("maplegend"==f){var g=$(e.context.documentElement).attr("ImgPath");if(g&&0!=g.length){var g=encodeURIComponent(g),d=GWTK.maphandlers.map,m=GWTK.maphandlers.map.tiles,h=-1,p,q=d.options.layers.length;for(p=0;p<q;p++)if((!(b&&!1==b instanceof GWTK.classifier)||
d.options.layers[p].legend)&&d.options.layers[p].id==c){h=p;break}if(-1!=h){var h=d.options.layers[h],r=GWTK.Util.parseUrl(h.url),s={};s.id=c;s.items=[];s.url=r.protocol+"//"+r.host;r.port&&0!=r.port.length&&(s.url=s.url+":"+r.port);q=r.path;"/"!=q[0]&&(q="/"+q);p=q.lastIndexOf("/");0==p&&(q+="/");p<q.length-1&&(q=q.substr(0,p+1));s.url=s.url+q+g;s.imgpath=g;var g=e.context.documentElement.childNodes,q=e.context.documentElement.childNodes.length,u,t="",w="";for(p=0;p<q;p++)f={},f.id=c+"_"+g[p].nodeName,
f.text=$(g[p]).attr("Description"),f.expanded=0==p,f.img="icon-folder",f.nodes=[],$(g[p]).find("Item").each(function(){var a={};a.id=$(this).attr("Key")+"_"+c;a.text=$(this).attr("Description");a.img=$(this).attr("Image");a.code=$(this).attr("Code");a.local=$(this).attr("Local");a.expanded=!1;u="img_"+c+"_"+a.id;r=s.url+a.img;t="{background-image: url('"+r+"'); border: 1px solid grey !important;}";b instanceof GWTK.classifier&&(t="{height:32px; background-position:center !important; background-image: url('"+
r+"'); border: 1px solid grey !important;}",a.css=" ."+u+t+"\r\n");a.img=u;w+=" ."+u+t+"\r\n";f.nodes.push(a)}),0!=f.nodes.length&&s.items.push(f);0!=s.items.length&&(e=document.getElementsByTagName("head"),0!=e.length&&(e=e[0],p=$("<style type='text/css'>"+w+"</style>"),e.appendChild(p[0]),b instanceof GWTK.classifier?b.loadObjects(s):(m.legends.push(s),d.mapcontent&&w2ui.MapContent.add(c,s.items))))}}}}},getResponseType:function(a){a=$.parseXML(a);a=$(a);var b=a.context.documentElement.nodeName.toLowerCase();
return"wmts_getfeatureinforesponse"==b?this.wmts_getfeatureinfoHtml(a):-1!=b.indexOf("featurecollection")?this.wfs_getfeaturecollectionHtml(a):[b,""]},wmts_getfeatureinfoHtml:function(a){if(!a)return["wmts_getfeatureinfo",""];var b=this.clearselectedFeatures(),c=a.context.documentElement.getElementsByTagName("GetFeatureInfo");if(0==c.length)return["wmts_getfeatureinfo",""];c=c[0];c=a.context.documentElement.getElementsByTagName("FeatureInfo");if(0==c.length)return["wmts_getfeatureinfo",""];a=$(a.context.documentElement).find("Layer");
0<a.length&&(a=$(a).text());var d=document.createElement("div");d.id="wmts_container";for(var e=document.createElement("div"),f=0;f<c.length;f++){var g=document.createElement("div");g.className="panel-info-rowfeature";var m=$(c[f]).attr("gml:id");g.id=m;var h=GWTK.DomUtil.create("div",""),p=GWTK.DomUtil.create("img","panel-info-img-search");p.src=GWTK.imgMarkerBlankRed;$(p).attr("layerId",a);$(p).attr("objId",m);$(h).append(p);var q=c[f].getElementsByTagName("Semantics"),r=-1,s;$.each(q,function(a,
b){var c=$(b).attr("name"),c=c.toLowerCase();if("objectname"==c){c=document.createElement("span");c.className="panel-info-title";var d=$(b).attr("value");$(c).html(d);r=a;$(h).append(c)}});$(g).append(h);$(g).append(GWTK.DomUtil.create("div","panel-info-objname"));for(var u=0;u<q.length;u++)if(u!==r){p=GWTK.DomUtil.create("div","panel-info-text");h=GWTK.DomUtil.create("span","panel-info-text-title");$(h).html($(q[u]).attr("name")+":");$(p).append(h);h=GWTK.DomUtil.create("span","panel-info-text");
s=$(q[u]).attr("value").toLowerCase();if(-1!==s.indexOf("http:")){var t=document.createElement("a");t.className="panel-info-text-act";t.href=s;t.name="a_"+Math.random();t.target="_blank";$(t).html(s);t.setAttribute("selectable","on");$(t).css("display","inline-block");$(t).css("pointer-events","all !important");$(p).append(t)}else-1!==s.indexOf("@")&&-1!==s.indexOf(".")?(t=document.createElement("a"),t.className="panel-info-text-act",t.href="mailto:"+s,t.name="a_"+Math.random(),t.target="_blank",
$(t).html(s),t.setAttribute("selectable","on"),$(t).css("display","inline-block"),$(t).css("pointer-events","all !important"),$(p).append(t)):($(h).html($(q[u]).attr("value")),$(p).append(h));$(g).append(p)}q=c[f].getElementsByTagName("Area");0!=q.length&&(q=$(q[0]).text(),0!=parseInt(q)&&(p=GWTK.DomUtil.create("div","panel-info-text"),h=GWTK.DomUtil.create("span","panel-info-text-title"),$(h).html("\u041f\u043b\u043e\u0449\u0430\u0434\u044c:"),$(p).append(h),h=GWTK.DomUtil.create("span","panel-info-text"),
$(h).html(q),$(p).append(h),$(g).append(p)));q=c[f].getElementsByTagName("Perimetr");0!=q.length&&(p=GWTK.DomUtil.create("div","panel-info-text"),h=GWTK.DomUtil.create("span","panel-info-text-title"),$(h).html("\u041f\u0435\u0440\u0438\u043c\u0435\u0442\u0440:"),$(p).append(h),h=GWTK.DomUtil.create("span","panel-info-text"),$(h).html($(q[0]).text()),$(p).append(h),$(g).append(p));q=c[f].getElementsByTagName("Length");0!=q.length&&(p=GWTK.DomUtil.create("div","panel-info-text"),h=h=GWTK.DomUtil.create("span",
"panel-info-text-title"),$(h).html("\u0414\u043b\u0438\u043d\u0430:"),$(p).append(h),h=GWTK.DomUtil.create("span","panel-info-text"),$(h).html($(q[0]).text()),$(p).append(h),$(g).append(p));e.appendChild(g);null!=b&&void 0!=b&&b.addWfs(m,a)}$(d).append(e);return["wmts_getfeatureinfo",d]},wfs_getfeaturecollectionHtml:function(a){if(!a)return["wfs_featurecollection",""];var b=a.context.documentElement.nodeName.toLowerCase();if(-1==b.indexOf("featurecollection"))return["wfs_featurecollection",""];var c=
a.context.documentElement.childNodes;if(0==c.length)return["wfs_featurecollection",""];var d=GWTK.maphandlers.map;d.placemarkRemove();var e=this.clearselectedFeatures(),f,g=document.createElement("div");g.className="placemark-img-size-small";g=[parseInt($(g).css("width")),parseInt($(g).css("height"))];if(void 0==g[0]||void 0==g[1])g[0]=10,g[1]=10;var m=$(a.context.documentElement).attr("numberMatched");a=parseInt($(a.context.documentElement).attr("numberReturned"));var h=$("#featurelist"),p,q,r=c.length;
h[0].innerHTML="";for(p=0;p<r;p++)if(-1!=c[p].nodeName.toLowerCase().indexOf("member")){q="";var s;f=c[p].childNodes.length;for(s=0;s<f&&!(b=c[p].childNodes[s],q=$(b).attr("gml:id"),void 0!=q);s++);if(!(void 0==q||0==q.length))if(s=d.tiles.getLayerByGmlId(q))if(s=void 0!=s.idLayerWMTS?s.idLayerWMTS:s.id,null!=e&&void 0!=e&&!1!=d.tiles.getLayerByIdService(s)instanceof GWTK.Layer&&(f=d.tiles.getLayerByIdService(s).selectsearch,1==f?(f=e.addXmlElem(q,s,b),f.drawcontour()):e.add(new GWTK.mapobject(d,
q,s,null,null,e.mapobjects))),f=$(b).find("ObjectCenter"),0!=f.length&&(f=$(f).text().split(" "),2==f.length)){f=GWTK.toLatLng(f);var u=GWTK.tileView.geo2pixelOffset(d,f);d.overlayAppend(f,u,!0,s+"_"+q,!0,g);f=GWTK.Util.appendListRow(h);f.id=q;var u=d.tiles.getLayerByIdService(s),t=$(f).children("img");t[0].id=s+"_"+q;t.attr("layerId",s);t.attr("objId",q);q=$(f).children("span");t="";for(s=0;s<b.childNodes.length;s++)t=b.childNodes[s].nodeName.slice(b.childNodes[s].nodeName.indexOf(":")+1),"gml:name"==
b.childNodes[s].nodeName.toLowerCase()?($(q).html($(b.childNodes[s]).text()+", "+u.alias),$(f).append(GWTK.DomUtil.create("div","panel-info-objname"))):-1!=$.inArray(t,u.keysTextSearch)&&(t=document.createElement("div"),t.className="panel-info-text-title",t.innerText=$(b.childNodes[s]).text(),$(f).append(t));$(h).append(f)}}null!=d.ruler&&d.ruler.refresh();if(void 0==m||0==m)a=m=h[0].childNodes.length;return 0!=h[0].childNodes.length?["wfs_featurecollection",h[0],m,a]:["wfs_featurecollection"]},error_report:function(){var a=
GWTK.maphandlers.map.objectsPane;pane_feature_list=$("#featurelist");pane_feature_list[0].innerHTML="\u041d\u0430\u0439\u0434\u0435\u043d\u043e \u043e\u0431\u044a\u0435\u043a\u0442\u043e\u0432: 0";$("#listlink").hide();$(a).fadeIn("slow",function(){});GWTK.maphandlers.map.placemarkRemove()},clearSelection:function(){$(GWTK.maphandlers.map.overlayPane).fadeIn(3E3,function(){GWTK.maphandlers.map.placemarkRemove()})},clearselectedFeatures:function(){var a;null==GWTK.featureSearch||void 0==GWTK.featureSearch?
a=GWTK.selectFeatures(GWTK.maphandlers.map).selectedFeatures:(a=GWTK.featureSearch.selectedFeatures,a.clear());return a},appendListRow:function(a){var b=document.createElement("div");b.className="panel-info-rowfeature";var c=GWTK.DomUtil.create("img","panel-info-img-search");c.src=GWTK.imgMarkerBlankRed;$(b).append(c);c=document.createElement("span");c.className="panel-info-title";$(b).append(c);a.append(b);return b},randomInt:function(a,b){return Math.floor(Math.random()*(b-a))+a},formatting:function(a,
b){Result="";for(var c=new String(a),d=new String(b),e=0,f=0,g=-1;""!=c.charAt(e);)"."==c.charAt(e)&&(g=e),f++,e++;if(0==f)return Result;e=g;-1==g&&(g=f);var f=parseInt(g%3,10),g=parseInt(g/3,10),m=f;Result=c.substring(0,f);for(k=0;k<g;k++)Result+=" "+c.substr(m,3),m+=3;0<=e&&(Result+=c.substr(e,3));return Result+" "+d},drawLineWithIdToDiv:function(a,b,c,d,e){if(null==d||null==c||0==c.length||void 0===a||void 0===b||!1===a instanceof GWTK.Point||!1===b instanceof GWTK.Point)return!1;var f=a.x;a=a.y;
var g=b.x;b=b.y;if(e)e&&void 0!=e.getContext&&(p=h=0,f=parseInt(f,10)+h,a=parseInt(a,10)+p,g=parseInt(g,10)+h,b=parseInt(b,10)+p,d=e.getContext("2d"),d.lineWidth=2,d.strokeStyle="rgba(255, 0, 0, 0.5)",d.beginPath(),d.moveTo(f,a),d.lineTo(g,b),d.stroke());else{f=parseInt(f,10);a=parseInt(a,10);g=parseInt(g,10);b=parseInt(b,10);e=document.createElement("hr");e.className="ruler-line-msie";e.id=c;e.setAttribute("unselectable","on");var m=!0;c=!0;f>g&&(m=!1,h=f,f=g,g=h);a>b&&(c=!1,h=a,a=b,b=h);var h=0,
p=0,f=f+h;a+=p;g=g+h-f;b=b+p-a;var q=Math.sqrt(g*g+b*b);GWTK.DomUtil.setPosition(e,GWTK.point(f+h,a+p));e.style.width=q;f=(m?g:-g)/q;a=(c?b:-b)/q;f="progid:DXImageTransform.Microsoft.Alpha(opacity=80) "+("progid:DXImageTransform.Microsoft.Matrix(SizingMethod='auto expand',FilterType='bilinear',M11="+f+",M12="+-a+",M21="+a+",M22="+f+")");e.style.filter=f;d.appendChild(e)}},utf8Decode:function(a){for(var b="",c=0,d=c1=c2=0;c<a.length;)d=a.charCodeAt(c),128>d?(b+=String.fromCharCode(d),c++):191<d&&224>
d?(c2=a.charCodeAt(c+1),b+=String.fromCharCode((d&31)<<6|c2&63),c+=2):(c2=a.charCodeAt(c+1),c3=a.charCodeAt(c+2),b+=String.fromCharCode((d&15)<<12|(c2&63)<<6|c3&63),c+=3);return b},getLengthEx:function(a,b,c,d){return Math.floor(Math.sqrt(Math.pow(c-a,2)+Math.pow(d-b,2)))},uiFindPos:function(a){if(null!=a){var b=0,c=0;if(a.offsetParent){b=a.offsetLeft;for(c=a.offsetTop;a=a.offsetParent;)b+=a.offsetLeft,c+=a.offsetTop}return[b,c]}},setObjectScale:function(a,b,c,d){null!=a&&(0==d?(a.style.transform=
"inherit",a.style.transformOrigin="inherit",a.style.webkitTransform="inherit",a.style.webkitTransformOrigin="inherit"):!isNaN(b)&&(!isNaN(c)&&!isNaN(d))&&(d="scale("+d+") translate("+b+"px, "+c+"px)",b=b+"px "+c+"px",a.style.webkitTransform=d,a.style.MozTransform=d,a.style.msTransform=d,a.style.OTransform=d,a.style.transform=d,a.style.webkitTransformOrigin=b,a.style.MozTransformOrigin=b,a.style.msTransformOrigin=b,a.style.OTransformOrigin=b,a.style.transformOrigin=b))},setMapPanelScale:function(a,
b,c){!isNaN(a)&&(!isNaN(b)&&!isNaN(c))&&(this.setObjectScale(GWTK.maphandlers.map.tilePane,a,b,c),this.setObjectScale(GWTK.maphandlers.map.overlayPane,a,b,c),this.setObjectScale(GWTK.maphandlers.map.underlayPane,a,b,c),this.setObjectScale(GWTK.maphandlers.map.eventPane,a,b,c),this.setObjectScale(GWTK.maphandlers.map.drawPane,a,b,c))},removeChildren:function(a){for(var b=a.childNodes;b.length;)a.removeChild(b[0])}};
(function(){function a(a){var b,c,d=["webkit","moz","o","ms"];for(b=0;b<d.length&&!c;b++)c=window[d[b]+a];return c}function b(a){var b=+new Date,d=Math.max(0,16-(b-c));c=b+d;return window.setTimeout(a,d)}var c=0,d=window.requestAnimationFrame||a("RequestAnimationFrame")||b,e=window.cancelAnimationFrame||a("CancelAnimationFrame")||a("CancelRequestAnimationFrame")||function(a){window.clearTimeout(a)};GWTK.Util.requestAnimFrame=function(a,c,e,h){a=$.bind(a,c);if(e&&d===b)a();else return d.call(window,
a,h)};GWTK.Util.cancelAnimFrame=function(a){a&&e.call(window,a)}})();GWTK.Cookies=function(){this.defaults={};this.pluses=/\+/g;this.raw=!0};
GWTK.Cookies.prototype={getKey:function(){return hex_md5(window.location.href)},stringifyCookieValue:function(a){return this.encode(String(a))},encode:function(a){return this.raw?a:encodeURIComponent(a)},decode:function(a){return this.raw?a:decodeURIComponent(a)},parseCookieValue:function(a){0===a.indexOf('"')&&(a=a.slice(1,-1).replace(/\\"/g,'"').replace(/\\\\/g,"\\"));try{return a=decodeURIComponent(a.replace(pluses," "))}catch(b){}},read:function(a,b){var c=this.raw?a:this.parseCookieValue(a);
return $.isFunction(b)?b(c):c},cookies:function(a,b,c){if(void 0!==b&&!$.isFunction(b)){""===a&&(a=GWTK.cookies.getKey());c=$.extend({},this.defaults,c);if("number"===typeof c.expires){var d=c.expires,e=c.expires=new Date;e.setTime(+e+864E5*d)}a=[GWTK.cookies.encode(a),"=",GWTK.cookies.stringifyCookieValue(b),c.expires?"; expires="+c.expires.toUTCString():"",c.path?"; path="+c.path:"",c.domain?"; domain="+c.domain:"",c.secure?"; secure":""];return document.cookie=a.join("")}c=a?void 0:{};var d=document.cookie?
document.cookie.split("; "):[],f,e=0;for(f=d.length;e<f;e++){var g=d[e].split("="),m=GWTK.cookies.decode(g.shift()),g=g.join("=");if(a&&a===m){c=GWTK.cookies.read(g,b);break}}return c},converter:function(a,b){for(var c=a.split(b?b:"&"),d=[],e=0,f=c.length;e<f;e++)if(c[e]&&null!=c[e]){var g=c[e].split("="),m=GWTK.cookies.decode(g.shift()),g=0<g.length?GWTK.cookies.decode(g.shift()):m;d.push([m,g])}return d}};GWTK.convert=function(){return new GWTK.projections};GWTK.projection=GWTK.convert();
GWTK.defaultcenter=new GWTK.LatLng(37.620245,55.754129);GWTK.defaultzoom=10;GWTK.defaultcrs=4326;GWTK.extend=GWTK.Util.extend;GWTK.cookies=new GWTK.Cookies;GWTK.cookie=GWTK.cookies.cookies;GWTK.rulercookiename=GWTK.Util.rulerCookieName;GWTK.removeCookie=function(a){void 0===GWTK.cookie&&(GWTK.cookies=new GWTK.Cookies,GWTK.cookie=GWTK.cookies.cookies);if(void 0===GWTK.cookie(a))return!1;GWTK.cookie(a,"",{expires:-1,path:"/"});return!0};GWTK.imgClose="data:image/gif;base64,R0lGODlhEAAQAMQfAPf39+fn5+Pj4/7+/v39/dvb2/X19eDg4N7e3vPz8/b29uXl5d3d3fT09Orq6uHh4enp6evr6/n5+dnZ2eLi4ujo6Obm5tra2vj4+NfX19jY2H9/f5+fn9bW1v///////yH5BAEAAB8ALAAAAAAQABAAAAWN4Cd+SsB0HROM7LegMLy0QqdVmOdhldZRI0unkNMZMYWOhdTJFI3HTAdQ6VR0G46Os9FVKwgNYJvlaj0ADSJzGRi5WePgomG7yXEd4TI5aAxkHGY6BhoHEB0BWGdcOgEdEB9NY1BGAFIYH0IXCZUeCRdKIzVKDQQEDUIdAi0RUjFNES0jDg8aGg8OEiwhADs=";
GWTK.imgEmpty="data:image/gif;base64,R0lGODlhAAEAAYABAGZmZv///yH5BAEAAAEALAAAAAAAAQABAAL/jI+py+0Po5y02ouz3rz7D4biSJbmiabqyrbuC8fyTNf2jef6zvf+DwwKh8Si8YhMKpfMpvMJjUqn1Kr1is1qt9yu9wsOi8fksvmMTqvX7Lb7DY/L5/S6/Y7P6/f8vv8PGCg4SFhoeIiYqLjI2Oj4CBkpOUlZaXmJmam5ydnp+QkaKjpKWmp6ipqqusra6voKGys7S1tre4ubq7vL2+v7CxwsPExcbHyMnKy8zNzs/AwdLT1NXW19jZ2tvc3d7f0NHi4+Tl5urgAQkO4B0L5u5v5+l07fbuB+sF5vj6+OEK+uHz1/Au/5I9gv4L6B+uwpTBgwIsCCDPnhkweQDkOD/wcNOvTo8SLIgxv1kUR4Mh/HjSdNdrTYMqZLkxM5zrlYUKVDkQRHNnwnECc/iTZfwlyZEmi9e0N1plSY9KMclirzDXTaM+tVmlmRDs2ItOfMpFaJigU5VuvTqWo7EuWqFi7XrS1ZYvRKNu3ZuWjD0nV5k+TOfyF/MrWImC9UuWt/2h0M1enCyPFmCp18Sd65zZw7e14TFLPVyYxDQ7T7cPHXw0ol7kRc1zBPzYD+rj0b1yfZvrnH6oWp2DdvmrT/2AbsM3Fqxi/b8lyJ8SPw54KbXvVavI9wsDFzewcM+Tjep8AJpxUv2G1tvMhL62beevlw3c1R0+2O2mygym9t8v+vGVd4UqlHWnjVAaUVbHm9dp56fCAIAYQhDPhZhRZeiGGGGm7IYYcefmjLdVSIeApEU5h4CIo+cHeiil9U5Jhb+8iH0IyLoUOdiBMJ5eBh8i1kIFOuKViSctmFYd9IfqHVIFVV6UjjfciZJ1NeEQlpXW9Lsojkd1GOhtKBRknHYJLVQTdgklKG6ZqPd913Y48veglfSLvNN56Zazb2XpPXlYdbfsyRoSd+2O1Wkn/vGdqgjH1u+WegWloppxcwYpfll2OqRqaRy12GplKgRvWbWDw+ZJlyrRz5AILRgQhrrLJ+lip5S4XGKWE1usrapzbWstRerWW5J4Rwrtkoq6ypBFtkWZ4+6R+uQoJ5nouuEKsfoPSBR59ziOaCbVN74cltW94mG6KdxyZoo2HQgrXVqKJWSuus9t6Lb7767stvv/7+C3DAAg9McMEGH4xwwgovzHDDDj8MccQST0xxxRZfjHHGGm/McccefwxyyCKPTHLJJp+Mcsoqr8xyyy6/DHPMMs9Mc80234xzzjrvzHPPPv8MdNBCD0100UYfjXTSSi/NdNNOP71zAQA7";
GWTK.imgCollapsed="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAeUlEQVR42mNkoBAw0syAsrKS/11dPQQtwKkgLy/nPwcHB8O9ew+U1qxZc59sA0AAaIgw0JB3ZBsANYQLaMh3sg2AGmIDNOQo2QaAAHrAkuoCHqALvpIbBlJAzc/JCgNcmokyAJ9mvAaEhIQ8AlLm+DTjNYBYMPAGAADJOU0RGOUM5wAAAABJRU5ErkJggg==";GWTK.imgExpanded="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAARElEQVR42mNkoBAwDjkD1IH4JrkGgDTfQNdDrAEwzQzkGICsmWQD0DWTZAA2zUQbgEszUQbg00zQAEKaSQoDosAwMAAAeaEJEXrfw+oAAAAASUVORK5CYII=";
GWTK.imgFirstPoint="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAoAAAAKCAYAAACNMs+9AAAACXBIWXMAAAsTAAALEwEAmpwYAAAAIGNIUk0AAHolAACAgwAA+f8AAIDpAAB1MAAA6mAAADqYAAAXb5JfxUYAAABCSURBVHjaYvz//z8DMYCFgYGBwSS2Bq/qM4tbGFlgHJOIUuyKVnQzMDAwMDAxEAmGgkIWdN/hAozEBjgAAAD//wMA1bEPEq1H128AAAAASUVORK5CYII=";GWTK.imgLastPoint="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAoAAAAKCAYAAACNMs+9AAAACXBIWXMAAAsTAAALEwEAmpwYAAAAIGNIUk0AAHolAACAgwAA+f8AAIDpAAB1MAAA6mAAADqYAAAXb5JfxUYAAABESURBVHjaYvz//z8DMYCFgYGBwU1CHq/qXS8eMrLAOPN+8GNVlMTxkYGBgYGBiYFIMBQUsqD7DhdgJDbAAQAAAP//AwCkIQ5ui91/8AAAAABJRU5ErkJggg==";
GWTK.imgRedPoint="data:image/gif;base64,R0lGODlhCgAKANUgAGpPTxYQEGxRUZx1dSEHBDAkJDImJqsiF+0vIJwfFRsFBBMODucuH/AwIAoHB/YxIRUEAx0HBqgiFiAIBtssHfkyIaIgFhcGBd4sHrEjGLclGAwJCeovHz4vL5pzc/8zIsyZmQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACH5BAEAACAALAAAAAAKAAoAAAZBQBDI0wkEOh4hCEDIIDgHhWBIaHyuH05kUNBgsRLDpvK9cjabR/nDcBQO64TBM0F8GZfBUmHBUBIQU0JECwtIQkEAOw==";GWTK.imgMarkerRedPoint="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAoAAAAKCAYAAACNMs+9AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyBpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNSBXaW5kb3dzIiB4bXBNTTpJbnN0YW5jZUlEPSJ4bXAuaWlkOkNCQTFEOTg0QjhGRDExRTQ5NTQxRTlCRTNCQTgyQUI0IiB4bXBNTTpEb2N1bWVudElEPSJ4bXAuZGlkOkNCQTFEOTg1QjhGRDExRTQ5NTQxRTlCRTNCQTgyQUI0Ij4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6Q0JBMUQ5ODJCOEZEMTFFNDk1NDFFOUJFM0JBODJBQjQiIHN0UmVmOmRvY3VtZW50SUQ9InhtcC5kaWQ6Q0JBMUQ5ODNCOEZEMTFFNDk1NDFFOUJFM0JBODJBQjQiLz4gPC9yZGY6RGVzY3JpcHRpb24+IDwvcmRmOlJERj4gPC94OnhtcG1ldGE+IDw/eHBhY2tldCBlbmQ9InIiPz72ooumAAAA0klEQVR42mI8Y8wAA7pA3A7ENlD+ESCuBOLLIA4jVGEmEE8AYjYGVPALiAuAeDpIoQGQcRKkiENenUEkKA2s4s3GuQw/7l2DKTZnACrcCMT/r4Rq/f/749t/GPj36+f/q+G6/0FyIDVMQNUgExlE/JMZmNg54XYysrIxiIZkwrgGTAxEAiaYr0Bu+v/7F1wCxH69ZjqMexnkGZC/j4E8w6miC7cOpOj7ncswz1jBgicHGjzMaDb+BeJiIJ4Ic+MUkC4g3grEH6F4K1RsIkgBQIABAP4OTTX4eGPCAAAAAElFTkSuQmCC";
GWTK.imgMarkerBlankRed="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAzCAYAAACAArhKAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyBpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNSBXaW5kb3dzIiB4bXBNTTpJbnN0YW5jZUlEPSJ4bXAuaWlkOkIyQ0ZGMEUyMTg4NTExRTQ4RTY2QkE2M0FCRkQ3MjE3IiB4bXBNTTpEb2N1bWVudElEPSJ4bXAuZGlkOkIyQ0ZGMEUzMTg4NTExRTQ4RTY2QkE2M0FCRkQ3MjE3Ij4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6QjJDRkYwRTAxODg1MTFFNDhFNjZCQTYzQUJGRDcyMTciIHN0UmVmOmRvY3VtZW50SUQ9InhtcC5kaWQ6QjJDRkYwRTExODg1MTFFNDhFNjZCQTYzQUJGRDcyMTciLz4gPC9yZGY6RGVzY3JpcHRpb24+IDwvcmRmOlJERj4gPC94OnhtcG1ldGE+IDw/eHBhY2tldCBlbmQ9InIiPz6OCreuAAALiUlEQVR42qRYeYxdVRn/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";
GWTK.imgsearch="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAAxUlEQVR42mNkoDJgHDUQDnp7e/mAlC6Ue7m4uPgT2QYCDWsGUjVowi1AQ2tJNhDJsAtA3AwVBhlkQIyhjGiGgbz5EWqYEVDzf6g4SN05qKH8+LyPbqA1kDoCxMFATevQ5IKA1FogtgHKHR0wA6nrZXyRws7ObsDFxfWHkZExOzExcRbRBqIZCgeCgoIgw1ig3HRchhKdsIWEhCKA9EwkJVgNJSnrzZ8/P42QoSTnZTRDvwEN5KbIQCRD+4G4kGIXEgKD30AAwVleFXC4rEIAAAAASUVORK5CYII=";GWTK.imgPrickBig="data:image/png;base64,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";
GWTK.imgPrickBig_select="data:image/png;base64,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";
GWTK.imgRealPoint="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAoAAAAKCAYAAACNMs+9AAAACXBIWXMAAAsTAAALEwEAmpwYAAAAIGNIUk0AAHolAACAgwAA+f8AAIDpAAB1MAAA6mAAADqYAAAXb5JfxUYAAADPSURBVHjajJBBS8JgHIef981DDoYWu4iyofPQLVDo1mcIP6n4Feq2LiMCYUJOdGBzMFgr2Np6O01rQex/+8HDw+//E0opmlwLQMzu/qXVfCFaVejc3NKNU/ZvB87yT6xuj8DQSZwHAGQF2knJJn0lMwd8jEcs05Cr5OtoPYJP4QpME/Ic8gxGQ1zv8XdHgEKVICRUz0lBURYgasZrYwzBDjQNtDb4ayb29K8xuDjH2utE7jNKSgaXfXyjDS81MHLuiX5M4r3HsD1l0XTw7wEA6DJF80HPSSkAAAAASUVORK5CYII=";
GWTK.imgCurrentPoint="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAoAAAAKCAYAAACNMs+9AAAACXBIWXMAAAsTAAALEwEAmpwYAAAAIGNIUk0AAHolAACAgwAA+f8AAIDpAAB1MAAA6mAAADqYAAAXb5JfxUYAAAEkSURBVHjahMpBKENxAMDh3//NoiQHxGJZLJPSihKTzCtOLitNzRwWRTtMw2kHOblOrWREVnKgHMxBUzOF2yYyWZY4iGUu2kHN3nPH8p0/8Xg9C4A/alVfE1vcJ28ByJcakO1uvHJMhN99lACsHWrV+N4CU3Nj9M0bKCgSp5e1BP0+PEmbOuhAiJnlAzUeWmA7JPNTQZEYd0Xoci2hqS57W5yctqGvyf2KklCpbOhlc3Ud6SGVoqfthWIGOjM8p2+Q+Ede0aAoBaQmk4loXFc0Hp9VoW8xIxmtHjYCO3+mzy8tW8ENhid8SF45JvpHhhh1Rjg615HNlZP5qCAcq8Ph3KfeYqe5vVuIwEkWgPTVhRrdXeHpLgFAY2sHst2N0WwRAN8DALwcYc+U+ktJAAAAAElFTkSuQmCC";
GWTK.imgCenterPoint="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAoAAAAKCAYAAACNMs+9AAAACXBIWXMAAAsTAAALEwEAmpwYAAAAIGNIUk0AAHolAACAgwAA+f8AAIDpAAB1MAAA6mAAADqYAAAXb5JfxUYAAADBSURBVHjaYvz//z8DMYCJgUjAAmP4dy4wuPny3pwHX1+rsvz6/V+LR/KqurR68uKKmBsoCt++fbns5o/XmgwKcgw/GRgZTj94aMX3lm8pAwODMYrVJ9/e1mSQk2Ng+PWLgeHXTwYGJUWGw3dP6mBY/ef/XwYGRiYGBpjnmBgZ/vz5/R/DM6ZCKk8Znj5hYODiYmDg4mRgeHCfwUrJ9DGGQkkR6RiVf9wPuC9cYeC6dJ1B9z//TXkJ+RiYPCPVwxEwAKCVQy+XlR3XAAAAAElFTkSuQmCC";GWTK.imgNext="data:image/png;base64,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";
GWTK.imgPrev="data:image/png;base64,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";
GWTK.imgNextDisable="data:image/png;base64,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";
GWTK.imgPrevDisable="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABwAAAAcCAYAAAByDd+UAAAACXBIWXMAAC4jAAAuIwF4pT92AAAKTWlDQ1BQaG90b3Nob3AgSUNDIHByb2ZpbGUAAHjanVN3WJP3Fj7f92UPVkLY8LGXbIEAIiOsCMgQWaIQkgBhhBASQMWFiApWFBURnEhVxILVCkidiOKgKLhnQYqIWotVXDjuH9yntX167+3t+9f7vOec5/zOec8PgBESJpHmomoAOVKFPDrYH49PSMTJvYACFUjgBCAQ5svCZwXFAADwA3l4fnSwP/wBr28AAgBw1S4kEsfh/4O6UCZXACCRAOAiEucLAZBSAMguVMgUAMgYALBTs2QKAJQAAGx5fEIiAKoNAOz0ST4FANipk9wXANiiHKkIAI0BAJkoRyQCQLsAYFWBUiwCwMIAoKxAIi4EwK4BgFm2MkcCgL0FAHaOWJAPQGAAgJlCLMwAIDgCAEMeE80DIEwDoDDSv+CpX3CFuEgBAMDLlc2XS9IzFLiV0Bp38vDg4iHiwmyxQmEXKRBmCeQinJebIxNI5wNMzgwAABr50cH+OD+Q5+bk4eZm52zv9MWi/mvwbyI+IfHf/ryMAgQAEE7P79pf5eXWA3DHAbB1v2upWwDaVgBo3/ldM9sJoFoK0Hr5i3k4/EAenqFQyDwdHAoLC+0lYqG9MOOLPv8z4W/gi372/EAe/tt68ABxmkCZrcCjg/1xYW52rlKO58sEQjFu9+cj/seFf/2OKdHiNLFcLBWK8ViJuFAiTcd5uVKRRCHJleIS6X8y8R+W/QmTdw0ArIZPwE62B7XLbMB+7gECiw5Y0nYAQH7zLYwaC5EAEGc0Mnn3AACTv/mPQCsBAM2XpOMAALzoGFyolBdMxggAAESggSqwQQcMwRSswA6cwR28wBcCYQZEQAwkwDwQQgbkgBwKoRiWQRlUwDrYBLWwAxqgEZrhELTBMTgN5+ASXIHrcBcGYBiewhi8hgkEQcgIE2EhOogRYo7YIs4IF5mOBCJhSDSSgKQg6YgUUSLFyHKkAqlCapFdSCPyLXIUOY1cQPqQ28ggMor8irxHMZSBslED1AJ1QLmoHxqKxqBz0XQ0D12AlqJr0Rq0Hj2AtqKn0UvodXQAfYqOY4DRMQ5mjNlhXIyHRWCJWBomxxZj5Vg1Vo81Yx1YN3YVG8CeYe8IJAKLgBPsCF6EEMJsgpCQR1hMWEOoJewjtBK6CFcJg4Qxwicik6hPtCV6EvnEeGI6sZBYRqwm7iEeIZ4lXicOE1+TSCQOyZLkTgohJZAySQtJa0jbSC2kU6Q+0hBpnEwm65Btyd7kCLKArCCXkbeQD5BPkvvJw+S3FDrFiOJMCaIkUqSUEko1ZT/lBKWfMkKZoKpRzame1AiqiDqfWkltoHZQL1OHqRM0dZolzZsWQ8ukLaPV0JppZ2n3aC/pdLoJ3YMeRZfQl9Jr6Afp5+mD9HcMDYYNg8dIYigZaxl7GacYtxkvmUymBdOXmchUMNcyG5lnmA+Yb1VYKvYqfBWRyhKVOpVWlX6V56pUVXNVP9V5qgtUq1UPq15WfaZGVbNQ46kJ1Bar1akdVbupNq7OUndSj1DPUV+jvl/9gvpjDbKGhUaghkijVGO3xhmNIRbGMmXxWELWclYD6yxrmE1iW7L57Ex2Bfsbdi97TFNDc6pmrGaRZp3mcc0BDsax4PA52ZxKziHODc57LQMtPy2x1mqtZq1+rTfaetq+2mLtcu0W7eva73VwnUCdLJ31Om0693UJuja6UbqFutt1z+o+02PreekJ9cr1Dund0Uf1bfSj9Rfq79bv0R83MDQINpAZbDE4Y/DMkGPoa5hpuNHwhOGoEctoupHEaKPRSaMnuCbuh2fjNXgXPmasbxxirDTeZdxrPGFiaTLbpMSkxeS+Kc2Ua5pmutG003TMzMgs3KzYrMnsjjnVnGueYb7ZvNv8jYWlRZzFSos2i8eW2pZ8ywWWTZb3rJhWPlZ5VvVW16xJ1lzrLOtt1ldsUBtXmwybOpvLtqitm63Edptt3xTiFI8p0in1U27aMez87ArsmuwG7Tn2YfYl9m32zx3MHBId1jt0O3xydHXMdmxwvOuk4TTDqcSpw+lXZxtnoXOd8zUXpkuQyxKXdpcXU22niqdun3rLleUa7rrStdP1o5u7m9yt2W3U3cw9xX2r+00umxvJXcM970H08PdY4nHM452nm6fC85DnL152Xlle+70eT7OcJp7WMG3I28Rb4L3Le2A6Pj1l+s7pAz7GPgKfep+Hvqa+It89viN+1n6Zfgf8nvs7+sv9j/i/4XnyFvFOBWABwQHlAb2BGoGzA2sDHwSZBKUHNQWNBbsGLww+FUIMCQ1ZH3KTb8AX8hv5YzPcZyya0RXKCJ0VWhv6MMwmTB7WEY6GzwjfEH5vpvlM6cy2CIjgR2yIuB9pGZkX+X0UKSoyqi7qUbRTdHF09yzWrORZ+2e9jvGPqYy5O9tqtnJ2Z6xqbFJsY+ybuIC4qriBeIf4RfGXEnQTJAntieTE2MQ9ieNzAudsmjOc5JpUlnRjruXcorkX5unOy553PFk1WZB8OIWYEpeyP+WDIEJQLxhP5aduTR0T8oSbhU9FvqKNolGxt7hKPJLmnVaV9jjdO31D+miGT0Z1xjMJT1IreZEZkrkj801WRNberM/ZcdktOZSclJyjUg1plrQr1zC3KLdPZisrkw3keeZtyhuTh8r35CP5c/PbFWyFTNGjtFKuUA4WTC+oK3hbGFt4uEi9SFrUM99m/ur5IwuCFny9kLBQuLCz2Lh4WfHgIr9FuxYji1MXdy4xXVK6ZHhp8NJ9y2jLspb9UOJYUlXyannc8o5Sg9KlpUMrglc0lamUycturvRauWMVYZVkVe9ql9VbVn8qF5VfrHCsqK74sEa45uJXTl/VfPV5bdra3kq3yu3rSOuk626s91m/r0q9akHV0IbwDa0b8Y3lG19tSt50oXpq9Y7NtM3KzQM1YTXtW8y2rNvyoTaj9nqdf13LVv2tq7e+2Sba1r/dd3vzDoMdFTve75TsvLUreFdrvUV99W7S7oLdjxpiG7q/5n7duEd3T8Wej3ulewf2Re/ranRvbNyvv7+yCW1SNo0eSDpw5ZuAb9qb7Zp3tXBaKg7CQeXBJ9+mfHvjUOihzsPcw83fmX+39QjrSHkr0jq/dawto22gPaG97+iMo50dXh1Hvrf/fu8x42N1xzWPV56gnSg98fnkgpPjp2Snnp1OPz3Umdx590z8mWtdUV29Z0PPnj8XdO5Mt1/3yfPe549d8Lxw9CL3Ytslt0utPa49R35w/eFIr1tv62X3y+1XPK509E3rO9Hv03/6asDVc9f41y5dn3m978bsG7duJt0cuCW69fh29u0XdwruTNxdeo94r/y+2v3qB/oP6n+0/rFlwG3g+GDAYM/DWQ/vDgmHnv6U/9OH4dJHzEfVI0YjjY+dHx8bDRq98mTOk+GnsqcTz8p+Vv9563Or59/94vtLz1j82PAL+YvPv655qfNy76uprzrHI8cfvM55PfGm/K3O233vuO+638e9H5ko/ED+UPPR+mPHp9BP9z7nfP78L/eE8/sl0p8zAAAAIGNIUk0AAHolAACAgwAA+f8AAIDpAAB1MAAA6mAAADqYAAAXb5JfxUYAAAPaSURBVHjavJZLaFxlFMd/577mBoKaxFRTNeILKxZf+GjyBVGULAQVLQiKCOrSZV24ExFXLnThSiSLLsSKBmp9ULpQjHeGWjEiIr5NlWq0JsFYcmfufPc7LvKNDsnNjA3qgQvzPf9z/uf/nXNEVfk/LeoeZFnWPbzWGDN/uhdmWfakMeapivs2A3obNsYsA/Pb8aAD5m0EWOpel/+a0izLxBijHW+jfgcajcZwWZbLzWYTVUVE/IoCgiqIQJqmhGE4pKpXqOpdxpgnvMfaj1IA6vXsvKJonwCWnXNYa3sCFkWLIAhXQOpJEn9XcWUCFJWUZll2blnaxTzPcW4dRERiIPVfCCogChRAoepyVS2DIGJgICUMw1FgX8fTLT2s1+tT1tpGs5kDEARBZ+ki4GbgJuAckAhYA74FPhGR90XkBCh5npOmtaU4Tt7o9yweDIJgVlVL51wH7HxgL3AbcIn/al3HVoAfQO4F3gHedq5cVFUnIvP9nsVBa+2ac64TqwuAh4DHgDG/Jwd+AqyPywhwtf+uAcZE5IBzbsFam/cD/KPVamKtRUSGQB4FHu4CWwAy4FPgFHAmcJ2neQy4FNgnIklRFDPOueNZlmGMqQbsUuAAyISnctwL4zCwH/gM+B0o/fmDwMXA/cA9wBDII6DHgZm/71y3oHtQFAXOKRCMAw8Au73+3wWeBV4DvgB+Bn711H4OvAk8D7wKtH3c71bVy9vtNln2wS2VgHmen+GcGxSRPSDTfvp74HVgrk+OOAa8BHwMOBG5wTl3R1G0MGbqva0ovQ9oAdPAsJ/+CDi6/vYoAfFeV9mX3stdwA7gso2UbhTNODAFXOkBAK4CHge+Ag4A3/Tw8jf/51a9oC4EBr3ANlMax/GxIAjOBt3RNb0LuBPYCcQ9vOvku1+8qADO8pmpWjRJkhwKAnlLVZtd06eAV4BnvED6WQv40YdoVSSwPVObKi8D1wO3+6kZ4AWvSPqVMxFZAn3OOXcoDKOFKIq2BhSRvXEczwL7rbWjQRDUgRdV9evOnjAMiaJoE7CIUJYl1to1cEeiKDoSx7XBMAyngVmfOvdsqhaNRmN3q1WsNpv5rSIcFgkWRQRVRVVJkoQ0TSsBi6Kg2VyPRprWSJLajRMTEx925epkq/K001q7lOd5O0kSV6vV/gL0papaMX7PepWREWOmljZW/74txtzcHGEYbrq4RwwBRicnJ0/27dqqzLcNK/+wger8PFnB2uk1UZ2sX9X6dVeDinMB4Cq7to2l5F/q2npT2tmwXeAsy5721eNoZYw3eti9BsTGmGI7vehWKfDPAQCBur5UzSbAZwAAAABJRU5ErkJggg==";
GWTK.imgDragPoint="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAA4AAAAOCAYAAAAfSC3RAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAIGNIUk0AAHolAACAgwAA+f8AAIDpAAB1MAAA6mAAADqYAAAXb5JfxUYAAAIhSURBVHjanNI5TFMBHMfx73vtU3kt0HIUHg03SsSkQV0kDBLAg0RFYnTARONgOjLgQFhkdK4xwcVjMBrjAVG8E0kgIboQEzxSlNRW2lJsC7xSEN7hQGwlOvGf/stn+f1+gmmabOWsf57+K5cx5JrBhWTKOzt5nx/fI4gWgWXdwb72s9jznb7EXKjnwdX+zdDmLPC9e/HktGDu4FRXK+WOALop8mW2nOcj40ynhe765jYN6AWwDAwMcGnw7eDk62cXdjlDeWc6FRo9BdRVSSgldtwlMrVKmkR4Rg4E1zz+VUdF+97KpyLAQvC9V9LXcw4daeDo4WJkyzyLS+uoqTVkKUZHRymdxxqwodqmJ8e9ACLA14m7nOzaSf2eSsKRNJphyYSg6RYiUZUGTy0tLdWMDd0gA6ORn7jzAhTaVfS/UAZrVkqcKaqLgyzGo1kIsFGK8N/oBUx0U0QzREzDyEKlrJiZWBXRpB2rRf8HSpJOJGbDH6rA4SrLwrqmboaH/Ux/CuAusyFZdUTBRBRMtksarlIHUx/8jI5+5mDXxSzML9/vk3JzVl69+cjj4QhLKwrb5DyknHziqsKjh0GGRqbQZGeq1tPkywxA+7Xc09TWqE28VM9du7NS1Na6jKsgjGGKhOcVxkYXWDQqYrubD9xcTat9m5ajJhK9ntYTNv+3pPf6rdvEo0EQBIqUSpqPn6cm13EvMRfqK3S5NwLb6sh/DwC12dDM7IcXHQAAAABJRU5ErkJggg==";GWTK.wmts=function(a,b){this.map;this.wmtsComm;null!=a&&(this.map=a,this.request="",this.handler=b,this.defaultcount=5,this.initialize())};
GWTK.wmts.prototype={initialize:function(){this.wmtsComm=new WmtsQueries(this.map.options.url,this.map);this.wmtsComm.onDataLoad=this.handler;this.featureInfo=new GWTK.featureinfo(this.map);return this},getFeatureInfo:function(a,b,c,d,e,f){if(void 0==f||0==f)f=this.defaultcount;a=this.featureInfo.getOptions(a,b,c,d,e,f);this.request="getFeatureInfo";this.wmtsComm.featureinfo(a,this.map.objectsPane)},enabled:function(){return""!=this.request?!1:!0}};GWTK.mapmath=function(a,b){this.map;this.mathComm;null!=a&&(this.map=a,this.handler=b,this.initialize())};GWTK.mapmath.prototype={initialize:function(){this.mathComm=new MapMath(this.map.options.url,this.map);this.mathComm.onDataLoad=this.handler;return this},segmentLength:function(a,b,c,d,e,f){this.mathComm.mapdistance(a,b,c,d,e,f)},enabled:function(){return null==map?!1:!0}};GWTK.mapTextSearch=function(a,b){this.wfsQuery;this.map=a;this.handler=null!=b?b:this.onDataLoadedWfs;this.startIndex=this.totalCount=0;this._pageSize=this.maxCount=this.defCount=5;this._text="";this.initialize()};
GWTK.mapTextSearch.prototype={initialize:function(){if(void 0!=typeof this.map)return this.wfsQuery=new WfsQueries(this.map.options.url,this.map),this.wfsQuery.onDataLoad=this.handler,this},setTextSearchPagination:function(a,b){if(void 0==a||0>a)a=0;this.startIndex=a;void 0==b||0>b||(this.maxCount=b)},offTextSearch:function(){if(void 0!=typeof this.map){var a=$("#inputSearchButton");0!=a.length&&$(a).addClass("hide")}},postTextSearch:function(a,b){if(!(void 0==typeof a||null==a)){var c=this.map.tiles.getTextSearchLayers();
if(0==c.length)GWTK.Util.error_report();else{void 0==b&&(b=0);var c=[],d=this.map.tiles.getTextSearchOptions();if(0!=d.list.length){this._text=a;-1<b?this.startIndex=b:this.startIndex=0;this.offTextSearch();for(var e=[],f="",g="val="+a+"*",m=0;m<d.list.length;m++){var h=d.list[m];c[m]=h.layer;for(var p=[],q=[],f=0;f<h.keys.length;f++)p[f]="=",q[f]=g;var f="("+h.keys.toString()+")",p="("+p.toString()+")",q="("+q.toString()+")",r="";1<h.keys.length&&(r="(OR)");e[m]="("+f+p+q+r+")"}this.wfsQuery.textsearch(c.toString(),
e.toString(),this.startIndex+1,this.maxCount,this.map.objectsPane)}}}},textSearchStarting:function(a,b){void 0==a||0==a.length||(void 0==b&&(b=0),GWTK.maphandlers.map.setTextSearchResPane(),this._pageSize=this.maxCount,this.setTextSearchPagination(b),this.postTextSearch(a,0))},textSearchNext:function(){var a=GWTK.maphandlers.map.mapTextSearch,b=a.startIndex;if(b>=a.totalCount)return!1;a.setTextSearchPagination(b);a.postTextSearch(a._text,a.startIndex)},refreshResult:function(){$("#fulllist").hide();
var a=this.startIndex,b=$("#featurelist")[0].childNodes.length,c=a+b;c>this.totalCount&&(c=this.totalCount);this.startIndex+=b;1>=a?$(".panel-pagination-button-left").hide():$(".panel-pagination-button-left").show();c>=this.totalCount?$(".panel-pagination-button-right").hide():($(".panel-pagination-button-right").show(),$("#fulllist").html("\u041f\u043e\u043a\u0430\u0437\u0430\u0442\u044c \u0432\u0441\u0435 "+this.totalCount),$("#fulllist").show());a++;$("#pagination_result").html("\u0420\u0435\u0437\u0443\u043b\u044c\u0442\u0430\u0442\u044b \u0441 <span>"+
a+"</span> \u043f\u043e <span>"+c+"</span>")},textSearchPrev:function(){var a=GWTK.maphandlers.map.mapTextSearch,b=a.startIndex-a.maxCount;if(0>=b||b>=a.totalCount)return!1;0<a.startIndex&&(a.startIndex=b);b=a.startIndex-a.maxCount;0>b&&(b=0);a.setTextSearchPagination(b);a.postTextSearch(a._text,a.startIndex)},textSearchFull:function(){if(GWTK.maphandlers&&GWTK.maphandlers.map){var a=GWTK.maphandlers.map.mapTextSearch;a.startIndex=0;a.maxCount=0;a.setTextSearchPagination(a.startIndex);a.postTextSearch(a._text,
a.startIndex);a.maxCount=a.defCount}},onDataLoadedWfs:function(a,b){var c=GWTK.Util.getResponseType(a),d=GWTK.maphandlers.map;$("#inputSearchButton").removeClass("hide");var e=!0;null!=c&&(4==c.length&&"wfs_featurecollection"==c[0])&&(!isNaN(c[2])&&!isNaN(c[3])&&""!=c[1]&&c[1]instanceof HTMLDivElement)&&(e=!1,d.mapTextSearch.totalCount=parseInt(c[2]),d.mapTextSearch.viewplacemark(0));e?(c=$(d.objectsPane).find("#textsearch_result"),0==c.length?b.innerHTML="":$(c[0]).html("\u041d\u0438\u0447\u0435\u0433\u043e \u043d\u0435 \u043d\u0430\u0439\u0434\u0435\u043d\u043e. \u0423\u0442\u043e\u0447\u043d\u0438\u0442\u0435 \u0437\u0430\u043f\u0440\u043e\u0441."),
c=$("#listlink").addClass("hide"),$(d.objectsPane).fadeIn("slow",function(){}),d.placemarks.splice(0,d.placemarks.length)):($("#listlink").removeClass("hide"),$(d.objectsPane).fadeIn("slow",function(){}),d.mapTextSearch.refreshResult())},viewplacemark:function(a){var b=GWTK.maphandlers.map.placemarks;0==b.length||a>=b.length||(GWTK.maphandlers.map.setViewport(b[a].latlong),GWTK.maphandlers.map.overlayRefresh())}};window.GWTK&&(GWTK.objectsSearch=function(a,b){this.wfsQuery=null;this.map=a;if(void 0==this.map||null==this.map)this.map=GWTK.maphandlers.map;this.handler=this.onDataLoaded;this.retrieveDataById=null;null!=b&&void 0!=b&&(this.retrieveDataById=b);this.dbHandler=this.retrieveDataById;this.initialize()},GWTK.objectsSearch.prototype={initialize:function(){this.map&&(this.wfsQuery=new WfsQueries(this.map.options.url,this.map),this.wfsQuery.onDataLoad=this.handler,this.selectedFeatures=new GWTK.selectedFeatures(this.map))},
onDataLoaded:function(a,b){GWTK.maphandlers.map.setTextSearchResPane();$("#listlink").hide();var c=GWTK.Util.getResponseType(a),d=GWTK.maphandlers.map;if(d){$(d.drawPane).css("cursor","default");var e=!0,f=!1;if(b instanceof HTMLDivElement)var g=b;else g=d.objectsPane,b&&!0==b&&(f=!0);null!=c&&(4==c.length&&"wfs_featurecollection"==c[0])&&(!isNaN(c[2])&&!isNaN(c[3])&&""!=c[1]&&c[1]instanceof HTMLDivElement)&&(e=!1,$("#pagination_result").html("\u0420\u0435\u0437\u0443\u043b\u044c\u0442\u0430\u0442\u044b \u0441 <span>1</span> \u043f\u043e <span>"+
c[2]+"</span>&nbsp;&nbsp;&nbsp;"),GWTK.featureSearch.searchDataByIdList());GWTK.featureSearch.retrieveDataById=GWTK.featureSearch.dbHandler;e?GWTK.Util.error_report():(f&&d.mapTextSearch.viewplacemark(0),$("#listlink").removeClass("hide"),$("#listlink").show(),$("#fulllist").hide(),$(".panel-pagination-button-left").hide(),$(".panel-pagination-button-right").hide(),$(g).fadeIn("slow",function(){}));$(d.underlayPane).fadeOut("slow",function(){})}},searchObjectsByIdList:function(a,b){var c=[],d=[];
if(!b||!a)return!1;var c=GWTK.Util.isArray(b)?b.toString():b,d=GWTK.Util.isArray(a)?a.toString():a,e={startindex:0,idlist:"",layer_id:""};e.layer_id=d;e.idlist=c;e.mapid=d;e.ObjCenter=1;this.retrieveDataById=null;this.wfsQuery.feature(e,!0);return!0},searchDataByIdList:function(){if(null==GWTK.featureSearch.retrieveDataById||void 0===GWTK.featureSearch.selectedFeatures)return!1;var a=GWTK.featureSearch.selectedFeatures.getselection();if(0==a.length)return!1;GWTK.featureSearch.retrieveDataById(a);
return!0},searchObjectsByAreaFrame:function(a){if(!a||2!=a.length||!("lat"in a[0]&&"lng"in a[0]&&"lat"in a[1]&&"lng"in a[1]))return!1;var b=GWTK.maphandlers.map.tiles.getSelectableLayers();if(0===b.length)return GWTK.Util.error_report(),!1;$(GWTK.maphandlers.map.eventPane).css("cursor","progress");GWTK.Util.clearSelection();var c={startindex:0,objlocal:"0,1,2,4",TypeNames:"*"};c.layer_id=b;c.mapid=b;c.objcenter=1;c.metric=1;c.bbox=[a[0].lat,a[0].lng,a[1].lat,a[1].lng];c.bbox=c.bbox.toString();void 0===
GWTK.featureSearch&&GWTK.selectFeatures(GWTK.maphandlers.map);GWTK.featureSearch.wfsQuery.feature(c,GWTK.maphandlers.map.objectsPane);return!0},inactivePlacemarks:function(){$(GWTK.maphandlers.map.overlayPane).hide();$(GWTK.maphandlers.map.overlayPane).show()}});window.GWTK&&(GWTK.addressSearch=function(a,b,c){this.url=this.map=null;this.geoCode=[];null!=a&&(this.map=a,this.maxCount=10,null!=c&&(this.maxCount=c),void 0!=a.options.url_addresssearch&&void 0!=a.options.url_addresssearch[0]&&(this.url=a.options.url_addresssearch[0]),null!=b&&void 0!==b&&(this.url=b),this.startIndex=this.totalCount=0)},GWTK.addressSearch.prototype={initialize:function(){return this},clearsearch:function(){this.geoCode.splice(0,this.geoCode.length);this.map.placemarkRemove();GWTK.maphandlers.map.setTextSearchResPane();
$("#listlink").show()},file_get_contents:function(a,b,c){this.clearsearch();if(null!=a){this.textSearch=a;null==b&&(b=this.maxCount);null==c&&(this.startIndex=c=0);a=this.url+this.textSearch+"&results="+b+"&skip="+c+"&format=json";$.support.cors=!0;window.XDomainRequest&&(jQuery.ajaxSettings.xhr=function(){try{return new XDomainRequest}catch(a){}});try{$.ajax({type:"GET",url:a,crossDomain:!0,success:function(a,b){if(null!=b&&"success"==b&&null!=GWTK.maphandlers.map.addressSearch)return GWTK.maphandlers.map.addressSearch.loadJson(a)},
dataType:"jsonp"})}catch(d){}}},loadJson:function(a){if(a&&a.response)if(a=a.response.GeoObjectCollection){var b=a.metaDataProperty.GeocoderResponseMetaData;if(b)if(b=b.found)if(this.totalCount=parseInt(b),0==this.totalCount)this.errorSearch();else if(a=a.featureMember,!a||0==a.length)this.errorSearch();else{for(var b=GWTK.maphandlers.map,c=$("#featurelist"),d=a.length,e,f=0;f<d;f++){this.geoCode[f]={};e=a[f];this.geoCode[f].text=e.GeoObject.metaDataProperty.GeocoderMetaData.text;this.geoCode[f].BL=
e.GeoObject.Point.pos;if(null==c)return;var g=GWTK.Util.appendListRow(c);if(null==g)return;$(g).children(".panel-info-title").append(this.geoCode[f].text);$(g).children(".panel-info-title");$(g).append(GWTK.DomUtil.create("div","panel-info-objname"));e="addrpoint_"+(f+1).toString();var m=this.geoCode[f].BL.split(" ");if(2==m.length){var h=m[0];m[0]=m[1];m[1]=h;g=$(g).children(".panel-info-img-search");null!=g&&(g[0].id=e);m=GWTK.toLatLng(m);g=GWTK.tileView.geo2pixelOffset(GWTK.maphandlers.map,m);
b.overlayAppend(m,g,!0,e)}}this.updateResult();$(b.objectsPane).fadeIn("slow",function(){})}else this.errorSearch();else this.errorSearch()}else this.errorSearch()},errorSearch:function(){var a=$(this.map.objectsPane).find("#textsearch_result");0==a.length?context.innerHTML="":$(a[0]).html("\u041d\u0438\u0447\u0435\u0433\u043e \u043d\u0435 \u043d\u0430\u0439\u0434\u0435\u043d\u043e. \u0423\u0442\u043e\u0447\u043d\u0438\u0442\u0435 \u0437\u0430\u043f\u0440\u043e\u0441.");$("#listlink").addClass("hide");
this.updateResult(!1)},textSearchPrev:function(){if(void 0==this.startIndex)return!1;var a=this.startIndex-this.maxCount;0<=a&&(this.startIndex=a);this.postTextSearch(this.startIndex)},postTextSearch:function(a){void 0==a&&(a=0);this.file_get_contents(this.textSearch,this.maxCount,a)},textSearchNext:function(){if(this.startIndex>=this.totalCount)return!1;var a=this.startIndex+this.maxCount;a<this.totalCount&&(this.startIndex=a);this.postTextSearch(this.startIndex)},updateResult:function(a){var b=
this.startIndex+1,c=this.startIndex+this.maxCount;1>=b?$(".panel-pagination-button-left").hide():$(".panel-pagination-button-left").show();c>=this.totalCount?($(".panel-pagination-button-right").hide(),c=this.totalCount):$(".panel-pagination-button-right").show();0!=$("#pagination_result").length&&$("#pagination_result").remove();if(null==a||!0==a)$(".panel-pagination-button-left").before('<span id="pagination_result">\u0420\u0435\u0437\u0443\u043b\u044c\u0442\u0430\u0442\u044b \u0441 <span>'+b+"</span> \u043f\u043e <span>"+
c+"</span></span>"),$(".panel-pagination-button-left").click(function(){GWTK.maphandlers.map.addressSearch.textSearchPrev()}),$(".panel-pagination-button-right").click(function(){GWTK.maphandlers.map.addressSearch.textSearchNext()})},set_pane:function(){if(void 0===GWTK.maphandlers.map.addressSearch||!GWTK.maphandlers.map.addressSearch.isActive())return!1;var a=document.createElement("div"),b=document.createElement("label"),c=GWTK.maphandlers.map.options.url_addresssearch[1],d=document.createElement("input");
d.type="checkbox";d.id="addressSearchAction";d.checked=!1;d.title=c;b.className="panel-textsearch-toggler";$(d).on("change",this.addressSearchAction_change);b.appendChild(d);b.appendChild(document.createTextNode(d.title));a.appendChild(b);GWTK.maphandlers.map.textSearchPane.appendChild(a)},addressSearchAction_change:function(a){GWTK.maphandlers.toggle_textsearchinmap(!a.currentTarget.checked,GWTK.maphandlers.map.addressSearch.textsearchaddress_click);void 0!=a.bubbles&&GWTK.Map.prototype._writeCookiePanels()},
isActive:function(){return null===this.url||void 0===this.url||0==this.url.length?!1:!0},textsearchaddress_click:function(a){if(void 0===GWTK.maphandlers.map.addressSearch)return!1;a=$("#inputSearchText");if(void 0===typeof a)return!1;a=a.val();if(0==a.length)return!1;GWTK.maphandlers.ontextsearch_next=GWTK.maphandlers.map.addressSearch.textSearchNext;GWTK.maphandlers.ontextsearch_prev=GWTK.maphandlers.map.addressSearch.textSearchPrev;GWTK.maphandlers.map.addressSearch.file_get_contents(a);return!1}});window.GWTK&&(GWTK.selectAreaRect=function(a){this.toolname="selectAreaRect";this.container=a?a:GWTK.maphandlers.map.drawPane;a=GWTK.maphandlers.map.getWindowSize();this.container.style.width=a[0]+"px";this.container.style.height=a[1]+"px";0==$(this.container).find(".selectframe").length&&(this.canvas=GWTK.DomUtil.create("div","selectframe"),this.container.appendChild(this.canvas),this.canvas.id="imageTemp");this.y0=this.x0=0;this.error=!1;this.handler=null},GWTK.selectAreaRect.prototype={init:function(){this.started=
!1;$(this.container).off();$(this.container).on("mousedown",this.mousedown);$(this.container).on("mousemove",this.mousemove);$(this.container).on("mouseup",this.mouseup);$(this.container).on("mousewheel DOMMouseScroll wheel MozMousePixelScroll",GWTK.maphandlers.mousewheelscaling);var a=GWTK.maphandlers.map.getWindowSize();this.container.style.width=a[0]+"px";this.container.style.height=a[1]+"px"},setTool:function(a){this.container&&this.canvas&&(this.init(),this.container.style.zIndex=6,this.clearRectImage(),
this.handler=a?a:this.onRectReady)},mousedown:function(a){var b=GWTK.maphandlers.map.mapTool("selectAreaRect");if(b.started)return!1;b.started=!0;b.point1=null;b.point2=null;b.clearRectImage();b.point1=GWTK.DomEvent.getMousePosition(a,GWTK.maphandlers.map.panes.eventPane);b.canvas.style.left=b.point1.x+"px";b.canvas.style.top=b.point1.y+"px";b.x0=b.point1.x;b.y0=b.point1.y;b.canvas.style.width=0;b.canvas.style.height=0},mousemove:function(a){if("drawPane"===a.currentTarget.id){var b=GWTK.maphandlers.map.mapTool("selectAreaRect");
if(!b.started)return!1;var c=GWTK.DomEvent.getMousePosition(a,b.container),d=Math.min(c.x,b.x0),e=Math.min(c.y,b.y0),f=Math.abs(c.x-b.x0),c=Math.abs(c.y-b.y0);if(!f||!c)return!1;b.canvas.style.top=e+"px";b.canvas.style.left=d+"px";b.canvas.style.width=f+"px";b.canvas.style.height=c+"px";b.point2=GWTK.DomEvent.getMousePosition(a,GWTK.maphandlers.map.panes.eventPane);return!1}},mouseup:function(a){var b=GWTK.maphandlers.map.mapTool("selectAreaRect");if(1>=Math.abs(a.offsetX-b.x0)&&1>=Math.abs(a.offsetY-
b.y0))return!1;b.mousemove(a);b.started=!1;b.image_update();a=b.toGeo();if(0===a.length)return!1;b.handler&&b.handler(a);$(b.container).css("cursor","progress");return!1},toGeo:function(){if(!this.point1||!this.point2)return[];var a=GWTK.maphandlers.map.tiles.getLayersPointProjected(this.point1),b=GWTK.projection.xy2geo(GWTK.maphandlers.map.options.crs,a.y,a.x),b=GWTK.toLatLng(b),a=GWTK.maphandlers.map.tiles.getLayersPointProjected(this.point2),a=GWTK.projection.xy2geo(GWTK.maphandlers.map.options.crs,
a.y,a.x),a=GWTK.toLatLng(a),c=GWTK.toLatLng(0,0),d=GWTK.toLatLng(0,0);c.lat=Math.min(b.lat,a.lat);c.lng=Math.min(b.lng,a.lng);d.lat=Math.max(b.lat,a.lat);d.lng=Math.max(b.lng,a.lng);return[c,d]},image_update:function(){var a=GWTK.maphandlers.map.mapTool("selectAreaRect");if(!a.started){var b=GWTK.maphandlers.map.underlayPane;b.style.left="0px";b.style.top="0px";b=$(b).find("#areaRect");0==b.length?(b=GWTK.DomUtil.create("div","selectframe",GWTK.maphandlers.map.underlayPane),b.id="areaRect"):b=b[0];
b.style.top=a.canvas.style.top;b.style.left=a.canvas.style.left;b.style.width=a.canvas.style.width;b.style.height=a.canvas.style.height;a.clearRect()}},clearRect:function(){var a=GWTK.maphandlers.map.mapTool("selectAreaRect");a.canvas.style.left="-100px";a.canvas.style.top="-100px";a.canvas.style.width=0;a.canvas.style.height=0},clearRectImage:function(){var a=$(GWTK.maphandlers.map.underlayPane).find("#areaRect");0!=a.length&&(a=a[0],a.style.top="-10px",a.style.left="-10px",a.style.width="0px",a.style.height=
"0px")},clear:function(){this.clearRect();$(this.container).off("mousedown",this.mousedown);$(this.container).off("mousemove",this.mousemove);$(this.container).off("mouseup",this.mouseup);$(this.container).off("mousewheel DOMMouseScroll wheel MozMousePixelScroll",GWTK.maphandlers.mousewheelscaling);this.container.style.zIndex=2;this.started=!1;this.point2=this.point1=null},onRectReady:function(a){}});window.GWTK&&(GWTK.TextSearchControl=function(a){this.parent=a;this.initTextSearchPane(a)},GWTK.TextSearchControl.prototype={initTextSearchPane:function(a){if(!(void 0===GWTK.maphandlers||void 0===GWTK.maphandlers.map))if(!(void 0===a||null==a)){var b=document.createElement("div");b.className="panel-textsearch-container";var c=document.createElement("input");c.setAttribute("type","text");c.setAttribute("class","panel-textsearch-input");c.setAttribute("name","inputSearchText");c.setAttribute("id",
"inputSearchText");c.value="";c.title="\u0412\u0432\u0435\u0441\u0442\u0438 \u043f\u043e\u0438\u0441\u043a\u043e\u0432\u044b\u0439 \u0437\u0430\u043f\u0440\u043e\u0441";b.appendChild(c);c=GWTK.DomUtil.create("img","panel-textsearch-image-ok");b.appendChild(c);c.src=GWTK.imgsearch;c.id="inputSearchButton";c.name="inputSearchButton";$(c).on("click",GWTK.maphandlers.textsearchinmap_click);a.appendChild(b)}},offTextSearch:function(){var a=$("#inputSearchButton");0!=a.length&&$(a).addClass("hide")},onTextSearch:function(){var a=
$("#inputSearchButton");0!=a.length&&$(a).removeClass("hide")},textValue:function(){var a=$("#inputSearchText").val();return void 0===a||0===a.length?"":a}});window.GWTK&&(GWTK.ItemData=function(){this.alias=this.itemid=null;this.expanded=!0;this.group=!1;this.img=null;this.checked=!1;this.clickable=!0},GWTK.MapContentControl=function(a){this.parent=a;this.initMapContentPane(a)},GWTK.MapContentControl.prototype={initMapContentPane:function(a){if(!(void 0==GWTK.maphandlers||void 0==GWTK.maphandlers.map))if(!(void 0==a||null==a)){var b=document.createElement("div");b.setAttribute("class","w2ui-reset w2ui-sidebar resizable panel-mapcontent-container");b.setAttribute("name",
"MapContent");b.setAttribute("id","MapContent");a.appendChild(b);this.createTree();a=this.prepareItemText();void 0!=a&&this.readjsonstr(a);this.setLayersVisibility()}},createTree:function(){$("#MapContent").w2sidebar({name:"MapContent"})},addItems:function(a,b){for(var c=!1,d=GWTK.maphandlers.map,e=0;e<d.layers.length;e++)if(d.layers[e].xId==b.itemid){c=!0;!1==b.clickable&&(c=!1);break}!0==b.group?c=null==a?{id:b.itemid,text:b.alias,group:b.group,expanded:b.expanded,img:b.img}:{id:b.itemid,text:b.alias,
expanded:b.expanded,img:b.img}:(!0==c?(c="<div> "+b.alias+" <input ",b.checked&&(c+=" checked "),c=c+'id="chbx_'+b.itemid+'" type="checkbox" value = "'+b.itemid+'" style="float:left" onClick=" GWTK.maphandlers.map.mapcontent.ItemChecked(event);" class="mapcontent-item-img"></div>'):c="<div> "+b.alias+"</div>",c={id:b.itemid,text:c,expanded:b.expanded,img:b.img});void 0!=c&&(null==a?w2ui.MapContent.add(c):w2ui.MapContent.add(a,c));return c.id},delItems:function(a){w2ui.MapContent.remove(a)},clearAllItems:function(){for(;0<
w2ui.MapContent.nodes.length;)w2ui.MapContent.remove(w2ui.MapContent.nodes[0].id)},destroy:function(){this.clearAllItems();w2ui.MapContent.destroy();$(this.parent).remove("#MapContent")},setChecked:function(a){if(a&&0!=w2ui.MapContent.find({id:a}).length){var b=document.getElementById("chbx_"+a);void 0!=b&&(b.checked=!0);this.ReplaceItemText(a)}},setUnChecked:function(a){if(a&&0!=w2ui.MapContent.find({id:a}).length){var b=document.getElementById("chbx_"+a);void 0!=b&&(b.checked=!1);this.ReplaceItemText(a)}},
readcnfgfile:function(a){this.clearAllItems();var b=this;a||(a=GWTK.maphandlers.map.options.mapcontenttree);if(void 0==a||""==a){a=GWTK.maphandlers.map;var c,d=a.layers.length;for(c=0;c<d;c++)GWTK.ItemData.itemid=a.layers[c].xId,GWTK.ItemData.alias=a.layers[c].alias,GWTK.ItemData.checked=!0==a.layers[c].visible?!0:!1,GWTK.ItemData.group=!1,GWTK.ItemData.expanded=!0,this.addItems(null,GWTK.ItemData)}else jQuery.ajax({type:"GET",url:a,dataType:"xml",success:function(a){var c=GWTK.maphandlers.map,d=
c.tiles;$(a).find("LayerGroup").each(function(){var a=$(this).attr("alias"),e=$(this).attr("Id"),p=$(this).attr("expanded"),q=$(this).attr("img"),r=$(this).attr("InGroupId");r||(r=null);GWTK.ItemData.itemid=e;GWTK.ItemData.alias=a;GWTK.ItemData.expanded=p;GWTK.ItemData.group=!0;GWTK.ItemData.img=q;b.addItems(r,GWTK.ItemData);$(this).find("Layer").each(function(){var p=$(this).attr("Id"),r=$(this).attr("isfolder"),t=$(this).attr("expanded");q=$(this).attr("img");a=$(this).attr("alias");var w=$(this).attr("clickable");
void 0==w&&(w=!0);w=GWTK.Util.parseBoolean(w);if(r)GWTK.ItemData.itemid=p,GWTK.ItemData.alias=a,GWTK.ItemData.expanded=t,GWTK.ItemData.group=!0,GWTK.ItemData.img=q,b.addItems(e,GWTK.ItemData);else for(r=0;r<c.layers.length;r++){if(c.layers[r].xId==p){a=c.layers[r].alias;GWTK.ItemData.itemid=p;GWTK.ItemData.alias=a;GWTK.ItemData.checked=!0==c.layers[r].visible?!0:!1;GWTK.ItemData.clickable=w;GWTK.ItemData.expanded=t;GWTK.ItemData.group=!1;GWTK.ItemData.img=q;b.addItems(e,GWTK.ItemData);(p=d.getLayerLegendByxId(p))&&
0<p.items.length&&w2ui.MapContent.add(e,p.items);break}a&&(GWTK.ItemData.itemid="",GWTK.ItemData.alias=a,GWTK.ItemData.expanded=t,GWTK.ItemData.group=!1,GWTK.ItemData.img=q,b.addItems(e,GWTK.ItemData))}})});w2ui.MapContent.on("click",function(a){})},error:function(a,b){var c=GWTK.maphandlers.map,d,h=c.layers.length;for(d=0;d<h;d++){GWTK.ItemData.itemid=c.layers[d].xId;GWTK.ItemData.alias=c.layers[d].alias;GWTK.ItemData.checked=!0==c.layers[d].visible?!0:!1;GWTK.ItemData.group=!1;GWTK.ItemData.img=
"icon-page";GWTK.ItemData.expanded=!0;var p="<div> "+ItemData.alias+" <input ";ItemData.checked&&(p+=" checked ");p=p+'id="chbx_'+ItemData.itemid+'" type="checkbox" value = "'+ItemData.itemid+'" style="float:left" onClick=" GWTK.maphandlers.map.mapcontent.ItemChecked(event);" class="mapcontent-item-img"></div>';data={id:GWTK.ItemData.itemid,text:p,expanded:GWTK.ItemData.expanded,img:GWTK.ItemData.img};w2ui.MapContent.add(data)}}})},ItemChecked:function(a){a=a||window.event;var b=a.currentTarget;if(!b)if(a.srcElement)b=
a.srcElement;else return!1;var c=b.value,d=-1,e;for(e in GWTK.maphandlers.map.options.layers)null!=GWTK.maphandlers.map.options.layers[e]&&GWTK.maphandlers.map.options.layers[e].id==c&&(d=e);-1!=d&&(b.checked!=GWTK.maphandlers.map.layers[d].visible&&GWTK.maphandlers.layer_visible(a),this.ReplaceItemText(c))},ReplaceItemText:function(a){if(a){var b=w2ui.MapContent.find({id:a});if(0!=b.length&&(b=b[0].text,0!=b.indexOf(b,"chbx_"+a))){if(void 0!=b&&""!=b)if(!0==document.getElementById("chbx_"+a).checked){var c=
b.indexOf("<input id");-1!=c&&(b=b.replace("<input id","<input checked id"))}else c=b.indexOf("<input checked id"),-1!=c&&(b=b.replace("<input checked id","<input id"));if((a=w2ui.MapContent.get(a))&&a.text)a.text=b}}},ItemHide:function(a){w2ui.MapContent.hide(a);a=w2ui.MapContent.get(a);do{for(var b=!1,c=0;c<a.parent.nodes.length;++c)if(!1==a.parent.nodes[c].hidden){b=!0;break}!1==b&&w2ui.MapContent.hide(a.parent.id);a=w2ui.MapContent.get(a.parent.id)}while(null!=a)},ItemShow:function(a){w2ui.MapContent.show(a);
a=w2ui.MapContent.get(a);do w2ui.MapContent.show(a.parent.id),a=w2ui.MapContent.get(a.parent.id);while(null!=a)},readjsonstr:function(a){this.clearAllItems();w2ui.MapContent.add(a)},prepareItemText:function(){function a(b){var c=b.text,d="",m="";if(""==c||void 0==c){var h,p=GWTK.maphandlers.map.layers.length;for(h=0;h<p;h++)GWTK.maphandlers.map.layers[h].xId==b.id&&(c=GWTK.maphandlers.map.layers[h].alias)}b.clickable&&(d='<input checked id="chbx_'+b.id+'" type="checkbox" value = "'+b.id+'" style="float:left" onClick="GWTK.maphandlers.map.mapcontent.ItemChecked(event);" class="mapcontent-item-img">');
void 0!=b.t_img&&(m='<img src = "'+b.t_img+'" class="mapcontent-item-img"> ');!0!=b.group&&(b.text="<div>"+d+m+c+"</div>");if(void 0!=b.nodes)for(c=b.nodes.length-1;0<=c;--c)a(b.nodes[c])}if(void 0==GWTK.maphandlers.map.options.contenttree||""==GWTK.maphandlers.map.options.contenttree){var b=GWTK.maphandlers.map,c,d=b.layers.length;for(c=0;c<d;c++)GWTK.ItemData.itemid=b.layers[c].xId,GWTK.ItemData.alias=b.layers[c].alias,GWTK.ItemData.checked=!0==b.layers[c].visible?!0:!1,GWTK.ItemData.group=!1,GWTK.ItemData.expanded=
!0,this.addItems(null,GWTK.ItemData)}else{b=JSON.parse(JSON.stringify(GWTK.maphandlers.map.options.contenttree));for(c=b.length-1;0<=c;--c)a(b[c]);return b}},setLayersVisibility:function(){var a=GWTK.maphandlers.map,b,c=a.layers.length;for(b=0;b<c;b++)!1==a.layers[b].visible&&this.setUnChecked(a.layers[b].xId)}});if(window.GWTK){var close_RU="\u0417\u0430\u043a\u0440\u044b\u0442\u044c",mapRosreestr_button_RU="\u0421\u0432\u0435\u0434\u0435\u043d\u0438\u044f \u0433\u043e\u0441\u0443\u0434\u0430\u0440\u0441\u0442\u0432\u0435\u043d\u043d\u043e\u0433\u043e \u043a\u0430\u0434\u0430\u0441\u0442\u0440\u0430 \u043d\u0435\u0434\u0432\u0438\u0436\u0438\u043c\u043e\u0441\u0442\u0438",mapRosreestr_tab4_RU="\u041e\u043a\u0440\u0443\u0433",mapRosreestr_tab3_RU="\u0420\u0430\u0439\u043e\u043d",mapRosreestr_tab2_RU="\u041a\u0432\u0430\u0440\u0442\u0430\u043b",
mapRosreestr_tab1_RU="\u0423\u0447\u0430\u0441\u0442\u043e\u043a",mapRosreestr_tab0_RU="\u041e\u041a\u0421";GWTK.rosreestr=function(a){this.map;this.panel;null!=a&&(this.map=a,this.initRes("RU"),this.rosreestrControl=null,this.initialize())};GWTK.rosreestr.prototype={initialize:function(){if(!1==this.map instanceof GWTK.Map)return this;if(null!=this.map.panes&&null!=this.map.panes.toolbarPane){var a=GWTK.DomUtil.create("div","control-button control-button-maprosreestr clickable",this.map.panes.toolbarPane);
a.id="panel_button-mapRosreestr";a.disabled=!1;a.title=this.res_mapRosreestr_button;a._pane="rosreestr1";_Rosreestr=this;$("#panel_button-mapRosreestr").click(function(a){$(a.currentTarget).hasClass("control-button-active")?($(a.currentTarget).removeClass("control-button-active"),$(GWTK.maphandlers.map.panes.eventPane).on("click",GWTK.maphandlers.mapclick),_Rosreestr.destroy()):($(a.currentTarget).addClass("control-button-active"),_Rosreestr.rosreestrControl=new GWTK.rosreestrControl("1",_Rosreestr.map.mapPane));
void 0!=a.cancelable&&GWTK.Map.prototype._writeCookiePanels()});$(document).ready(function(){GWTK.rosreestr.prototype._readCookie()})}return this},initRes:function(a){switch(a){case "RU":this.res_mapRosreestr_button=window.mapRosreestr_button_RU}},destroy:function(){null!=this.rosreestrControl&&void 0!=this.rosreestrControl&&(this.rosreestrControl.destroy(),this.rosreestrControl=null);null==this.map||null==this.map.mapPane||(null!=this.panel&&(GWTK.routeUtil.removeAllChild(this.panel),this.map.mapPane.removeChild(this.panel)),
this.panel=null)},_readCookie:function(){var a=GWTK.cookie("VisiblePanels",GWTK.cookies.converter);void 0!==a&&$.each(a,function(a,c){var d=c.shift(),e=0<c.length?c.shift():"",e=e.split(",");"panel_button-mapRosreestr"==d&&(button=$("#"+d),panel=button[0]._pane,"show"==e[0]&&($("#panel_button-mapRosreestr").click(),GWTK.maphandlers.map.setMapContentPanel()))})}};GWTK.rosreestrControl=function(a,b,c,d,e,f){this.id=a;this.parentstr="rosreestr_"+a;null!=b&&void 0!=b&&(this.parentdiv=b);this.mapdiv=null!=
c&&void 0!=c?this.mapdiv:this.parentdiv;this.point=null;void 0!=d&&(null!=d&&void 0!=e&&null!=e)&&(this.point=new GWTK.Point(d,e));this.activetab="tab_4";null!=f&&void 0!=f&&(this.activetab="tab_"+f.toString());this.parts=[];this.okss=[];this.initRes("RU");this.initialize()};GWTK.rosreestrControl.prototype={initialize:function(){if(void 0==this.parentdiv||null==this.parentdiv)return this;this.panel=GWTK.DomUtil.create("div","mapRosreestr-panel map-panel-def",this.parentdiv);this.panel.id=this.parentstr;
$("#"+this.parentstr).append('<div id="rosreestrControlName_'+this.id+'" class="routeFilesName" align="left">'+this.res_mapRosreestr_button+'<img class="panel-info-close" title="'+this.res_close+'" src="'+GWTK.imgClose+'" ></div><div id="rosreestr_tabs" style="width: 100%;"></div><div id="rosreestr_selected-tab" style="padding: 10px 10px"><div id="rosreestr_name" class="routeFilesName"> </div> </br><div id="rosreestr_info"> </div></div>');var a=this;$(document).ready(function(){$("#rosreestr_tabs").w2tabs({name:"tabs",
active:a.activetab,tabs:[{id:"tab_4",caption:a.res_mapRosreestr_tab4},{id:"tab_3",caption:a.res_mapRosreestr_tab3},{id:"tab_2",caption:a.res_mapRosreestr_tab2},{id:"tab_1",caption:a.res_mapRosreestr_tab1},{id:"tab_0",caption:a.res_mapRosreestr_tab0}],onClick:function(b){b.target!=a.activetab&&a.cleartab();a.onclick(b.target);b=b.target.split("_");void 0!=b&&(null!=b&&2<=b.length)&&a.eventChangeTab(b[1]);return!1}});$("#rosreestrControlName_"+a.id).children(".panel-info-close").click(function(b){a.destroy();
$("#panel_button-mapRosreestr").click();return!1})});$(this.mapdiv).on("mapclick",function(b){a.cleartab();a.setPoint(b.coord.x,b.coord.y);if(!(void 0==w2ui.tabs||null==w2ui.tabs))return a.onclick(w2ui.tabs.active),$("#"+a.parentstr).show(),!1});return this},getActivetabId:function(){if(!(void 0==w2ui.tabs||null==w2ui.tabs))return w2ui.tabs.active},setPoint:function(a,b){this.parts.splice(0,this.parts.length);this.okss.splice(0,this.okss.length);void 0==a||void 0==b||(this.point=new GWTK.Point(a,
b))},show:function(a){a?$("#"+this.parentstr).show():$("#"+this.parentstr).hide()},onclick:function(a){a=a.split("_");void 0==a||(null==a||2>a.length)||void 0!=this.point&&null!=this.point&&this.setRequest(this,a[1],this.point)},destroy:function(){var a=$("#rosreestr_tabs");null!=a&&0<a.length&&w2ui.tabs.destroy();$("#"+this.parentstr).remove()},cleartab:function(){$("#rosreestr_name").html("");$("#rosreestr_info").html("")},initRes:function(a){switch(a){case "RU":this.res_close=window.close_RU,this.res_mapRosreestr_tab4=
window.mapRosreestr_tab4_RU,this.res_mapRosreestr_tab3=window.mapRosreestr_tab3_RU,this.res_mapRosreestr_tab2=window.mapRosreestr_tab2_RU,this.res_mapRosreestr_tab1=window.mapRosreestr_tab1_RU,this.res_mapRosreestr_tab0=window.mapRosreestr_tab0_RU,this.res_mapRosreestr_button=window.mapRosreestr_button_RU}},setRequest:function(a,b,c){if(!(void 0==a||null==a||0>b||4<b))if(c="http://maps.rosreestr.ru/arcgis/rest/services/Cadastre/CadastreSelected/MapServer/"+b.toString()+"/query?where=&text=&objectIds=&time=&geometry="+
c.x.toString()+","+c.y.toString()+"&geometryType=esriGeometryPoint&inSR=&spatialRel=esriSpatialRelIntersects&relationParam=&outFields=*&returnGeometry=false&maxAllowableOffset=&geometryPrecision=&outSR=&returnIdsOnly=false&returnCountOnly=false&orderByFields=&groupByFieldsForStatistics=&outStatistics=&returnZ=false&returnM=false&gdbVersion=&returnDistinctValues=false&f=pjson",window.XDomainRequest)try{req=new XDomainRequest,req.timeout=6E4,req.open("get",c,!1),req.onload=function(c){return a.loadData(req.responseText,
b)},req.send(null)}catch(d){}else try{$.get(c,function(c,d){if(null!=d&&"success"==d)return a.loadData(c,b)},"text")}catch(e){}},loadData:function(a,b){if(!(void 0==a||null==a)){var c=$.parseJSON(a);if(!(void 0==c||null==c||void 0==c.features||null==c.features||0==c.features.length)){var d=c.features[0],e="",f="",g=this;switch(b){case "4":e=d.attributes.ANNO_TEXT+" - "+d.attributes.NAME;$("#rosreestr_name").html(e);null!=d.attributes.PARCELS_CNT&&(f+="\u0423\u0447\u0430\u0441\u0442\u043a\u043e\u0432: "+
d.attributes.PARCELS_CNT+"</br>");null!=d.attributes.OKS_CNT&&(f+="\u041e\u041a\u0421: "+d.attributes.OKS_CNT+"</br>");null!=d.attributes.KVARTALS_CNT&&(f+="\u041a\u0432\u0430\u0440\u0442\u0430\u043b\u043e\u0432: "+d.attributes.KVARTALS_CNT+"</br>");null!=d.attributes.RAYONS_CNT&&(f+="\u0420\u0430\u0439\u043e\u043d\u043e\u0432: "+d.attributes.RAYONS_CNT+"</br>");f+="\u0414\u0430\u0442\u044b \u043e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u044f: </br>";null!=d.attributes.ACTUAL_DATE&&(f+="\u0413\u0440\u0430\u043d\u0438\u0446: "+
(new Date(d.attributes.ACTUAL_DATE)).toLocaleString()+"</br>");null!=d.attributes.ONLINE_ACTUAL_DATE&&(f+="\u0410\u0442\u0440\u0438\u0431\u0443\u0442\u043e\u0432: "+(new Date(d.attributes.ONLINE_ACTUAL_DATE)).toLocaleString()+"</br>");$("#rosreestr_info").html(f);break;case "3":e=d.attributes.CAD_NUM+" - "+d.attributes.NAME;$("#rosreestr_name").html(e);null!=d.attributes.PARCELS_CNT&&(f+="\u0423\u0447\u0430\u0441\u0442\u043a\u043e\u0432: "+d.attributes.PARCELS_CNT+"</br>");null!=d.attributes.OKS_CNT&&
(f+="\u041e\u041a\u0421: "+d.attributes.OKS_CNT+"</br>");null!=d.attributes.KVARTALS_CNT&&(f+="\u041a\u0432\u0430\u0440\u0442\u0430\u043b\u043e\u0432: "+d.attributes.KVARTALS_CNT+"</br>");f+="\u0414\u0430\u0442\u044b \u043e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u044f: </br>";null!=d.attributes.ACTUAL_DATE&&(f+="\u0413\u0440\u0430\u043d\u0438\u0446: "+(new Date(d.attributes.ACTUAL_DATE)).toLocaleString()+"</br>");null!=d.attributes.ONLINE_ACTUAL_DATE&&(f+="\u0410\u0442\u0440\u0438\u0431\u0443\u0442\u043e\u0432: "+
(new Date(d.attributes.ONLINE_ACTUAL_DATE)).toLocaleString()+"</br>");$("#rosreestr_info").html(f);break;case "2":e=d.attributes.CAD_NUM;$("#rosreestr_name").html(e);null!=d.attributes.PARCELS_CNT&&(f+="\u0423\u0447\u0430\u0441\u0442\u043a\u043e\u0432: "+d.attributes.PARCELS_CNT+"</br>");null!=d.attributes.OKS_CNT&&(f+="\u041e\u041a\u0421: "+d.attributes.OKS_CNT+"</br>");f+="\u0414\u0430\u0442\u044b \u043e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u044f: </br>";null!=d.attributes.KVARTAL_DATE&&
(f+="\u041a\u0432\u0430\u0440\u0442\u0430\u043b\u043e\u0432: "+(new Date(d.attributes.KVARTAL_DATE)).toLocaleString()+"</br>");null!=d.attributes.PARCELS_DATE&&(f+="\u0420\u0430\u0439\u043e\u043d\u043e\u0432: "+(new Date(d.attributes.PARCELS_DATE)).toLocaleString()+"</br>");$("#rosreestr_info").html(f);break;case "1":$("#rosreestr_info").html("");if(0==this.parts.length)for(d=0;d<c.features.length;d++)this.parts.push(c.features[d]);c="";for(d=0;d<this.parts.length;d++)null!=this.parts[d].attributes.CAD_NUM&&
(c+='<div class="routeFilesName" style="cursor=pointer;" id="part_'+d.toString()+'" >'+this.parts[d].attributes.CAD_NUM+"</div> ");$("#rosreestr_name").html(c);for(d=0;d<this.parts.length;d++)$("#part_"+d.toString()).on("click",function(a){a=$(a.target)[0].id.split("_");if(void 0==a||null==a||2>a.length)return!1;g.setRequest_cadnum(g,a[1]);return!1});this.setRequest_cadnum(this,"0");break;case "0":$("#rosreestr_info").html("");if(0==this.okss.length)for(d=0;d<c.features.length;d++)this.okss.push(c.features[d]);
c="";for(d=0;d<this.okss.length;d++)null!=this.okss[d].attributes.CAD_NUM&&(c+='<div class="routeFilesName" style="cursor=pointer;" id="okss_'+d.toString()+'" >'+this.okss[d].attributes.CAD_NUM+"</div> ");$("#rosreestr_name").html(c);for(d=0;d<this.okss.length;d++)$("#okss_"+d.toString()).on("click",function(a){a=$(a.target)[0].id.split("_");if(void 0==a||null==a||2>a.length)return!1;g.setRequest_cadnum(g,a[1],!0);return!1});this.setRequest_cadnum(this,"0",!0)}}}},setRequest_cadnum:function(a,b,c){if(!(void 0==
a||null==a||void 0==b||null==b)){var d="",d=c?this.okss[parseInt(b)].attributes.CAD_NUM.split(":"):this.parts[parseInt(b)].attributes.CAD_NUM.split(":");if(!(void 0==d||null==d||0==d.length)){b="";for(var e=0;e<d.length;e++)b=e!=d.length-1?b+(d[e]+"%3A"):b+d[e];d="http://maps.rosreestr.ru/arcgis/rest/services/Cadastre/CadastreSelected/MapServer/exts/GKNServiceExtension/online/parcel/find?cadNum="+b+"&onlyAttributes=false&returnGeometry=true&f=json";if(window.XDomainRequest)try{req=new XDomainRequest,
req.timeout=6E4,req.open("get",d,!1),req.onload=function(b){return a.loadData_cadnum(req.responseText,c)},req.send(null)}catch(f){}else try{$.get(d,function(b,d){if(null!=d&&"success"==d)return a.loadData_cadnum(b,c)},"text")}catch(g){}}}},loadData_cadnum:function(a,b){if(!(void 0==a||null==a)){var c=$.parseJSON(a);if(!(void 0==c||null==c||void 0==c.features||null==c.features||0==c.features.length)){var c=c.features[0],d="";null!=c.attributes.CAD_NUM&&(d+="\u041a\u0430\u0434\u0430\u0441\u0442\u0440\u043e\u0432\u044b\u0439 \u043d\u043e\u043c\u0435\u0440: "+
c.attributes.CAD_NUM+"</br>");null!=c.attributes.OBJECT_ADDRESS&&(d+="\u0410\u0434\u0440\u0435\u0441: "+c.attributes.OBJECT_ADDRESS+"</br>");null!=c.attributes.AREA_VALUE&&(d+="\u0423\u0442\u043e\u0447\u043d\u0435\u043d\u043d\u0430\u044f \u043f\u043b\u043e\u0449\u0430\u0434\u044c: "+c.attributes.AREA_VALUE+"</br>");null!=c.attributes.CAD_COST&&(d+="\u041a\u0430\u0434\u0430\u0441\u0442\u0440\u043e\u0432\u0430\u044f \u0441\u0442\u043e\u0438\u043c\u043e\u0441\u0442\u044c: "+c.attributes.CAD_COST+"</br>");
d=null!=c.attributes.FORM_RIGHTS?d+("\u0424\u043e\u0440\u043c\u0430 \u0441\u043e\u0431\u0441\u0442\u0432\u0435\u043d\u043d\u043e\u0441\u0442\u0438: "+c.attributes.FORM_RIGHTS+"</br>"):d+"\u0424\u043e\u0440\u043c\u0430 \u0441\u043e\u0431\u0441\u0442\u0432\u0435\u043d\u043d\u043e\u0441\u0442\u0438: \u043d\u0435 \u043e\u043f\u0440\u0435\u0434\u0435\u043b\u0435\u043d\u0430</br>";if(null!=c.attributes.STATE_CODE)switch(d+="\u0421\u0442\u0430\u0442\u0443\u0441 \u0443\u0447\u0430\u0441\u0442\u043a\u0430: ",
c.attributes.STATE_CODE){case "01":d+="\u0420\u0430\u043d\u0435\u0435 \u0443\u0447\u0442\u0435\u043d\u044b\u0439";break;case "03":d+="\u0423\u0441\u043b\u043e\u0432\u043d\u044b\u0439";break;case "04":d+="\u0412\u043d\u0435\u0441\u0435\u043d\u043d\u044b\u0439";break;case "05":d+="\u0412\u0440\u0435\u043c\u0435\u043d\u043d\u044b\u0439 (\u0423\u0434\u043e\u0441\u0442\u043e\u0432\u0435\u0440\u0435\u043d)";break;case "06":d+="\u0417\u0430\u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0438\u0440\u043e\u0432\u0430\u043d (\u0423\u0447\u0442\u0435\u043d\u044b\u0439)";
break;case "07":d+="\u0421\u043d\u044f\u0442 \u0441 \u0443\u0447\u0435\u0442\u0430";break;case "08":d+="\u0410\u043d\u043d\u0443\u043b\u0438\u0440\u043e\u0432\u0430\u043d\u043d\u044b\u0439";break;case "00":d+="\u041d\u0435\u043e\u043f\u0440\u0435\u0434\u0435\u043b\u0435\u043d\u043e"}d+="</br>";null!=c.attributes.DATE_CREATE&&(d+="\u0414\u0430\u0442\u0430 \u0441\u043e\u0437\u0434\u0430\u043d\u0438\u044f: "+(new Date(c.attributes.DATE_CREATE)).toLocaleString()+"</br>");null!=c.attributes.ACTUAL_DATE&&
(d=b?d+("\u0414\u0430\u0442\u0430 \u043e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u044f: "+(new Date(c.attributes.ACTUAL_DATE)).toLocaleString()+"</br>"):d+("\u0414\u0430\u0442\u0430 \u043e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u044f \u0433\u0440\u0430\u043d\u0438\u0446 \u0443\u0447\u0430\u0441\u0442\u043a\u0430 \u043d\u0430 \u041f\u041a\u041a: "+(new Date(c.attributes.ACTUAL_DATE)).toLocaleString()+"</br>"));null!=c.attributes.CATEGORY_CODE&&(d+="\u041a\u0430\u0442\u0435\u0433\u043e\u0440\u0438\u044f (\u043a\u043e\u0434): "+
c.attributes.CATEGORY_CODE+"</br>");d+="\u0420\u0430\u0437\u0440\u0435\u0448\u0435\u043d\u043d\u043e\u0435 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u043d\u0438\u0435: </br>";null!=c.attributes.UTIL_CODE&&(d+="\u041f\u043e \u043a\u043b\u0430\u0441\u0441\u0438\u0444\u0438\u043a\u0430\u0442\u043e\u0440\u0443 (\u043a\u043e\u0434): "+c.attributes.UTIL_CODE+"</br>");null!=c.attributes.UTIL_BY_DOC&&(d+="\u041f\u043e \u0434\u043e\u043a\u0443\u043c\u0435\u043d\u0442\u0443: "+c.attributes.UTIL_BY_DOC+
"</br>");b&&(d+="</br>",null!=c.attributes.OKS_FLOORS&&(d+="\u042d\u0442\u0430\u0436\u0435\u0439: "+c.attributes.OKS_FLOORS+"</br>"),null!=c.attributes.OKS_U_FLOORS&&(d+="\u041f\u043e\u0434\u0437\u0435\u043c\u043d\u044b\u0445 \u044d\u0442\u0430\u0436\u0435\u0439: "+c.attributes.OKS_U_FLOORS+"</br>"),null!=c.attributes.OKS_YEAR_USED&&(d+="\u0413\u043e\u0434 \u0432\u0432\u043e\u0434\u0430 \u0432 \u044d\u043a\u0441\u043f\u043b\u0443\u0430\u0442\u0430\u0446\u0438\u044e: "+c.attributes.OKS_YEAR_USED+"</br>"),
null!=c.attributes.YEAR_BUILT&&(d+="\u0417\u0430\u0432\u0435\u0440\u0448\u0435\u043d\u0438\u0435 \u0441\u0442\u0440\u043e\u0438\u0442\u0435\u043b\u044c\u0441\u0442\u0432\u0430: "+c.attributes.YEAR_BUILT+"</br>"));$("#rosreestr_info").html(d)}}},eventChangeTab:function(a){$(this.parentdiv).trigger({type:"changetabRosreestr",value:a})}}};if(window.GWTK){var sliderToolsControl_beginning_RU="\u041f\u0435\u0440\u0435\u0439\u0442\u0438 \u043a \u043d\u0430\u0447\u0430\u043b\u0443",sliderToolsControl_rewind_RU="\u041f\u0435\u0440\u0435\u043c\u043e\u0442\u043a\u0430 \u043d\u0430\u0437\u0430\u0434",sliderToolsControl_play_RU="\u0421\u0442\u0430\u0440\u0442 \u0432\u043f\u0435\u0440\u0435\u0434",sliderToolsControl_playback_RU="\u0421\u0442\u0430\u0440\u0442 \u043d\u0430\u0437\u0430\u0434",sliderToolsControl_stop_RU="\u0421\u0442\u043e\u043f",
sliderToolsControl_forward_RU="\u041f\u0435\u0440\u0435\u043c\u043e\u0442\u043a\u0430 \u0432\u043f\u0435\u0440\u0435\u0434",sliderToolsControl_end_RU="\u041f\u0435\u0440\u0435\u0439\u0442\u0438 \u043a \u043a\u043e\u043d\u0446\u0443",sliderToolsControl_pause_RU="\u041f\u0430\u0443\u0437\u0430",sliderToolsControl_wrench_RU="\u041f\u0430\u0440\u0430\u043c\u0435\u0442\u0440\u044b \u043f\u0435\u0440\u0435\u043c\u043e\u0442\u043a\u0438",sliderToolsControl_stepD_RU="\u0428\u0430\u0433 (\u0432 \u043c\u0438\u043b\u043b\u0438\u0441\u0435\u043a\u0443\u043d\u0434\u0430\u0445)",
sliderToolsControl_intervalD_RU="\u0421\u043a\u043e\u0440\u043e\u0441\u0442\u044c (\u0432 \u043c\u0438\u043b\u043b\u0438\u0441\u0435\u043a\u0443\u043d\u0434\u0430\u0445)",sliderToolsControl_unitD_RU=["\u0441\u0443\u0442\u043a\u0438","\u0447\u0430\u0441\u044b","\u043c\u0438\u043d\u0443\u0442\u044b","\u0441\u0435\u043a\u0443\u043d\u0434\u044b","\u043c\u0438\u043b\u043b\u0438\u0441\u0435\u043a\u0443\u043d\u0434\u044b"],sliderToolsControl_save_RU="\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c",
sliderToolsControl_cancel_RU="\u041e\u0442\u043a\u0430\u0437\u0430\u0442\u044c\u0441\u044f",sliderToolsControl_errLenghtD_RU=": \u0434\u043b\u0438\u043d\u0430 \u0434\u043e\u043b\u0436\u043d\u0430 \u0431\u044b\u0442\u044c \u0432 \u0434\u0438\u0430\u043f\u0430\u0437\u043e\u043d\u0435 ",sliderToolsControl_errValueD_RU=": \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u0435 \u0434\u043e\u043b\u0436\u043d\u043e \u0431\u044b\u0442\u044c \u0432 \u0434\u0438\u0430\u043f\u0430\u0437\u043e\u043d\u0435 ",sliderToolsControl_errRegexpD_RU=
": \u0442\u043e\u043b\u044c\u043a\u043e \u0441\u0438\u043c\u0432\u043e\u043b\u044b ";GWTK.sliderToolsControl=function(a,b,c,d){this.param=d;this.tools=$(b);this.slider=$(c);this.dateTimeEnd=this.dateTimeBegin=null;this.Step=36E6;this.mininterval=this.Interval=1E3;this.timerId=0;this.isPlay=!1;null!=this.tools&&(void 0!=this.tools&&null!=this.slider&&void 0!=this.slider)&&(this.parentstr="asdslider_"+a,this.initRes("RU"),this.create(),null!=d&&(void 0!=d&&null!=d.dtbegin&&void 0!=d.dtbegin&&null!=
d.dtend&&void 0!=d.dtend&&null!=d.step&&void 0!=d.step&&null!=d.interval&&void 0!=d.interval)&&this.initSlider(d.dtbegin,d.dtend,d.step,d.interval,d.mininterval));this.dialog};GWTK.sliderToolsControl.prototype={create:function(){var a=' <div id="toolbar_'+this.parentstr+'" class="ui-corner-all"> <button id="beginning_'+this.parentstr+'" style="width:20px; height:20px;">'+this.res_sliderToolsControl_beginning+'</button>  <button id="rewind_'+this.parentstr+'" style="width:20px; height:20px;">'+this.res_sliderToolsControl_rewind+
'</button>  <button id="play_'+this.parentstr+'" style="width:20px; height:20px;">'+this.res_sliderToolsControl_play+'</button> <button id="playback_'+this.parentstr+'" style="width:20px; height:20px;">'+this.res_sliderToolsControl_playback+'</button> <button id="forward_'+this.parentstr+'" style="width:20px; height:20px;">'+this.res_sliderToolsControl_forward+'</button> <button id="end_'+this.parentstr+'" style="width:20px; height:20px;">'+this.res_sliderToolsControl_end+'</button> <button id="wrench_'+
this.parentstr+'" style="width:20px; height:20px;">'+this.res_sliderToolsControl_wrench+"</button></div>";$(this.tools).append(a);$(this.slider).append('<table width="100%" cellpadding="0" cellspacing="0"> <tr> <td   align="left" > <div id="mapMoviesTrack-labelLeft_'+this.parentstr+'" class="mapMoviesTrack-labelLeft"/> </td> <td align="center"> <div id="mapMoviesTrack-labelCenter_'+this.parentstr+'" class="mapMoviesTrack-labelCenter"/> </td> <td align="right" > <div id="mapMoviesTrack-labelRight_'+
this.parentstr+'" class="mapMoviesTrack-labelRight"/> </td> </tr> <tr> <td colspan="3" align="center"> <div id="'+this.parentstr+'" class="mapMoviesTrack-panel"/> </td> </tr> </table>')},initRes:function(a){switch(a){case "RU":this.res_sliderToolsControl_beginning=window.sliderToolsControl_beginning_RU,this.res_sliderToolsControl_rewind=window.sliderToolsControl_rewind_RU,this.res_sliderToolsControl_play=window.sliderToolsControl_play_RU,this.res_sliderToolsControl_playback=window.sliderToolsControl_playback_RU,
this.res_sliderToolsControl_stop=window.sliderToolsControl_stop_RU,this.res_sliderToolsControl_forward=window.sliderToolsControl_forward_RU,this.res_sliderToolsControl_end=window.sliderToolsControl_end_RU,this.res_sliderToolsControl_pause=window.sliderToolsControl_pause_RU,this.res_sliderToolsControl_wrench=window.sliderToolsControl_wrench_RU,this.res_sliderToolsControl_stepD=window.sliderToolsControl_stepD_RU,this.res_sliderToolsControl_intervalD=window.sliderToolsControl_intervalD_RU,this.res_sliderToolsControl_unitD=
window.sliderToolsControl_unitD_RU,this.res_sliderToolsControl_save=window.sliderToolsControl_save_RU,this.res_sliderToolsControl_cancel=window.sliderToolsControl_cancel_RU,this.res_sliderToolsControl_errLenghtD=window.sliderToolsControl_errLenghtD_RU,this.res_sliderToolsControl_errValueD=window.sliderToolsControl_errValueD_RU,this.res_sliderToolsControl_errRegexpD=window.sliderToolsControl_errRegexpD_RU}},destroy:function(){0!=this.timerId&&clearTimeout(this.timerId);$("#dialog-form_"+this.parentstr).remove();
$(this.tools).children().remove();$(this.slider).children().remove()},initSlider:function(a,b,c,d,e){function f(a){x.text(a).addClass("ui-state-highlight");setTimeout(function(){x.removeClass("ui-state-highlight",1500)},500)}function g(a,b,c,d){return a.val().length>c||a.val().length<b?(void 0!=d&&(a.addClass("ui-state-error"),f(d+sliderToolsControl_errLenghtD_RU+b+" - "+c+".")),!1):!0}function m(a,b,c,d){return b!=c&&(parseInt(a.val())>c||parseInt(a.val())<b)?(void 0!=d&&(a.addClass("ui-state-error"),
f(d+sliderToolsControl_errValueD_RU+b+" - "+c+".")),!1):!0}function h(){var a=!0;w.removeClass("ui-state-error");var a=(a=a&&g(c,3,13,sliderToolsControl_stepD_RU))&&g(d,3,13,sliderToolsControl_intervalD_RU),b=y-z;return a=(a=a&&m(c,1,b,sliderToolsControl_stepD_RU))&&m(d,e,36E5,sliderToolsControl_intervalD_RU)}if(!(null==b||void 0==b||null==a||void 0==a)){this.dateTimeBegin=a;this.dateTimeEnd=b;null!=c&&void 0!=c&&(this.Step=c);null!=d&&void 0!=d&&(this.Interval=d);null!=e&&void 0!=e&&(this.mininterval=
e);$("#mapMoviesTrack-labelRight_"+this.parentstr).append(document.createTextNode(this.dateTimeBegin.toLocaleString()));$("#mapMoviesTrack-labelLeft_"+this.parentstr).append(document.createTextNode(this.dateTimeEnd.toLocaleString()));var p=this,q=this.parentstr,r=0,s=0,u=0,r=u=+a,s=+b;$("#"+this.parentstr).slider({min:r,max:s,range:"min",step:this.Step,value:u,slide:function(a,b){p.isPlay?p.updateinfo(b.value,"start"):p.updateinfo(b.value,"random")}});$("#beginning_"+q).button({text:!1,icons:{primary:"ui-icon-seek-start"}});
$("#beginning_"+q).bind("click",{slPane:this},function(a){a.data.slPane.stop();a.data.slPane.begin_end("begin");return!1});$("#rewind_"+q).button({text:!1,icons:{primary:"ui-icon-seek-prev"}});$("#rewind_"+q).bind("click",{slPane:this},function(a){a.data.slPane.stop();a.data.slPane.play(-a.data.slPane.Step,"step_back");return!1});$("#playback_"+q).button({text:!1,icons:{primary:"ui-icon-playback"}});$("#playback_"+q).bind("click",{slPane:this},function(a){if(!(null==a.data.slPane.dateTimeEnd||null==
a.data.slPane.dateTimeBegin)){if($(this).text()===a.data.slPane.res_sliderToolsControl_playback){a.data.slPane.stop();$("#playback_"+q).button("option",{label:a.data.slPane.res_sliderToolsControl_pause,icons:{primary:"ui-icon-pause"}});var b="start";a.data.slPane.timerId=setInterval(function(){a.data.slPane.play(-a.data.slPane.Step,b);b=null},a.data.slPane.Interval)}else a.data.slPane.stopWithUpdate();return!1}});$("#play_"+q).button({text:!1,icons:{primary:"ui-icon-play"}});$("#play_"+q).bind("click",
{slPane:this},function(a){if(null==a.data.slPane.dateTimeEnd||null==a.data.slPane.dateTimeBegin)return!1;if($(this).text()===a.data.slPane.res_sliderToolsControl_play){a.data.slPane.stop();$("#play_"+q).button("option",{label:a.data.slPane.res_sliderToolsControl_pause,icons:{primary:"ui-icon-pause"}});var b="start",c=a.data.slPane;c.timerId=setInterval(function(){c.play(c.Step,b);b=null},c.Interval)}else a.data.slPane.stopWithUpdate();return!1});$("#forward_"+q).button({text:!1,icons:{primary:"ui-icon-seek-next"}});
$("#forward_"+q).bind("click",{slPane:this},function(a){a.data.slPane.stop();a.data.slPane.play(a.data.slPane.Step,"step_forward");return!1});$("#end_"+q).button({text:!1,icons:{primary:"ui-icon-seek-end"}});$("#end_"+q).bind("click",{slPane:this},function(a){a.data.slPane.stop();a.data.slPane.begin_end("end");return!1});$("#wrench_"+q).button({text:!1,icons:{primary:"ui-icon-wrench"}});$("#wrench_"+q).bind("click",{slPane:this},function(a){a.data.slPane.stopWithUpdate();a.data.slPane.opendialog();
return!1});$("body").append('<div id="dialog-form_'+this.parentstr+'" title="'+this.res_sliderToolsControl_wrench+'"><p class="validateTips" style="color:red; font-style:italy; font-size:small;"></p><form><label for="step" style="display:block;">'+this.res_sliderToolsControl_stepD+'</label> <input type="text" style="display:block; text-align:right;" name="step" id="step_'+this.parentstr+'" value="'+p.Step+'" class="text ui-widget-content ui-corner-all"> <label for="interval" style="display:block;">'+
this.res_sliderToolsControl_intervalD+'</label> <input type="text" style="display:block; text-align:right;" name="interval" id="interval_'+this.parentstr+'" value="'+p.Interval+'" class="text ui-widget-content ui-corner-all"> <input type="submit" tabindex="-1" style="position:absolute; top:-1000px"></form></div>');var t;c=$("#step_"+this.parentstr);d=$("#interval_"+this.parentstr);e=this.mininterval;var w=$([]).add(c).add(d),x=$(".validateTips"),y,z;$("#step_"+this.parentstr).mask("999999999999",
{autoclear:!1});$("#step_"+this.parentstr).val(this.Step);$("#interval_"+this.parentstr).mask("999999999999",{autoclear:!1});$("#interval_"+this.parentstr).val(this.Interval);this.dialog=$("#dialog-form_"+this.parentstr).dialog({autoOpen:!1,height:270,width:250,modal:!0,buttons:[{text:this.res_sliderToolsControl_save,width:"80",height:"24",click:function(){ok=!0;h()&&$(this).dialog("close");return!1}},{text:this.res_sliderToolsControl_cancel,width:"80",height:"24",click:function(){ok=!1;$(this).dialog("close");
return!1}}],close:function(){t[0].reset();$(".validateTips").text("");w.removeClass("ui-state-error");return!1}});$("#dialog-form_"+this.parentstr).bind("dialogopen",{slPane:this},function(a,b){z=a.data.slPane.dateTimeBegin;y=a.data.slPane.dateTimeEnd;return!1});$("#dialog-form_"+this.parentstr).bind("dialogclose",{slPane:this},function(a,b){if(!1!=ok){var e=c.val().replace(/_/g,""),f=d.val().replace(/_/g,"");a.data.slPane.Step=parseInt(e);$("#"+a.data.slPane.parentstr).slider("option","step",a.data.slPane.Step);
a.data.slPane.Interval=parseInt(f);a.data.slPane.eventUpdateparam(a.data.slPane.Step,a.data.slPane.Interval);return!1}});$("#end_"+this.parentstr).bind("click",{slPane:this},function(a){a.data.slPane.stop();a.data.slPane.begin_end("end");return!1});t=this.dialog.find("form").on("submit",function(a){a.preventDefault();ok=!0;h()&&$(this).dialog("close");return!1})}},play:function(a,b){if(!(null==this.dateTimeEnd||null==this.dateTimeBegin)){var c=$("#"+this.parentstr).slider("value");if(0<a&&c>=+this.dateTimeEnd||
0>a&&c<=+this.dateTimeBegin)this.stopWithUpdate();else if(c+=parseInt(a),0<a&&c>=+this.dateTimeEnd)this.begin_end("end");else if(0>a&&c<=+this.dateTimeBegin)this.begin_end("begin");else{$("#"+this.parentstr).slider("value",c);if(null==b||void 0==b||"start"==b&&0>a)b="playprocess",0>a&&(b="playprocess_back");"start"==b&&(this.isPlay=!0);this.updateinfo(c,b)}}},begin_end:function(a){if(!(null==this.dateTimeEnd||null==this.dateTimeBegin||null==a)){var b=+this.dateTimeEnd;"begin"==a&&(b=+this.dateTimeBegin);
$("#"+this.parentstr).slider("value",+b);this.stopWithUpdate(a)}},stop:function(){this.isPlay=!1;0!=this.timerId&&(clearTimeout(this.timerId),this.timerId=0);$("#play_"+this.parentstr).button("option",{label:this.res_sliderToolsControl_play,icons:{primary:"ui-icon-play"}});$("#playback_"+this.parentstr).button("option",{label:this.res_sliderToolsControl_playback,icons:{primary:"ui-icon-playback"}})},startPlay:function(){0==this.timerId&&$("#play_"+this.parentstr).click()},stopPlay:function(){0!=this.timerId&&
$("#play_"+this.parentstr).click()},stopWithUpdate:function(a){this.stop();var b=$("#"+this.parentstr).slider("value");if(null==a||void 0==a)a="stop";this.updateinfo(b,a)},updatePanel:function(a,b,c,d,e){null==a||null==a?($("#mapMoviesTrack-labelLeft_"+this.parentstr).text(""),$("#mapMoviesTrack-labelRight_"+this.parentstr).text("")):($("#"+this.parentstr).slider("option","min",+a),$("#mapMoviesTrack-labelLeft_"+this.parentstr).text(a.toLocaleString()),$("#"+this.parentstr).slider("option","max",
+b),$("#mapMoviesTrack-labelRight_"+this.parentstr).text(b.toLocaleString()),$("#"+this.parentstr).slider("option","step",+c),a=new Date(a),null!=e&&void 0!=e&&(a=e),$("#"+this.parentstr).slider("value",+a))},setValueStop:function(a){0!=this.timerId&&(clearTimeout(this.timerId),this.timerId=0);this.setValue(a)},setValue:function(a){a=+a;$("#"+this.parentstr).slider("value",a);$("#mapMoviesTrack-labelCenter_"+this.parentstr).text((new Date(a)).toLocaleString())},getValue:function(){return $("#"+this.parentstr).slider("value")},
opendialog:function(){$("#step_"+this.parentstr).val(this.Step);$("#interval_"+this.parentstr).val(this.Interval);this.dialog.dialog("open")},updateinfo:function(a,b,c){$("#mapMoviesTrack-labelCenter_"+this.parentstr).text((new Date(a)).toLocaleString());this.eventUpdatedata(a,b,c)},getSlider:function(){return $("#"+this.parentstr)},getSliderWidget:function(){return $("#"+this.parentstr).slider("instance")},getButton:function(a){if(null==a||void 0==a)return null;switch(a){case "beginning":return $("#beginning_"+
this.parentstr);case "rewind":return $("#rewind_"+this.parentstr);case "playback":return $("#playback_"+this.parentstr);case "play":return $("#play_"+this.parentstr);case "forward":return $("#forwar_"+this.parentstr);case "end":return $("#end_"+this.parentstr);case "wrench":return $("#wrench_"+this.parentstr);default:return null}},getButtonWidget:function(a){if(null==a||void 0==a)return null;switch(a){case "beginning":return $("#beginning_"+this.parentstr).button("instance");case "rewind":return $("#rewind_"+
this.parentstr).button("instance");case "playback":return $("#playback_"+this.parentstr).button("instance");case "play":return $("#play_"+this.parentstr).button("instance");case "forward":return $("#forward_"+this.parentstr).button("instance");case "end":return $("#end_"+this.parentstr).button("instance");case "wrench":return $("#wrench_"+this.parentstr).button("instance");default:return null}},eventUpdatedata:function(a,b,c){$(this.slider).trigger({type:"updatedatasliderToolsControl",value:a,service:b})},
eventUpdateparam:function(a,b){$(this.slider).trigger({type:"updateparamsliderToolsControl",step:a,interval:b})}}};var timerRouteId=0;
if(window.GWTK){var mapRoutes_button_RU="\u0420\u0435\u0442\u0440\u043e\u0441\u043f\u0435\u043a\u0442\u0438\u0432\u043d\u044b\u0439 \u0430\u043d\u0430\u043b\u0438\u0437 \u0434\u0430\u043d\u043d\u044b\u0445 \u0441 \u0411\u041f\u041b\u0410";GWTK.maproutes=function(a,b){this.map;this.panel;if(null!=a){this.map=a;this.initRes("RU");var c,d=this.map.options.controls.length;for(c=0;c<d;c++)"routebpla"==this.map.options.controls[c]&&(this.map.mapRoutes=this);if(null!=b){this.param=b;this.routes=this.param.routes;
for(d=0;d<this.routes.length;d++)if(this.routes[d].fileshort=GWTK.routeUtil.shortfilename(this.routes[d].file),!(null==this.routes[d].movies||void 0==this.routes[d].movies)){var e=this.routes[d].movies.length;for(c=0;c<e;c++)this.routes[d].movies[c].fileshort=GWTK.routeUtil.shortfilename(this.routes[d].movies[c].file)}}this.maproute=null;this.initialize()}};GWTK.maproutes.prototype={initialize:function(){if(!1==this.map instanceof GWTK.Map)return this;this.initRoutes();this.initEvents();$(document).ready(function(){GWTK.maproutes.prototype._readCookie()});
return this},initRes:function(a){switch(a){case "RU":this.res_mapRoutes_button=window.mapRoutes_button_RU,this.res_close=window.close_RU}},initRoutes:function(){if(!(null==this.map||null==this.map.panes||null==this.map.panes.toolbarPane)){var a=GWTK.DomUtil.create("div","control-button control-button-maproutes clickable",this.map.panes.toolbarPane);a.id="panel_button-mapRoute";a.disabled=!1;a.title=this.res_mapRoutes_button;a._pane="routesPane"}},initEvents:function(){var a=this;$("#panel_button-mapRoute").click(function(b){null==
a.param||void 0==a.param?alert("\u0414\u0430\u043d\u043d\u044b\u0435 \u0434\u043b\u044f \u043e\u0442\u043e\u0431\u0440\u0430\u0436\u0435\u043d\u0438\u044f \u043e\u0442\u0441\u0443\u0442\u0441\u0442\u0432\u0443\u044e\u0442."):($(b.currentTarget).hasClass("control-button-active")?($(b.currentTarget).removeClass("control-button-active"),$(GWTK.maphandlers.map.panes.eventPane).on("click",GWTK.maphandlers.mapclick),a.destroy()):($(b.currentTarget).addClass("control-button-active"),a.init(a.param)),void 0!=
b.cancelable&&GWTK.Map.prototype._writeCookiePanels())})},destroy:function(){null!=this.maproute&&void 0!=this.maproute&&(this.maproute.destroy(),this.maproute=null);null==this.map||null==this.map.mapPane||(null!=this.panel&&(GWTK.routeUtil.removeAllChild(this.panel),this.map.mapPane.removeChild(this.panel)),this.panel=null)},init:function(a){this.panel=this.map.createPane("mapRoutes-panel map-panel-def",this.map.mapPane);this.panel.id="routesPane";$(this.panel).draggable({containment:"parent",distance:2});
$("#routesPane").append('<div class="routesContainer"><div align="left"  class="routeFilesName">'+this.res_mapRoutes_button+'<div><img id="routesHeaderList" class="panel-info-close  ui-widget-content" title="'+this.res_close+'" src="'+GWTK.imgClose+'"> </div></div><table width="100%" > <tr> <td> <div id="routesList" align="left"></div> </td> </tr> </table></div> ');a=this.routes.length;for(var b=0;b<a;b++)$("#routesList").append('<div  align="left" class="clickable" id= "route_'+b+'" Title="\u0412\u044b\u043f\u043e\u043b\u043d\u0438\u0442\u044c" >'+
this.routes[b].alias+" ("+this.routes[b].fileshort+") </div>");var c=this;$(document).ready(function(){$("#routesHeaderList").click(function(a){$("#panel_button-mapRoute").click()});$("#routesList").children(".clickable").click(function(a){c.createroute(this.id)})})},createroute:function(a){if(0==timerRouteId&&!(null==a||void 0==a))if(a=a.split("_"),!(null==a||0==a.length)){a=a[a.length-1];null!=this.maproute&&void 0!=this.maproute&&this.maproute.destroy();this.maproute=new GWTK.routeBPLA(a,this.routes[a],
this.map.mapPane,null,null);$(this.map.mapPane).on("filecompleteBPLA",function(a){0!=timerRouteId&&(clearTimeout(timerRouteId),timerRouteId=0)});var b=this;$(this.map.mapPane).on("overlayRefresh",function(a){b.refresh();return!1});var c=this.maproute;timerRouteId=setTimeout(function(){c.initdataFromfile()},1E3)}},refresh:function(){null!=this.maproute&&void 0!=this.maproute&&this.maproute.refresh()},geo2pixelOffset:function(a){a=GWTK.toLatLng(a);return GWTK.tileView.geo2pixelOffset(GWTK.maphandlers.map,
a)},showCenter:function(a){if(!(null==a||0==a.length)){var b=null;null!=GWTK.maphandlers.map.layers[0].options.tilematrix&&(b=GWTK.maphandlers.map.layers[0].options.tilematrix);GWTK.maphandlers.map.setView(null,a,b)}},initpointscsv:function(a){if(!(null==a||void 0==a)){var b=a.length;if(!(1>=b)){for(var c=[],d=0,e=1;e<b;e++)null==a[e][0]||(null==a[e][1]||null==a[e][11])||(c[d]=[],c[d].B=a[e][0],c[d].L=a[e][1],c[d].H=a[e][2],c[d].ascent_feet=a[e][3],c[d].speed_mph=a[e][4],c[d].distance_feet=a[e][5],
c[d].max_altitude_feet=a[e][6],c[d].max_ascent_feet=a[e][7],c[d].max_speed_mph=a[e][8],c[d].max_distance_feet=a[e][9],c[d].time_millisecond=a[e][10],c[d].datetime_utc=a[e][11],c[d].datetime_local=a[e][12],c[d].satellites=a[e][13],c[d].pressure_Pa=a[e][14],c[d].temperature_F=a[e][15],d++);return c}}},pointTooltip:function(a,b){return"N="+a+", "+b.datetime_utc+",\n\rB="+b.B+", L="+b.L+", \u0432\u044b\u0441\u043e\u0442\u0430(\u043c)="+b.H+",\n\r\u0434\u0430\u0432\u043b\u0435\u043d\u0438\u0435(Pa)="+
b.pressure_Pa+", \u0442\u0435\u043c\u043f\u0435\u0440\u0430\u0442\u0443\u0440\u0430(F)="+b.temperature_F},_readCookie:function(){var a=GWTK.cookie("VisiblePanels",GWTK.cookies.converter);void 0!==a&&$.each(a,function(a,c){var d=c.shift(),e=0<c.length?c.shift():"",e=e.split(",");"panel_button-mapRoute"==d&&(button=$("#"+d),panel=button[0]._pane,"show"==e[0]&&($("#panel_button-mapRoute").click(),GWTK.maphandlers.map.setMapContentPanel()))})}}};if(window.GWTK){GWTK._routesBPLA=[];var close_RU="\u0417\u0430\u043a\u0440\u044b\u0442\u044c",routeBPLA_mess1_RU="\u041e\u0442\u0441\u0443\u0442\u0441\u0442\u0432\u0443\u044e\u0442 \u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440\u044b \u0434\u043b\u044f \u043e\u0442\u043e\u0431\u0440\u0430\u0436\u0435\u043d\u0438\u044f",routeBPLA_mess2_RU="\u041e\u0442\u0441\u0443\u0442\u0441\u0442\u0432\u0443\u0435\u0442 \u0444\u0443\u043d\u043a\u0446\u0438\u044f \u043f\u0435\u0440\u0435\u0441\u0447\u0435\u0442\u0430 \u043a\u043e\u043e\u0440\u0434\u0438\u043d\u0430\u0442",
routeBPLA_showvideo_RU="\u041f\u043e\u043a\u0430\u0437\u0430\u0442\u044c \u0432\u0438\u0434\u0435\u043e\u0437\u0430\u043f\u0438\u0441\u044c",routeBPLA_checkpoint_RU="\u041e\u0442\u043c\u0435\u0442\u0438\u0442\u044c \u0432\u0441\u0435 \u0442\u043e\u0447\u043a\u0438 \u0442\u0440\u0435\u043a\u0430",routeBPLA_timestampNo_RU="\u041d\u0435\u0432\u043e\u0437\u043c\u043e\u0436\u043d\u043e \u043f\u0440\u043e\u0434\u043e\u043b\u0436\u0438\u0442\u044c \u0440\u0430\u0431\u043e\u0442\u0443 \u0438\u0437-\u0437\u0430 \u043e\u0442\u0441\u0443\u0442\u0441\u0442\u0432\u0438\u044f \u0432\u0440\u0435\u043c\u0435\u043d\u043d\u044b\u0445 \u043c\u0435\u0442\u043e\u043a",
routeBPLA_VideoSpeedSlowly_RU="\u043c\u0435\u0434\u043b\u0435\u043d\u043d\u043e",routeBPLA_VideoSpeedNormal_RU="\u043d\u043e\u0440\u043c\u0430\u043b\u044c\u043d\u043e",routeBPLA_VideoSpeedQuickly_RU="\u0431\u044b\u0441\u0442\u0440\u043e";GWTK.routeBPLA=function(a,b,c,d,e){this.geo2pixelOffset=this.overlayPane=this.panelVideo=this.panel=this.param=null;this.id=a;this.parentstr="BPLAroute_"+a;null!=c&&void 0!=c&&(this.mapdiv=c);null!=d&&void 0!=d&&(this.sliderdiv=d);null!=e&&void 0!=e&&(this.videodiv=
e);this.fileshort=this.file=this.alias=null;this.videospeed=this.checkpoint=0;this.points=[];this.movies=[];this.pointsObj=[];this.lineObj;this.centerObj=[];this.imgpoint="/images/prick.png";this.imgpointEmpty="/images/prickEmpty.png";this.imgpointCurrent="/images/prickBig.png";this.imgpointSelect="/images/prickBig_select.png";this.currentpoint=0;this.currentmark;this.selectpoint=-1;this.selecttmark;this.dateTimeEnd=this.dateTimeBegin=null;this.Interval=this.Step=250;this.video=null;this.videocurrentTime=
0;this.currentmovies=-1;this.videoIsPlay=this.videoVisible=!1;this.videoTimebegin=0;this.videoEventOutside=!1;this.sliderRoute=null;this.cssLine_msie="route-line-msie";this.cssLine="route-line";this.initRes("RU");null!=b&&void 0!=b&&(this.param=b);this.geo2pixelOffset=null!=b.fn_geo2pixelOffset&&void 0!=b.fn_geo2pixelOffset?b.fn_geo2pixelOffset:function(a){a=GWTK.toLatLng(a);return GWTK.tileView.geo2pixelOffset(GWTK.maphandlers.map,a)};null!=b.fn_pointTooltip&&void 0!=b.fn_pointTooltip&&(this.pointTooltip=
b.fn_pointTooltip);null!=b.fn_initpointscsv&&void 0!=b.fn_initpointscsv&&(this.initpointscsv=b.fn_initpointscsv);null!=b.fn_showCenter&&void 0!=b.fn_showCenter&&(this.showCenter=b.fn_showCenter);this.initialize()};GWTK.routeBPLA.prototype={initialize:function(){if(null==this.param||void 0==this.param||null==this.param.file||void 0==this.param.file)alert(this.routeBPLA_mess1);else if(null==this.geo2pixelOffset||void 0==this.geo2pixelOffset)alert(this.routeBPLA_mess2);else{this.clear();var a=this.param;
null!=a.alias&&(this.alias=a.alias);null!=a.imgpoint&&(this.imgpoint=a.imgpoint);null!=a.imgpointCurrent&&(this.imgpointCurrent=a.imgpointCurrent);null!=a.imgpointSelect&&(this.imgpointSelect=a.imgpointSelect);null!=a.imgpointEmpty&&(this.imgpointEmpty=a.imgpointEmpty);null!=a.checkpoint&&(this.checkpoint=parseInt(a.checkpoint));null!=a.videovisible&&(this.videoVisible=parseInt(a.videovisible));null!=a.videospeed&&(this.videospeed=parseInt(a.videospeed));this.currentmovies=null!=a.currmovi&&0<a.currmovi?
parseInt(a.currmovi-1):0;this.file=a.file;this.fileshort=GWTK.routeUtil.shortfilename(this.file);if(null!=a.movies&&0<a.movies.length){for(var b=a.movies.length,c=0;c<b;c++)this.movies[c]=[],this.movies[c].file=a.movies[c].file,this.movies[c].timebegin=parseInt(a.movies[c].timebegin),this.movies[c].fileshort=GWTK.routeUtil.shortfilename(this.movies[c].file);this.currentmovies>this.movies.length-1&&(this.currentmovies=this.movies.length-1);this.videoTimebegin=this.movies[this.currentmovies].timebegin/
1E3}else this.currentmovies=-1;GWTK._routesBPLA.push(this)}},initRes:function(a){switch(a){case "RU":this.res_close=window.close_RU,this.routeBPLA_mess1=window.routeBPLA_mess1_RU,this.routeBPLA_mess2=window.routeBPLA_mess2_RU,this.routeBPLA_showvideo=window.routeBPLA_showvideo_RU,this.routeBPLA_checkpoint=window.routeBPLA_checkpoint_RU,this.routeBPLA_timestampNo=window.routeBPLA_timestampNo_RU,this.routeBPLA_VideoSpeedSlowly=window.routeBPLA_VideoSpeedSlowly_RU,this.routeBPLA_VideoSpeedNormal=window.routeBPLA_VideoSpeedNormal_RU,
this.routeBPLA_VideoSpeedQuickly=window.routeBPLA_VideoSpeedQuickly_RU}},clear:function(){this.fileshort=this.file=this.alias=null;null!=this.points&&(this.points.splice(0,this.points.length),this.centerObj=null);null!=this.movies&&this.movies.splice(0,this.movies.length);this.clearPaint()},clearPaint:function(){this.clearPaintPoint();this.clearPaintLine()},clearMark:function(a){null!=a&&this.routePane.removeChild(a.geopoint());return null},clearPaintPoint:function(){if(!(null==this.routePane||null==
this.pointsObj)){for(var a=0;a<this.pointsObj.length;a++)this.clearMark(this.pointsObj[a]);this.pointsObj.splice(0,this.pointsObj.length);this.currentmark=this.clearMark(this.currentmark);this.selectmark=this.clearMark(this.selectmark)}},clearPaintLine:function(){var a=$("."+this.cssLine_msie);0!=a.length?$(this.routePane).children().remove("."+this.cssLine_msie):(a=$("."+this.cssLine),0!=a.length&&$(this.routePane).children().remove("."+this.cssLine))},initdataFromfile:function(a,b,c,d){this.file_get_contents(this.file,
a,b,c,d)},initdataFromdata:function(a,b,c,d,e){null==a||(void 0==a||0==a.length)||(this.points.splice(0,this.points.length),this.points=a,this.createObject(),this.restoreparam(b,c,d,e),this.savedata())},restoreparam:function(a,b,c,d){this.currentpoint=null==a||void 0==a||0>=a?0:parseInt(a)-1;this.currentmovies=null==d||void 0==d||0>=d?0:d-1;var e;null!=b&&(void 0!=b&&"true"==b)&&(this.videoVisible=!0,this.showVideo(this.videoVisible),null!=c&&(void 0!=c&&"true"==c)&&(e="start"));if(null!=this.points&&
0!=this.points.length&&null!=this.points[this.currentpoint]){this.sliderRoute.setValue(this.points[this.currentpoint].realtime);this.currentmark=this.paintpoint(this.currentpoint,"current");try{this.videoVisible&&(this.videoTimebegin=this.movies[this.currentmovies].timebegin/1E3,this.videocurrentTime=this.points[this.currentpoint].time_millisecond/1E3-this.videoTimebegin,null!=this.video&&void 0!=this.video&&(this.video.currentTime=this.videocurrentTime)),"start"==e&&($("#play").click(),this.videoplay())}catch(f){}finally{}}},
savedata:function(){if(null!=this.points){for(var a="",b=0;b<this.points.length;b++)a+=this.points[b].B+"|"+this.points[b].L+"|"+this.points[b].H+"|"+this.points[b].ascent_feet+"|"+this.points[b].speed_mph+"|"+this.points[b].distance_feet+"|"+this.points[b].max_altitude_feet+"|"+this.points[b].max_ascent_feet+"|"+this.points[b].max_speed_mph+"|"+this.points[b].max_distance_feet+"|"+this.points[b].time_millisecond+"|"+this.points[b].datetime_utc+"|"+this.points[b].datetime_local+"|"+this.points[b].satellites+
"|"+this.points[b].pressure_Pa+"|"+this.points[b].temperature_F+"|"+this.points[b].realtime+"#";localStorage.setItem("createBPLA_routepoints",a)}},pointsdata:function(){return this.points},getdata:function(){var a=localStorage.createBPLA_routepoints;if(null==a||void 0==a)return!1;a=a.split("#");if(null==a||0>=a.length)return!1;for(var b=[],c=0,d=0;d<a.length;d++)if(!(null==a[d]||void 0==a[d]||""==a[d])){var e=a[d].split("|");null==e||0>=e.length||(b[c]=[],b[c].B=parseFloat(e[0]),b[c].L=parseFloat(e[1]),
b[c].H=parseInt(e[2]),b[c].ascent_feet=e[3],b[c].speed_mph=e[4],b[c].distance_feet=e[5],b[c].max_altitude_feet=e[6],b[c].max_ascent_feet=e[7],b[c].max_speed_mph=e[8],b[c].max_distance_feet=e[9],b[c].time_millisecond=parseFloat(e[10]),b[c].datetime_utc=e[11],b[c].datetime_local=e[12],b[c].satellites=e[13],b[c].pressure_Pa=e[14],b[c].temperature_F=e[15],b[c].realtime=parseFloat(e[16]),c++)}return b},file_get_contents:function(a,b,c,d,e){if(!(null==a||void 0==a)){var f=a.toLowerCase().split(".");null==
f||0>=f.length||("kml"==f[f.length-1]?this.readFile(a,"kml",b,c,d):"csv"==f[f.length-1]&&this.readFile(a,"csv",b,c,d,e))}},readFile:function(a,b,c,d,e,f){if(null!=a){$.support.cors=!0;var g=this;try{$.ajax({url:a,dataType:"text",crossDomain:!0,complete:function(a){},success:function(a){null==g||void 0==g||("kml"==b?g.loadXml(a):g.loadCsv(a,","),g.eventFileComplete(),g.createObject(),g.restoreparam(c,d,e,f),g.savedata())},error:function(b,c,d){g.eventFileLoadError(a,c,d);alert("\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u0437\u0430\u0433\u0440\u0443\u0437\u043a\u0435 : "+
a+": "+d+".\n\u041f\u0440\u043e\u0432\u0435\u0440\u044c\u0442\u0435 \u043d\u0430\u0441\u0442\u0440\u043e\u0439\u043a\u0438 \u0441\u0435\u0440\u0432\u0435\u0440\u0430 \u043d\u0430 \u043d\u0430\u043b\u0438\u0447\u0438\u0435 \u0440\u0430\u0437\u0440\u0435\u0448\u0435\u043d\u0438\u0439,\n\u0434\u043b\u044f IIS \u0432\u043a\u043b\u044e\u0447\u0438\u0442\u0435 \u043e\u043f\u0446\u0438\u044e '\u043f\u0440\u043e\u0441\u043c\u043e\u0442\u0440 \u043a\u0430\u0442\u0430\u043b\u043e\u0433\u0430', \n\u043d\u0430\u0441\u0442\u0440\u043e\u0439\u0442\u0435 \u0442\u0438\u043f MIME \u0434\u043b\u044f \u0444\u0430\u0439\u043b\u043e\u0432 kml \u0438 csv, \n\u043d\u0430\u0441\u0442\u0440\u043e\u0439\u0442\u0435 \u0437\u0430\u0433\u043e\u043b\u043e\u0432\u043a\u0438 \u043e\u0442\u0432\u0435\u0442\u043e\u0432 HTTP")}})}catch(m){}}},
createObject:function(){0==this.points.length?alert(this.routeBPLA_timestampNo):(this.dateTimeBegin=new Date(this.points[0].realtime),this.dateTimeEnd=new Date(this.points[this.points.length-1].realtime),this.Step=this.points[1].time_millisecond,this.createPanelRoutes(),this.paintobject())},loadXml:function(a){if(null!=a&&(a=$.parseXML(a),a=$(a).find("Placemark"),null!=a)){var b=a.length;if(0!=b){for(var c,d,e,f,g=0,m=lon=0,h=0;h<b;h++)if(!(null==a[h]||null==a[h].childNodes))if(c=a[h].childNodes.length,
e=f=!1,0!=c){for(var p=0;p<c;p++){if("timestamp"==a[h].childNodes[p].nodeName.toLowerCase()){if(null==a[h].childNodes[p].childNodes)continue;d=a[h].childNodes[p].childNodes.length;if(0==d)continue;for(var q=0;q<d;q++)"when"==a[h].childNodes[p].childNodes[q].nodeName.toLowerCase()&&(null==this.points[g]&&(this.points[g]=[]),this.points[g].datetime_utc=void 0==a[h].childNodes[p].childNodes[q].textContent?a[h].childNodes[p].childNodes[q].text:a[h].childNodes[p].childNodes[q].textContent,this.points[g].realtime=
GWTK.routeUtil.getdate_millisecond(this.points[g].datetime_utc),this.points[g].time_millisecond=0==g?0:this.points[g-1].time_millisecond+(this.points[g].realtime-this.points[g-1].realtime),e=!0)}if("point"==a[h].childNodes[p].nodeName.toLowerCase()&&(d=a[h].childNodes[p].childNodes.length,0!=d))for(q=0;q<d;q++)if("coordinates"==a[h].childNodes[p].childNodes[q].nodeName.toLowerCase()){null==this.points[g]&&(this.points[g]=[]);var r;r=void 0==a[h].childNodes[p].childNodes[q].textContent?a[h].childNodes[p].childNodes[q].text:
a[h].childNodes[p].childNodes[q].textContent;null!=r&&""!=r&&(r=r.split(","),null==r||3>r.length||(this.points[g].L=r[0],this.points[g].B=r[1],this.points[g].H=r[2],f=!0))}}e&&f&&(m+=parseFloat(this.points[g].B),lon+=parseFloat(this.points[g].L),g++)}0!=g&&(this.centerObj=[m/g,lon/g],this.correctTime_millisecond(this.points))}}},correctTime_millisecond:function(a){if(!(null==a||void 0==a||0==a.length))for(var b=a.length,c=ne=te=0,d=1;d<b;d++)if(a[d-1].time_millisecond==a[d].time_millisecond)ne++;
else if(c!=ne){ne++;for(var e=Math.ceil((a[ne].time_millisecond-a[c].time_millisecond)/(ne-c)),f=1,c=c+1;c<ne;c++)a[c].time_millisecond+=e*f,a[c].realtime+=e*f,f++;c=ne=d}},loadCsv:function(a,b){var c=GWTK.routeUtil.loadCsv(a,b);if(!(null==this.initpointscsv||void 0==this.initpointscsv))if(this.points=this.initpointscsv(c),null==this.points||void 0==this.points)this.points=[];else{for(var c=this.points.length,d=lon=0,e=0;e<c;e++)d+=parseFloat(this.points[e].B),lon+=parseFloat(this.points[e].L),this.points[e].realtime=
GWTK.routeUtil.getdate_millisecond(this.points[e].datetime_utc);this.centerObj=[d/c,lon/c]}},paintobject:function(a){if(!(null==this.points||0==this.points.length))if(null==this.routePane&&null!=this.overlayPane&&(this.routePane=GWTK.DomUtil.create("div","route-panel",this.overlayPane),this.routePane.id="paintroutePane",this.overlayPane.appendChild(this.routePane)),!(null==this.routePane||void 0==this.routePane)){null!=this.showCenter&&(void 0!=this.showCenter&&(null==a||void 0==a))&&this.showCenter(this.centerObj);
for(var b=[],c=this.points.length,d=0;d<c;d++){var e="routepoint_"+d.toString();b[0]=this.points[d].B;b[1]=this.points[d].L;var f=this.geo2pixelOffset(b),g;g=0==this.checkpoint?new GWTK.placemarkEx(e,b,"","",this.imgpointEmpty,GWTK.point(40,50),GWTK.point(-20,-50),this.imgpointCurrent):new GWTK.placemarkEx(e,b,"","",this.imgpoint,GWTK.point(40,50),GWTK.point(-20,-50),this.imgpointCurrent);g.position(f);g.id=e;if(null==a||void 0==a)e=null,0<this.pointsObj.length&&(e=this.pointsObj[this.pointsObj.length-
1]),e&&GWTK.routeUtil.drawLineWithIdToDivEx(e.realpoint,g.realpoint,"line"+this.pointsObj.length,this.routePane,GWTK.point(0,0),this.cssLine,this.cssLine_msie);g.geopoint().title=this.pointTooltip(d+1,this.points[d]);this.routePane.appendChild(g.geopoint());var m=this;g.imgpoint().onmousedown=function(a){if(!(null==m||void 0==m))if(!(null==m.sliderRoute||void 0==m.sliderRoute))if(a=this.getid(),!(null==a||void 0==a)){a=parseInt(a);if(null!=m.video&&null!=m.videoDuration){var b=m.points[a].time_millisecond/
1E3-m.videoTimebegin;b>m.videoDuration&&(b=m.videoDuration);m.video.currentTime=b}m.selectmark=m.paintpoint(a,"select");null!=m.sliderRoute&&void 0!=m.sliderRoute&&(m.sliderRoute.setValue(m.points[a].realtime),m.selectpoint=a)}};this.pointsObj.push(g)}}},refresh:function(){if(null!=this.routePane&&(this.routePane.style.left="0px",this.routePane.style.top="0px",0!=this.pointsObj.length)){var a;null!=this.currentmark&&(a=this.currentmark.latlong,a=this.geo2pixelOffset(a),this.currentmark.position(a));
null!=this.selectmark&&(a=this.selectmark.latlong,a=this.geo2pixelOffset(a),this.selectmark.position(a));for(var b in this.pointsObj)a=this.pointsObj[b].latlong,a=this.geo2pixelOffset(a),this.pointsObj[b].position(a);this.clearPaintLine();for(b=0;b<this.pointsObj.length-1;b++)GWTK.routeUtil.drawLineWithIdToDivEx(this.pointsObj[b].realpoint,this.pointsObj[b+1].realpoint,"line"+(b+1).toString(),this.routePane,GWTK.point(0,0),this.cssLine,this.cssLine_msie)}},destroy:function(){(null!=this.sliderRoute||
void 0!=this.sliderRoute)&&this.sliderRoute.destroy();this.clear();if(!(null==this.mapdiv||void 0==this.mapdiv)){null!=this.overlayPane&&(GWTK.routeUtil.removeAllChild(this.overlayPane),this.mapdiv.removeChild(this.overlayPane),this.overlayPane=null);null!=this.panelVideo&&(GWTK.routeUtil.removeAllChild(this.panelVideo),null==this.videodiv||void 0==this.videodiv?this.mapdiv.removeChild(this.panelVideo):$(this.videodiv).children().remove(),this.panelVideo=null);null!=this.panel&&(GWTK.routeUtil.removeAllChild(this.panel),
null==this.sliderdiv||void 0==this.sliderdiv?this.mapdiv.removeChild(this.panel):$(this.sliderdiv).children().remove(),this.panel=null);for(var a=GWTK._routesBPLA.length,b=-1,c=0;c<a;c++)if(this.id==GWTK._routesBPLA[c]){b=c;break}0<=b&&GWTK._routesBPLA.splice(b,1)}},createPanelRoutes:function(){if(!(null==this.mapdiv||void 0==this.mapdiv)){null==this.sliderdiv||void 0==this.sliderdiv?(this.panel=GWTK.DomUtil.create("div","routeBPLA-panel map-panel-def",this.mapdiv),$(this.panel).draggable({containment:"parent",
distance:2})):this.panel=GWTK.DomUtil.create("div","routeBPLA-panel_child map-panel-def",this.sliderdiv);this.panel.id="routePane_"+this.id;null==this.videodiv||void 0==this.videodiv?(this.panelVideo=GWTK.DomUtil.create("div","routeBPLA-panelVideo map-panel-def",this.mapdiv),$(this.panelVideo).draggable({containment:"parent",distance:2})):this.panelVideo=GWTK.DomUtil.create("div","routeBPLA-panelVideo_child map-panel-def",this.videodiv);this.panelVideo.id="routeBPLA-panelVideo_"+this.id;this.overlayPane=
GWTK.DomUtil.create("div","overlay-panel map-panel-def",this.mapdiv);this.overlayPane.id="routeBPLA-overlayPane_"+this.id;var a='<input type="checkbox" id="routeCheckVisible_'+this.id+'"';1==this.checkpoint&&(a+=' checked="checked" ');var a=a+('><label for="routeCheckVisible_'+this.id+'" class="checkFontSize"> '+this.routeBPLA_checkpoint+"</label>"),b='<div id="routeVideoSpeed_'+this.id+'" class="checkFontSize" style="margin-top:-10px;">\u0421\u043a\u043e\u0440\u043e\u0441\u0442\u044c \u0432\u043e\u0441\u043f\u0440\u043e\u0438\u0437\u0432\u0435\u0434\u0435\u043d\u0438\u044f \u0432\u0438\u0434\u0435\u043e <input type="radio" id="slowly_'+
this.id+'" value="0" name="speedBPLA_'+this.id+'"';0==this.videospeed&&(b+=' checked="checked" ');b+='><label for="slowly_'+this.id+'" class="checkColor"> '+this.routeBPLA_VideoSpeedSlowly+' </label><input type="radio" id="normal_'+this.id+'" value="1" name="speedBPLA_'+this.id+'"';1==this.videospeed&&(b+=' checked="checked" ');b+='><label for="normal_'+this.id+'" class="checkColor"> '+this.routeBPLA_VideoSpeedNormal+' </label><input type="radio" id="quickly_'+this.id+'" value="2" name="speedBPLA_'+
this.id+'"';2==this.videospeed&&(b+=' checked="checked" ');b+='><label for="quickly_'+this.id+'" class="checkColor"> '+this.routeBPLA_VideoSpeedQuickly+" </label></div>";$("#routePane_"+this.id).append('<div class="routeContainer"> </div>');if(null==this.sliderdiv||void 0==this.sliderdiv)$(".routeContainer").append('<div id="routefileFileName_'+this.id+'" class="routeFilesName" align="left">'+this.fileshort+"</div> "),$("#routefileFileName_"+this.id).append('<img class="panel-info-close" title="'+
this.res_close+'" src="'+GWTK.imgClose+'" >');$(".routeContainer").append('<table width="100%"> <tr> <td> <div class="sliderContainer"><table width="100%"> <tr> <td align="left"> <div id="showVideoContainer_'+this.id+'" class="control-button control-button_route_showvideo clickable" Title="'+this.routeBPLA_showvideo+'"> </div> </td> <td align="left"> <div id="routeToolTips_'+this.id+'" class="routeToolTips-panel" > </div></td> <td  align="right"> '+a+'</td> </tr> </table> </div> </td> </tr> <tr> <td> <div id="sliderRoutePane_'+
this.id+'" class="sliderRoutePane"> </div> </td> </tr> <tr><td colspan="3" align="left"> '+b+"</td> </tr> </table> ");$("#routeBPLA-panelVideo_"+this.id).append('<div id="videoContainer_'+this.id+'" class="videoContainer" align="center"> ');-1!=this.currentmovies?($("#showVideoContainer_"+this.id).css("display",""),$("#videoContainer_"+this.id).append('<div> <div id="routevideoFileName_'+this.id+'" class="routeFilesName" align="left">'+this.movies[0].fileshort+"</div></div>"),(null==this.videodiv||
void 0==this.videodiv)&&$("#routevideoFileName_"+this.id).append('<img class="panel-info-close" title="'+this.res_close+'" src="'+GWTK.imgClose+'" >'),$("#videoContainer_"+this.id).append('<video id="HtmlVideoPlayer_'+this.id+'" class="routeVideo" controls preload "> <source id="routesourceVideo_mp4_'+this.id+'" src="'+this.movies[this.currentmovies].file+'" type="video/mp4" codecs="avc1.42E01E, mp4a.40.2"><source id="routesourceVideo_webm_'+this.id+'" src="'+this.movies[this.currentmovies].file+
'" type="video/webm" codecs="vp8, vorbis"><source id="routesourceVideo_ogg_'+this.id+'" src="'+this.movies[this.currentmovies].file+'"  type="video/ogg" codecs="theora, vorbis" ></video> ')):($("#showVideoContainer_"+this.id).css("display","none"),null!=this.videodiv&&void 0!=this.videodiv&&$(this.videodiv).css("display","none"));a=[];a.dtbegin=this.dateTimeBegin;a.dtend=this.dateTimeEnd;a.step=this.Step;a.interval=this.Interval;a.mininterval=this.Interval;this.sliderRoute=new GWTK.sliderToolsControl("route",
$("#routeToolTips_"+this.id)[0],$("#sliderRoutePane_"+this.id)[0],a);var c=this;$("#sliderRoutePane_"+this.id).on("updatedatasliderToolsControl",function(a){c.selectpoint=-1;c.paintdataPoint(a.value,a.service);c.eventUpdatedata(c.points[c.currentpoint],c.currentpoint+1);return!1});$("#sliderRoutePane_"+this.id).on("updateparamsliderToolsControl",function(a){c.Step=a.step;c.Interval=a.interval;c.eventUpdateparam(a.step,a.interval);return!1});$(document).ready(function(){$("#routefileFileName_"+c.id).children(".panel-info-close").click(function(a){c.destroy();
return!1});$("#routevideoFileName_"+c.id).children(".panel-info-close").click(function(a){c.showVideo(!1);return!1});$("#routeCheckVisible_"+c.id).change(function(a){c.updateImagepoint()});$("input[type=radio][name=speedBPLA_"+c.id+"]").change(function(a){c.setSpeed(this.value)});$("#loadkmlFile_"+c.id).change(function(a){a=a.target;c.file=a;var b=new FileReader;b.onload=function(){c.clear();c.loadXml(b.result);0<c.points.length&&(c.dateTimeBegin=new Date(c.points[0].realtime),c.dateTimeEnd=new Date(c.points[c.points.length-
1].realtime),c.Step=c.points[1].time_millisecond,c.updateroutedata(),c.videoTimebegin=0,c.paintobject())};b.readAsText(a.files[0])});$("#showVideoContainer_"+c.id).click(function(){null==c||void 0==c||(c.videoVisible?c.showVideo(!1):c.showVideo(!0))});var a=document.getElementById("HtmlVideoPlayer_"+c.id);if(null!=a&&a.canPlayType){try{a.playbackRate=0.5,c.video=a}catch(b){c.video=null;alert("\u041a\u043e\u043c\u043f\u043e\u043d\u0435\u043d\u0442 video \u0440\u0430\u0431\u043e\u0442\u0430\u0435\u0442 \u043d\u0435\u043a\u043e\u0440\u0440\u0435\u043a\u0442\u043d\u043e, \u043f\u0440\u043e\u0432\u0435\u0440\u044c\u0442\u0435 \u043d\u0430\u0441\u0442\u0440\u043e\u0439\u043a\u0438 \u0431\u0440\u0430\u0443\u0437\u0435\u0440\u0430.");
return}c.setSpeed(c.videospeed.toString());a.addEventListener("canplay",function(){c.videocurrentTime=0;c.videoTimebegin=c.movies[c.currentmovies].timebegin/1E3;c.videoDuration=this.duration.toFixed(1)},!1);a.addEventListener("playing",function(){c.videoIsPlay=!0;!1==c.videoEventOutside&&c.sliderRoute.startPlay();c.videoEventOutside=!1;c.eventVideoisplay(c.videoIsPlay)},!1);a.addEventListener("pause",function(){c.videoIsPlay=!1;!1==c.videoEventOutside&&c.sliderRoute.stopPlay();c.videoEventOutside=
!1;c.eventVideoisplay(c.videoIsPlay)},!1);a.addEventListener("timeupdate",function(){c.videoIsPlay&&c.sliderRoute.setValue(+c.dateTimeBegin+1E3*this.currentTime+c.movies[c.currentmovies].timebegin)},!1)}else $("#showVideoContainer_"+c.id).css("display","none");c.showVideo(c.videoVisible)});null==this.sliderdiv&&null==this.videodiv&&$(this.panel).draggable({cancel:"div.routeContainer"})}},setSpeed:function(a){if(null!=this.video&&this.video.canPlayType)try{switch(a){default:case "0":this.video.playbackRate=
0.5;break;case "1":this.video.playbackRate=1;break;case "2":this.video.playbackRate=2}this.videospeed=parseInt(a);this.eventVideoSpeed(this.videospeed)}catch(b){}finally{}},updateImagepoint:function(){$("#routeCheckVisible_"+this.id).prop("checked")?this.checkpoint=1:this.checkpoint=0;this.clearPaintPoint();this.paintobject(!0);this.currentmark=this.paintpoint(this.currentpoint,"current");0<=this.selectpoint&&(this.selectmark=this.paintpoint(this.selectpoint,"select"));this.eventCheckpoint(this.checkpoint)},
showVideo:function(a){a&&null!=this.video&&void 0!=this.video?(null!=this.videodiv&&void 0!=this.videodiv&&$(this.videodiv).show(),$("#routeBPLA-panelVideo_"+this.id).show(),$("#routeVideoSpeed_"+this.id).show(),this.videoVisible=!0):($("#routeBPLA-panelVideo_"+this.id).hide(),$("#routeVideoSpeed_"+this.id).hide(),this.videoVisible=!1,null!=this.videodiv&&void 0!=this.videodiv&&$(this.videodiv).hide(),this.videoIsPlay&&this.videopause());this.eventVideovisible(this.videoVisible)},paintdataPoint:function(a,
b){if(!(null==a||void 0==a))if(!(null==this.points||void 0==this.points||0==this.points.length)){var c=this.findpoint(a,b);if(-1!=c&&(this.currentmark=this.paintpoint(c,"current"),c=this.points[c].time_millisecond/1E3,this.videoVisible&&null!=this.video&&null!=this.videoDuration)){var d=!1;c<this.videoTimebegin?(this.videocurrentTime=c-this.videoTimebegin,this.video.currentTime=this.videocurrentTime,this.videopause()):c>this.videoTimebegin+this.videoDuration?(this.videocurrentTime=this.videoDuration,
this.video.currentTime=this.videocurrentTime):(d=!0,!this.videoIsPlay&&"playprocess"==b&&(b="start"));switch(b){case "start":this.videocurrentTime=c-this.videoTimebegin;d&&this.videoplay();this.video.currentTime=this.videocurrentTime;break;case "stop":this.videocurrentTime=c-this.videoTimebegin;this.video.currentTime=this.videocurrentTime;this.videopause();break;case "begin":case "end":case "step_forward":case "step_back":case "playprocess_back":this.videocurrentTime=c-this.videoTimebegin;this.video.currentTime=
this.videocurrentTime;this.videopause();break;case "random":this.videopause(),this.videocurrentTime=c-this.videoTimebegin,this.video.currentTime=this.videocurrentTime}}}},findpoint:function(a,b){var c=this.points.length;if(0==c)return-1;switch(b){case "begin":return 0;case "end":return c-1}var d=this.points[this.currentpoint].realtime;if(d==a)return this.currentpoint;if(d<a)for(d=this.currentpoint+1;d<c;d++){if(a<this.points[d].realtime)return this.currentpoint=d-1}else for(d=this.currentpoint;0<=
d;d--)if(a>this.points[d].realtime)return this.currentpoint=d},paintpoint:function(a,b){this.currentmark=this.clearMark(this.currentmark);this.selectmark=this.clearMark(this.selectmark);var c=this.currentmark,d=this.imgpointCurrent,e=GWTK.point(40,50),f=GWTK.point(-20,-50);switch(b){case "current":c=this.currentmark;d=this.imgpointCurrent;break;case "select":c=this.selectmark,d=this.imgpointSelect}this.clearMark(c);if(!(null==a||void 0==a||0>a)){var c="routepoint_"+b+a.toString()+"_"+this.id,g=[];
g[0]=this.points[a].B;g[1]=this.points[a].L;var m=this.geo2pixelOffset(g),c=new GWTK.placemarkEx(c,g,"","",d,e,f);c.position(m);c.geopoint().title=this.pointTooltip(a+1,this.points[a]);this.routePane.appendChild(c.geopoint());return c}},pointTooltip:function(a,b){return a+", "+b.datetime_utc},videoplay:function(){null!=this.video&&void 0!=this.video&&(this.videoEventOutside=!0,this.video.play())},videopause:function(){null!=this.video&&void 0!=this.video&&(this.videoEventOutside=!0,this.video.pause())},
eventFileComplete:function(){$(this.mapdiv).trigger({type:"filecompleteBPLA"})},eventFileLoadError:function(a,b,c){$(this.mapdiv).trigger({type:"fileerrorBPLA",url:a,textStatus:b,error:c})},eventUpdatedata:function(a,b){$(this.mapdiv).trigger({type:"updatedatarouteBPLA",point:a,pointnumber:b})},eventUpdateparam:function(a,b){$(this.mapdiv).trigger({type:"updateparamBPLA",step:a,interval:b})},eventVideovisible:function(a){$(this.mapdiv).trigger({type:"videovisibleBPLA",value:a})},eventVideoisplay:function(a){$(this.mapdiv).trigger({type:"videoplayBPLA",
value:a})},eventCheckpoint:function(a){$(this.mapdiv).trigger({type:"checkpointBPLA",value:a})},eventVideoSpeed:function(a){$(this.mapdiv).trigger({type:"videospeedBPLA",value:a})}};GWTK.routeUtil={removeAllChild:function(a){if(null!=a)for(;0<a.childNodes.length;)a.removeChild(a.lastChild)},shortfilename:function(a){if(!(null==a||void 0==a)){var b=a.split("/");if(null==b||1>=b.length)b=a.split("\\");if(!(null==b||0==b.length))return b[b.length-1]}},getdate_millisecond:function(a){if(null!=a){a=a.replace(".",
"/").replace(".","/").replace("-","/").replace("-","/").replace("T"," ").replace("Z"," ");var b=a.split("/");3<b.length&&(a=b[0]+"/"+b[1]+"/"+b[2]+"."+b[3]);return+new Date(a)}},loadCsv:function(a,b){if(null!=a){b=b||",";for(var c=RegExp("(\\"+b+'|\\r?\\n|\\r|^)(?:"([^"]*(?:""[^"]*)*)"|([^"\\'+b+"\\r\\n]*))","gi"),d=[[]],e=null;e=c.exec(a);){var f=e[1];f.length&&f!==b&&d.push([]);e=e[2]?e[2].replace(RegExp('""',"g"),'"'):e[3];d[d.length-1].push(e)}return d}},drawLineWithIdToDivEx:function(a,b,c,d,
e,f,g,m){if(null==d||null==c||0==c.length||void 0===a||void 0===b||!1===a instanceof GWTK.Point||!1===b instanceof GWTK.Point)return!1;var h=a.x;a=a.y;var p=b.x,q=b.y,r=(b=$.browser.msie)?$.browser.version:9;if(b&&9>r){h=parseInt(h,10);a=parseInt(a,10);p=parseInt(p,10);q=parseInt(q,10);b=document.createElement("hr");b.className=null!=g&&void 0!=g?g:"ruler-line-msie";b.id=c;b.setAttribute("unselectable","on");c=g=!0;h>p&&(g=!1,r=h,h=p,p=r);a>q&&(c=!1,r=a,a=q,q=r);var s=r=0;null!=e&&void 0!=e&&(r=e.x,
s=e.y);h+=r;a+=s;e=p+r-h;p=q+s-a;f=Math.sqrt(e*e+p*p);GWTK.DomUtil.setPosition(b,GWTK.point(h+r,a+s));b.style.width=f;m=(g?e:-e)/f;f=(c?p:-p)/f;f="progid:DXImageTransform.Microsoft.Alpha(opacity=80) "+("progid:DXImageTransform.Microsoft.Matrix(SizingMethod='auto expand',FilterType='bilinear',M11="+m+",M12="+-f+",M21="+f+",M22="+m+")");b.style.filter=f;d.appendChild(b)}else if(9<=r||$.browser.webkit||$.browser.opera||$.browser.mozilla||$.browser.gecko)h=parseInt(h,10),a=parseInt(a,10),p=parseInt(p,
10),q=parseInt(q,10),b=document.createElement("canvas"),d.appendChild(b),b.className=null!=f&&void 0!=f?f:"ruler-line",b.id=c,c=g=!0,h>p&&(g=!1,r=h,h=p,p=r),a>q&&(c=!1,r=a,a=q,q=r),s=r=0,null!=e&&void 0!=e&&(r=e.x,s=e.y),h+=r,a+=s,p+=r,q+=s,e=p-h,p=q-a,GWTK.DomUtil.setPosition(b,GWTK.point(h+r,a+s)),b.width=e,b.height=p,d=b.getContext("2d"),d.lineWidth=2,null!=m&&void 0!=m&&(d.lineWidth=m),d.strokeStyle="#FF0000",f=$("."+f).css("color"),null!=f&&void 0!=f&&(d.strokeStyle=f),d.globalAlpha=0.8,d.beginPath(),
d.moveTo(g?0:e,c?0:p),d.lineTo(g?e:0,c?p:0),d.stroke()}};GWTK.placemarkEx=function(a,b,c,d,e,f,g,m){this.name="placemarkEx";this.id=a;this.latlong=[];null!=b&&(void 0!=b&&2==b.length)&&(this.latlong[0]=b[0],this.latlong[1]=b[1]);this.title=c;this.text=d;this.href=void 0!=e&&null!=e?e:GWTK.imgMarkerBlankRed;this.size=void 0!=f&&null!=f?f:GWTK.point(30,50);void 0!=g&&null!=g?this.offset=g:(this.offset=GWTK.point(0,0),this.offset.x=-Math.round(this.size.x/2),this.offset.y=-this.size.y);void 0!=m&&null!=
m&&(this.hrefover=m);this.vertex;this.realpoint;this.img=this.div="";this.init();this.create()};GWTK.placemarkEx.prototype={init:function(){if(void 0==this.title||null==this.title)this.title="";if(void 0==this.text||null==this.text)this.text=""},create:function(){var a=document.createElement("div");a.id=this.name+"div_"+this.id;var b=document.createElement("img");b.id=this.name+"img_"+this.id;b.src=this.href;b.setAttribute("hrefout",this.href);void 0!=this.hrefover&&null!=this.hrefover&&(b.setAttribute("hrefover",
this.hrefover),b.onmouseout=function(a){this.src=this.getAttribute("hrefout");void 0!=a&&a.preventDefault();return!1},b.onmouseover=function(a){this.src=this.getAttribute("hrefover");void 0!=a&&a.preventDefault();return!1},b.getid=function(){var a=this.id.split("_");if(null!=a&&0<a.length)return a[a.length-1]});a.className="placemark";a.appendChild(b);this.div=a;this.img=b},getposition:function(){return this.geopoint()._pos},position:function(a){if(!a)return a;this.vertex=a;this.realpoint=GWTK.point(a.x,
a.y);a.x+=this.offset.x;a.y+=this.offset.y;GWTK.DomUtil.setPosition(this.div,a);return a},toPoint:function(){return null===this.latlong?null:this.latlong},isgeopoint:function(){return null===this.latlong?!1:!0},geopoint:function(){return this.div},imgpoint:function(){return this.img}}};if(window.GWTK){var clickingEditing,mapEditor_button_RU="\u0420\u0435\u0434\u0430\u043a\u0442\u043e\u0440 \u043a\u0430\u0440\u0442\u044b",mapEditor_selmap_RU="\u0412\u044b\u0431\u043e\u0440 \u043a\u0430\u0440\u0442\u044b",mapEditor_create_RU="\u0421\u043e\u0437\u0434\u0430\u0442\u044c \u043e\u0431\u044a\u0435\u043a\u0442",mapEditor_edit_RU="\u0420\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u043e\u0431\u044a\u0435\u043a\u0442",mapEditor_group_RU="\u0413\u0440\u0443\u043f\u043f\u043e\u0432\u044b\u0435 \u043e\u043f\u0435\u0440\u0430\u0446\u0438\u0438",
mapEditor_savep_RU="\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c \u043d\u0430 \u0441\u0435\u0440\u0432\u0435\u0440 (\u0421trl+S)",mapEditor_deletepoint_RU="\u0423\u0434\u0430\u043b\u0438\u0442\u044c \u0442\u043e\u0447\u043a\u0443",mapEditor_saveobject_RU="\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c",mapEditor_cancel_RU="\u041e\u0442\u043c\u0435\u043d\u0438\u0442\u044c \u0440\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0435",mapEditor_continue_RU="\u041f\u0440\u043e\u0434\u043e\u043b\u0436\u0438\u0442\u044c",
mapEditor_moveobject_RU="\u041f\u0435\u0440\u0435\u043c\u0435\u0441\u0442\u0438\u0442\u044c \u043e\u0431\u044a\u0435\u043a\u0442",mapEditor_deleteobject_RU="\u0423\u0434\u0430\u043b\u0438\u0442\u044c \u043e\u0431\u044a\u0435\u043a\u0442",mapEditor_prev_RU="\u041e\u0442\u043c\u0435\u043d\u0438\u0442\u044c \u043e\u043f\u0435\u0440\u0430\u0446\u0438\u044e (\u0421trl+Z)",mapEditor_next_RU="\u041f\u043e\u0432\u0442\u043e\u0440\u0438\u0442\u044c \u043e\u043f\u0435\u0440\u0430\u0446\u0438\u044e (\u0421trl+Y)",
mapEditor_confirm_moveobject_RU="C\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c \u0438\u0437\u043c\u0435\u043d\u0435\u043d\u0438\u044f \u043d\u0430 \u0441\u0435\u0440\u0432\u0435\u0440?",mapEditor_confirm_deleteobject_RU="\u0412\u044b \u043f\u043e\u0434\u0442\u0432\u0435\u0440\u0436\u0434\u0430\u0435\u0442\u0435 \u0443\u0434\u0430\u043b\u0435\u043d\u0438\u0435 \u043e\u0431\u044a\u0435\u043a\u0442\u0430 \u043d\u0430 \u0441\u0435\u0440\u0432\u0435\u0440\u0435?",mapEditor_confirm_cancelediting_RU=
"\u0417\u0430\u0432\u0435\u0440\u0448\u0438\u0442\u044c \u0440\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0435 \u043e\u0431\u044a\u0435\u043a\u0442\u0430 ",mapEditor_confirm_cancelcreating_RU="\u0417\u0430\u0432\u0435\u0440\u0448\u0438\u0442\u044c \u0441\u043e\u0437\u0434\u0430\u043d\u0438\u0435 \u043e\u0431\u044a\u0435\u043a\u0442\u0430 ",mapEditor_confirm_savechange_RU="\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c \u0432\u043d\u0435\u0441\u0435\u043d\u043d\u044b\u0435 \u0438\u0437\u043c\u0435\u043d\u0435\u043d\u0438\u044f? ",
mapEditor_selectobject_RU="\u0412\u044b\u0431\u0435\u0440\u0438\u0442\u0435 \u043e\u0431\u044a\u0435\u043a\u0442 \u0434\u043b\u044f \u043d\u0430\u043d\u0435\u0441\u0435\u043d\u0438\u044f \u043d\u0430 \u043a\u0430\u0440\u0442\u0443",mapEditor_moveobjectclose_RU="\u041f\u0435\u0440\u0435\u043c\u0435\u0449\u0435\u043d\u0438\u0435 \u0442\u043e\u0447\u043a\u0438",mapEditor_finish_RU="\u0417\u0430\u0432\u0435\u0440\u0448\u0438\u0442\u044c",mapEditor_continue_RU="\u041f\u0440\u043e\u0434\u043e\u043b\u0436\u0438\u0442\u044c",
mapEditor_closeobject_RU="\u0417\u0430\u043c\u043a\u043d\u0443\u0442\u044c",mapEditor_cutobject_RU="\u0420\u0430\u0437\u0440\u0435\u0437\u0430\u0442\u044c",mapEditor_changedirection_RU="\u0421\u043c\u0435\u043d\u0438\u0442\u044c \u043d\u0430\u043f\u0440\u0430\u0432\u043b\u0435\u043d\u0438\u0435";GWTK.mapeditor=function(a,b,c){this.id=a;this.map=b;if((void 0==this.map||null==this.map)&&void 0!=GWTK.maphandlers&&null!=GWTK.maphandlers)this.map=GWTK.maphandlers.map;this.initRes("RU");this.param=c;this.maplayersid=
[];this.functions=["create","edit","delete","group"];this.pointEdition=this.maplayerid=this.selectedFeatures=null;this.editobjects=[];this.action;this.ischange=!1;this.imgdrag=GWTK.imgDragPoint;this.imgdragpoint=GWTK.imgRedPoint;this.lineworkid="linework";this.history=new GWTK.geometryhistory;this.initialize()};GWTK.mapeditor.prototype={initialize:function(){if(void 0==this.id||null==this.id||void 0==this.map||null==this.map||!1==this.map instanceof GWTK.Map||void 0==this.param||null==this.param)return this;
if(void 0!=this.param.maplayersid&&null!=this.param.maplayersid){for(var a=this.param.maplayersid.length,b=0;b<a;b++)this.maplayersid.push(this.param.maplayersid[b]);0<a&&(this.maplayerid=this.maplayersid[0])}if(void 0!=this.param.functions&&(null!=this.param.functions&&0!=this.param.functions.length)&&(a=this.param.functions.length,0<=a)){this.functions.splice(a);for(b=0;b<a;b++)this.functions.push(this.param.functions[b])}this.initEditor();this.initEvents();$(document).ready(function(){GWTK.mapeditor.prototype._readCookie()});
this.selectedFeatures=void 0!=GWTK.featureSearch&&null!=GWTK.featureSearch?GWTK.featureSearch.selectedFeatures:(new GWTK.selectFeatures).selectedFeatures;this.movedrag=new GWTK.MapDragData;_edition=this;$(this.map.mapPane).on("mapclick",function(a){_edition.pointEdition=new GWTK.Point(a.point.x,a.point.y);return!1});return this},initEditor:function(){if(!(null==this.map||null==this.map.panes||null==this.map.panes.toolbarPane)){var a=GWTK.DomUtil.create("div","control-button control-button-mapeditor control-button-radio clickable",
this.map.panes.toolbarPane);a.id="panel_button-mapEditor";a.disabled=!1;a.title=this.res_mapEditor_button;a._pane="editorPane"}},initEvents:function(){var a=this;$("#panel_button-mapEditor").on("click",function(b){void 0==a.param||null==a.param||void 0==a.param.maplayersid||null==a.param.maplayersid?alert("\u041e\u0442\u0441\u0443\u0442\u0441\u0442\u0432\u0443\u044e\u0442 \u0441\u043b\u043e\u0438 \u0440\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u044f"):$(b.currentTarget).hasClass("control-button-active")?
($(b.currentTarget).removeClass("control-button-active"),a.destroy()):($(b.currentTarget).addClass("control-button-active"),a.init(),void 0!=b.cancelable&&GWTK.Map.prototype._writeCookiePanels())})},destroy:function(){this.stop();$(document).off("keyup");$(document).off("keydown");$(this.map.mapPane).off("mapclick");$(this.map.mapPane).off("loadclassifier");null==this.map||null==this.map.mapPane||(null!=this.panel&&($(this.panel).children().remove(),this.map.mapPane.removeChild(this.panel)),this.panel=
null)},findfunction:function(a){for(var b=0;b<this.functions.length;b++)if(this.functions[b]==a)return b;return-1},init:function(){if(!(void 0==this.param||null==this.param)){this.panel=this.map.createPane("mapEditor-panel map-panel-def",this.map.mapPane);this.panel.id="editorPane";$(this.panel).draggable({containment:"parent",distance:2});var a='<div class="edContainer"><div class="routeFilesName" align="center">'+this.res_mapEditor_button+'<img id="edHeaderList_'+this.id+'" class="panel-info-close  ui-widget-content" title="'+
this.res_close+'" src="'+GWTK.imgClose+'"></div><div> <table width="100%" > <tr align="left"> ';1<this.param.maplayersid.length&&(a+='<td> <div id="edselmap_'+this.id+'" class="control-button control-button_edselmap clickable" Title="'+this.res_mapEditor_selmap+'"> </div> </td> ');0<=this.findfunction("create")&&(a+='<td align="right"> <div id="edcreate_'+this.id+'" class="control-button control-button_edcreate control-button-radio clickable" Title="'+this.res_mapEditor_create+'"> </div> </td> ');
0<=this.findfunction("edit")&&(a+='<td align="left"> <div id="ededit_'+this.id+'" class="control-button control-button_ededit control-button-radio clickable" Title="'+this.res_mapEditor_edit+'"> </div> </td> ');$("#editorPane").append(a+"</tr> </table> </div>  </div>");var b=this;$(document).ready(function(){$("#edHeaderList_"+b.id).click(function(a){$("#panel_button-mapEditor").click()});$("#edcreate_"+b.id).click(function(a){$(a.currentTarget).hasClass("control-button-active")?($(a.currentTarget).removeClass("control-button-active"),
$(GWTK.maphandlers.map.panes.eventPane).on("click",GWTK.maphandlers.mapclick),b.clickCreating()):($(a.currentTarget).addClass("control-button-active"),b.clickOff("edit"),b.clickCreating(!0))});$("#ededit_"+b.id).click(function(a){$(a.currentTarget).hasClass("control-button-active")?($(a.currentTarget).removeClass("control-button-active"),$(GWTK.maphandlers.map.panes.eventPane).on("click",GWTK.maphandlers.mapclick),b.clickEditing()):(b.clickOff("create"),$(a.currentTarget).addClass("control-button-active"),
b.clickEditing(!0))});isCtrl=!1;$(document).on("keyup",function(a){17==a.which&&(isCtrl=!1);switch(a.keyCode){case 27:return $("#mapeditingPopupmenu").hide(),!1}}).on("keydown",function(a){17==a.which&&(isCtrl=!0);if(isCtrl)switch(a.which){case 90:return b.restorehistory("prev"),isCtrl=!1;case 89:return b.restorehistory("next"),isCtrl=!1;case 83:return $("#edsave_"+b.id).click(),isCtrl=!1;case 13:return b.complete(),isCtrl=!1}})})}},initRes:function(a){switch(a){case "RU":this.res_mapEditor_button=
window.mapEditor_button_RU,this.res_close=window.close_RU,this.res_mapEditor_selmap=window.mapEditor_selmap_RU,this.res_mapEditor_create=window.mapEditor_create_RU,this.res_mapEditor_edit=window.mapEditor_edit_RU,this.res_mapEditor_group=window.mapEditor_group_RU,this.res_mapEditor_save=window.mapEditor_savep_RU,this.res_mapEditor_confirm_cancelediting=window.mapEditor_confirm_cancelediting_RU,this.res_mapEditor_confirm_cancelcreating=window.mapEditor_confirm_cancelcreating_RU,this.res_mapEditor_confirm_savechange=
window.mapEditor_confirm_savechange_RU,this.res_mapEditor_moveobject=window.mapEditor_moveobject_RU,this.res_mapEditor_deleteobject=window.mapEditor_deleteobject_RU,this.res_mapEditor_confirm_moveobject=window.mapEditor_confirm_moveobject_RU,this.res_mapEditor_confirm_deleteobject=window.mapEditor_confirm_deleteobject_RU,this.res_mapEditor_prev=window.mapEditor_prev_RU,this.res_mapEditor_next=window.mapEditor_next_RU,this.res_mapEditor_deletepoint=window.mapEditor_deletepoint_RU,this.res_mapEditor_selectobject=
window.mapEditor_selectobject_RU,this.res_mapEditor_finish=window.mapEditor_finish_RU,this.res_mapEditor_continue=window.mapEditor_continue_RU,this.res_mapEditor_closeobject=window.mapEditor_closeobject_RU,this.res_mapEditor_cutobject=window.mapEditor_cutobject_RU,this.res_mapEditor_changedirection=window.mapEditor_changedirection_RU}},clickOff:function(a){switch(a){case "create":("startCreation"==this.action||"processCreation"==this.action)&&$("#edcreate_"+this.id).click();break;case "edit":("startEdition"==
this.action||"processEdition"==this.action)&&$("#ededit_"+this.id).click()}},clickCreating:function(a){if(a){if(this.mapdiv=document.getElementById("mapPane"),!(void 0==this.mapdiv||null==this.mapdiv))if(this.history.clear(),this.ischange=!1,this.action="startCreation",a=this.getlayer(this.maplayerid),void 0!=a){(a=a.classifier.getlegend())&&this.initSelectObjects(a);var b=this;$(this.map.mapPane).on("loadclassifier",function(a){if(a.legend){var d=document.getElementsByTagName("head");if(0!=d.length){var d=
d[0],e=$("<style type='text/css'> .w2ui-sidebar .w2ui-sidebar-div .w2ui-node .w2ui-node-image { width: 42px !important;}</style>");d.appendChild(e[0]);b.initSelectObjects(a.legend);return!1}}});return!1}}else this.stopCreating()},clickEditing:function(a){if(a){if(this.mapdiv=document.getElementById("mapPane"),!(void 0==this.mapdiv||null==this.mapdiv)){this.action="startEdition";var b=this;$(this.mapdiv).on("mapobjectloadWfs",function(a){if(void 0==a.layer||null==a.layer||void 0==a.gid&&null==a.gid)return!1;
"startEdition"==b.action&&b.setobject(a.layer,a.gid);return!1});$(this.mapdiv).on("featurelistclick",function(a){if(void 0==a.layer||null==a.layer||void 0==a.gid&&null==a.gid)return!1;b.setobject(a.layer,a.gid);return!1});0!=this.selectedFeatures.mapobjects.length&&void 0!=this.selectedFeatures&&(null!=this.selectedFeatures&&void 0!=this.selectedFeatures.drawselobject&&null!=this.selectedFeatures.drawselobject)&&this.setobject(this.selectedFeatures.drawselobject.maplayerid,this.selectedFeatures.drawselobject.gid)}}else this.stopEditing()},
destroyAction:function(){$("#edsave_"+this.id).click();$("#mapeditingAddmenu").remove();this._restoredrawpanel();this.destroyInfoObject();this.clearEditobjects();this.action=null;this.history.clear()},destroyInfoObject:function(){var a="editsemantic_"+this.id,b=$("[name="+a+"]");void 0!=b&&0!=b.length&&w2ui[a].destroy();$("#mapeditingInfoObject"+this.maplayerid).remove()},stop:function(){this.stopCreating();this.stopEditing()},stopCreating:function(){this.destroyAction();this.removepaneSelectObjects()},
removepaneSelectObjects:function(){var a=$("[name='mapediting_slider']");void 0!=a&&0!=a.length&&w2ui.mapediting_slider.destroy();$("#mapeditingSelectObjects"+this.maplayerid).remove()},stopEditing:function(){this.destroyAction();$(this.mapdiv).off("mapobjectloadWfs");$(this.mapdiv).off("featurelistclick");void 0!=this.selectedFeatures&&(null!=this.selectedFeatures&&void 0!=this.selectedFeatures.drawselobject&&null!=this.selectedFeatures.drawselobject)&&this.selectedFeatures.drawselobject.drawcontour()},
save:function(a){$("#mapeditingPopupmenu").hide();for(var b=this.editobjects.length,c=0;c<b;c++)this.editobjects[c].save(a)},resetaftersave:function(a){this.ischange=!1;null!=this.geometry&&this.geometry.cleardraw();this.history.clear();var b={};switch(this.action){case "processCreation":null!=this.editobjects[0].geometry&&this.editobjects[0].geometry.clear();this.createPaneInfoObject();this.processCreation();break;case "processEdition":null!=this.pointEdition&&this.map.getFeatureInfo(this.pointEdition);
this.editobjects[0].clear();b.text="";this.createPaneInfoObject(b);break;default:return}a.map.tiles.wmsManager.view_refresh=!0;a.map.tiles.forceupdate()},issetnewobject:function(a,b){if(!this.ischange||0==this.editobjects.length)return!0;var c=this.res_mapEditor_confirm_cancelediting,d="replace";0<=this.action.indexOf("Creation")&&(c=this.res_mapEditor_confirm_cancelcreating,d="create");var e=this.editobjects[0].gid;"0"==this.editobjects[0].gid&&(e="");if(void 0!=a&&void 0!=b&&a==this.editobjects[0].maplayerid&&
b==e)confirm(this.res_mapEditor_confirm_savechange)?this.save(d):this.ischange=!1;else if(confirm(c+e+"?"))confirm(this.res_mapEditor_confirm_savechange)?this.save(d):this.ischange=!1;else return!1;for(c=0;c<this.editobjects;c++)this.editobjects[c].cleardraw();this.clearEditobjects();switch(this.action){case "processCreation":this.clickOff("create");break;case "processEdition":this.clickOff("edit")}return!0},clearEditobjects:function(){this.points=this.drawpoints=this.drawpanel=this.geometry=null;
for(var a=this.editobjects.length,b=0;b<a;b++)this.editobjects[b].clear();this.editobjects.splice(0,this.editobjects.length)},isActionProcess:function(){return void 0==this.action||null==this.action||0>this.action.indexOf("process")?!1:!0},setobject:function(a,b){this.ischange=!1;this.history.clear();for(var c=-1,d=0;d<this.maplayersid.length;d++)if(this.maplayersid[d].toLowerCase()==a.toLowerCase()){c=d;break}if(!(0>c||null==this.selectedFeatures||void 0==this.selectedFeatures)){if(null==this.selectedFeatures.drawselobject||
void 0==this.selectedFeatures.drawselobject){if(0==this.selectedFeatures.mapobjects.length)return;c=this.selectedFeatures.findobjectsById(a,b);if(void 0==c||null==c||0==c.geometry.count())return}else c=this.selectedFeatures.drawselobject;c.cleardraw();this.clearEditobjects();this.editobjects[0]=c.createcopy(c);this.setExPropertys(this.editobjects[0]);this.editobjects[0].drawcontour();this.geometry=this.editobjects[0].geometry;this.drawpanel=this.geometry.drawpanel;this.drawpoints=this.geometry.drawpoints;
this.points=this.geometry.points;null==this.geometry||(void 0==this.geometry||null==this.drawpanel||void 0==this.drawpanel||null==this.points||void 0==this.points||0==this.points.length||null==this.drawpoints||void 0==this.drawpoints)||("startEdition"==this.action&&(this.action="processEdition"),c={},c.text=this.editobjects[0].name,this.createPaneInfoObject(c),this.processEdition())}},setExPropertys:function(a,b){void 0==a||null==a||(void 0==b&&(b=!0),a.setDrawParam(!0,!0,b),a.geometry.imgpoint=GWTK.imgRealPoint,
a.geometry.imgpointCurrent=GWTK.imgCurrentPoint,a.geometry.imgpointSelect=GWTK.imgMarkerRedPoint,a.geometry.imgpointCenter=GWTK.imgCenterPoint,a.geometry.imgpointFirst=GWTK.imgFirstPoint,a.geometry.imgpointLast=GWTK.imgLastPoint,a.geometry.mapeditor=this)},createPaneInfoObject:function(a){this.destroyInfoObject();var b="";switch(this.action){case "processCreation":(a=this.getrscobject(this.editobjects[0].key))&&(b='<div align="center"> \u0421\u043e\u0437\u0434\u0430\u043d\u0438\u0435 \u043e\u0431\u044a\u0435\u043a\u0442\u0430 <table  align="center" style="width:100%;" cellpadding=0> <tr><td align="right" ><div class="'+
a.image+'" style="width:40px;" ></div></td><td align="left" class="routeFilesName">'+a.name+"</td></tr></tr></table></div>");break;case "processEdition":a&&(b='<div style="width:100%;" align="center"> \u0420\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0435 \u043e\u0431\u044a\u0435\u043a\u0442\u0430 <div  class="routeFilesName">'+a.text+"</div> </div>");break;default:return}a=this.map.createPane(" edContainerInfo",this.panel);a.id="mapeditingInfoObject"+this.maplayerid;
$(a).append(b);this.addmenu()},addmenu:function(a){if(0!=this.editobjects.length){$("#mapeditingAddmenu").remove();a=$("#mapeditingInfoObject"+this.maplayerid);a=0==a.length?this.map.mapPane:a[0];this.paneAdd=this.map.createPane("edContainer",a);this.paneAdd.id="mapeditingAddmenu";var b=a="",c=this.editobjects[0].geometry.count();0!=c&&"processEdition"==this.action&&(a='<td align="left"><div id="mapeditingAddmenu_move" class="control-button control-button_addmenu control-button_edmoveobject clickable" Title="'+
this.res_mapEditor_moveobject+'"> </div> </td>',"point"==this.editobjects[0].spatialposition&&(a=""),this.findfunction("delete")&&(b='<td align="left"><div id="mapeditingAddmenu_delete" class="control-button control-button_addmenu control-button_eddeleteobject clickable" Title="'+this.res_mapEditor_deleteobject+'"> </div> </td>'));var d="",d=this.history.count(),e=' disabled = "disabled" ',f=e,g=GWTK.imgNextDisable,m=GWTK.imgPrevDisable;this.history.current<d-1&&(e="",g=GWTK.imgNext);0<=this.history.current&&
(f="",m=GWTK.imgPrev);d='<td align="right"><div id="mapeditingAddmenu_history_prev" class="control-button control-button_addmenu clickable" style="background-image:url('+m+')" Title=" '+this.res_mapEditor_prev+'"'+f+'> </div> </td><td align="left"><div id="mapeditingAddmenu_history_next" class="control-button control-button_addmenu clickable" style="background-image:url('+g+')" Title=" '+this.res_mapEditor_next+'"'+e+"> </div> </td>";e="";0<=this.findfunction("edit")&&(this.ischange&&0<c)&&(e='<td></td> <td align="left"> <div id="edsave_'+
this.id+'" class="control-button control-button_edsave control-button_addmenu clickable" Title="'+this.res_mapEditor_save+'"> </div> </td> ');$(this.paneAdd).append('<div><div> <table width="100%" > <tr align="left"> '+a+b+d+e+"</tr> </table> </div>  </div>");var h=this;$(document).ready(function(){$("#mapeditingAddmenu_close").click(function(a){$("#mapeditingAddmenu").hide();return!1});$("#mapeditingAddmenu_move").click(function(a){h.setdrawpanelMax();h.drawpanel.style.cursor="move";h.action="processEdition_moveobject";
return!1});$("#mapeditingAddmenu_delete").click(function(a){confirm(h.res_mapEditor_confirm_deleteobject)&&($("#mapeditingAddmenu").hide(),h.save("delete"))});$("#mapeditingAddmenu_history_prev").click(function(a){h.restorehistory("prev");h.addmenu()});$("#mapeditingAddmenu_history_next").click(function(a){h.restorehistory("next");h.addmenu()});$("#edsave_"+h.id).click(function(a){a="replace";"processCreation"==h.action&&(a="create");if(("processEdition"==h.action||"processCreation"==h.action)&&h.ischange)confirm(h.res_mapEditor_confirm_moveobject)?
h.save(a):h.addmenu()})})}},_popupmenu:function(a,b,c,d,e){$("#mapeditingPopupmenu").remove();if(!(null==this.geometry||void 0==this.geometry)){void 0==d&&(d="create");var f="0px",g="0px";isNaN(b)||(f=parseInt(b-5,10)+"px");isNaN(c)||(g=parseInt(c-5,10)+"px");b=' style="left:'+f+";top:"+g+'; cursor: pointer;"';c='<tr> <td id="mapeditingPopupmenu_deletepoint" style="padding-left:15px;">'+this.res_mapEditor_deletepoint+"</td></tr>";if("processCreation"!=this.action&&(null==a||!this.geometry.isdeletingpoint()||
e||"processEdition_moveobject"==this.action))c="";if(""!=c){e=this.editobjects[0].spatialposition;var m=g=f="",h="",p="",q=this._getnumber(a.id),r=this.geometry.count(),s=!0;if(4>r||this.points[0].x!=this.points[r-1].x||this.points[0].y!=this.points[r-1].y)s=!1;if(q==r-1){if("processCreation"==this.action&&("create"==d&&(f='<tr> <td id="mapeditingPopupmenu_finish" style="padding-left:15px;">'+this.res_mapEditor_finish+"</td></tr>"),"edit"==d&&!s&&"point"!=e&&("vector"==e&&1==r||"vector"!=e)))g='<tr> <td id="mapeditingPopupmenu_continue" style="padding-left:15px;">'+
this.res_mapEditor_continue+"</td></tr>";"linestring"==e&&(3<=r&&!s)&&(m='<tr> <td id="mapeditingPopupmenu_closeobject" style="padding-left:15px;">'+this.res_mapEditor_closeobject+"</td></tr>")}"linestring"==e&&(3<=r&&s)&&(h='<tr> <td id="mapeditingPopupmenu_cutobject" style="padding-left:15px;">'+this.res_mapEditor_cutobject+"</td></tr>");"point"!=e&&1<r&&(p='<tr> <td id="mapeditingPopupmenu_changedirection" style="padding-left:15px;">'+this.res_mapEditor_changedirection+"</td></tr>");d='<div id="mapeditingPopupmenu" class=" map-panel-def editTable" '+
b+' ><div align="left"  class="routeFilesName" height="50px;"><div><img id="mapeditingPopupmenu_close" style="margin-top:-5px;" class="panel-info-close  ui-widget-content" title="'+this.res_close+'" src="'+GWTK.imgClose+'"> </div></div><div><table cellspacing="1px;" cellpadding="2px" style="width:140px;">'+c+m+h+p+f+g+"</table></div></div>";$(this.drawpanel).append(d);var u=this.geometry,t=this;$(document).ready(function(){$("#mapeditingPopupmenu_close").click(function(a){$("#mapeditingPopupmenu").hide();
return!1});$("#mapeditingPopupmenu_deletepoint").click(function(b){$("#mapeditingPopupmenu").hide();if(void 0==a||null==a)return alert("\u041e\u0442\u0441\u0443\u0442\u0441\u0442\u0432\u0443\u0435\u0442 \u0442\u043e\u0447\u043a\u0430 \u0434\u043b\u044f \u0443\u0434\u0430\u043b\u0435\u043d\u0438\u044f"),!1;b=t._getnumber(a.id);var c=u._isclosing(b);t.history.add("delete",b,null,u.points[b]);u.deletepoint(b);c&&t.closeobject(!0);t.ischange=!0;t.updatedrawcontur();return!1});$("#mapeditingPopupmenu_finish").click(function(a){$("#mapeditingPopupmenu").hide();
t.complete();return!1});$("#mapeditingPopupmenu_continue").click(function(a){$("#mapeditingPopupmenu").hide();t.processCreation();return!1});$("#mapeditingPopupmenu_closeobject").click(function(a){$("#mapeditingPopupmenu").hide();t.closeobject(!1);t.complete();return!1});$("#mapeditingPopupmenu_cutobject").click(function(b){$("#mapeditingPopupmenu").hide();b=t._getnumber(a.id);for(var c=[],d=0;d<u.points.length;d++)c.push(u.points[d].clone());u.cutline(b+1);t.history.add("all",null,null,null,null,
c,u.points);t.ischange=!0;t.updatedrawcontur();return!1});$("#mapeditingPopupmenu_changedirection").click(function(a){$("#mapeditingPopupmenu").hide();u.changedirection();t.history.add("changedirection");t.ischange=!0;t.updatedrawcontur();return!1})})}}},initSelectObjects:function(a){if(a&&a.items&&0!=a.items.length){var b=this.map.createPane("mapEditorObjects-panel map-panel-def map-contents-panel",this.map.mapPane);b.id="mapeditingSelectObjects"+this.maplayerid;$(b).draggable({containment:"parent",
distance:2});var c='<div  class="routeFilesName" align="center">'+this.res_mapEditor_selectobject+'</div> </br> <div id="mapediting_slider'+this.maplayerid+'" class="resizable panel-mapcontent-container" style=" max-height: 400px; width: 100%; overflow: auto; padding-right: 1px; "></div>';$(b).append(c);for(var d=this,b=[],e,f,c=0;c<a.items.length;c++)if(0!=a.items[c].nodes.length&&(e=a.items[c].id.split("_"),!(null==e||2>e.length))){f=e[1];b[c]={};b[c].id="editor_"+a.items[c].id;b[c].text=a.items[c].text;
b[c].img=a.items[c].img;b[c].expanded=a.items[c].expanded;b[c].nodes=[];for(var g=0;g<a.items[c].nodes.length;g++){e=a.items[c].nodes[g];var m={};m.id="editor_"+e.id;m.text=e.text;m.img=e.img;m.code=e.code;m.local=e.local;m.expanded=!0;m.bsdlayer=f;b[c].nodes.push(m)}}0<b.length&&($("#mapediting_slider"+this.maplayerid).w2sidebar({name:"mapediting_slider"}),w2ui.mapediting_slider.add(b),w2ui.mapediting_slider.on("dblClick",function(a){a=w2ui.mapediting_slider.get(a.target);void 0!=a&&(null!=a&&void 0!=
a.code&&null!=a.code)&&d.createPaneCreateObjects(a)}))}},createPaneCreateObjects:function(a){this.removepaneSelectObjects();if(!(void 0==a||null==a)){this.editobjects[0]=new GWTK.mapobject(this.map,"0",this.maplayerid);this.editobjects[0].id="0";this.editobjects[0].code=a.code;var b=a.id.split("_");if(null==b||3<=b.length)this.editobjects[0].key=b[1];this.editobjects[0].name=a.text;this.editobjects[0].layername=a.bsdlayer;this.editobjects[0].geometry.srsName="urn:ogc:def:crs:EPSG:4326";switch(a.local){case "0":this.editobjects[0].spatialposition=
"linestring";break;case "1":this.editobjects[0].spatialposition="polygon";break;case "2":this.editobjects[0].spatialposition="point";break;case "4":this.editobjects[0].spatialposition="vector";break;default:return}this.setExPropertys(this.editobjects[0],!1);this.editobjects[0].drawcontour();this.geometry=this.editobjects[0].geometry;this.drawpanel=this.geometry.drawpanel;this.drawpoints=this.geometry.drawpoints;this.points=this.geometry.points;this.drawpanel.style.cursor="pointer";this.action="processCreation";
this.createPaneInfoObject(a);this.processCreation()}},processEdition:function(){if(!(null==this.geometry||void 0==this.geometry||null==this.drawpoints||void 0==this.drawpoints||0==this.drawpoints.length)){this.addmenu();for(var a=this,b=0;b<this.drawpoints.length;b+=2){this.drawpoints[b].geopoint().onmouseup=function(b){b=GWTK.getEvent(b);void 0!=b.target.parentElement._pos&&null!=b.target.parentElement._pos&&a._popupmenu(b.target,b.target.parentElement._pos.x,b.target.parentElement._pos.y,"edit")};
var c=function(){$("#mapeditingPopupmenu").hide();if("processEdition_moveobject"==a.action)return!1};$(a.drawpoints[b].geopoint()).draggable({start:c(),stop:function(b,c){a._onstop($(b.target)[0],c)},drag:function(b,c){a._ondrag($(b.target)[0],c,!0)},helper:$('<img src="'+a.imgdrag+'"/>')});0<b&&(a.drawpoints[b-1].geopoint().onmouseup=function(b){b=GWTK.getEvent(b);void 0!=b.target.parentElement._pos&&null!=b.target.parentElement._pos&&a._popupmenu(b.target,b.target.parentElement._pos.x,b.target.parentElement._pos.y,
"edit",!0)},$(a.drawpoints[b-1].geopoint()).draggable({start:c(),stop:function(b,c){a._onstop($(b.target)[0],c)},drag:function(b,c){a._ondrag($(b.target)[0],c)},helper:$('<img src="'+a.imgdrag+'"/>')}))}"processEdition"==a.action&&$(a.drawpanel).mousedown(function(b){"processEdition_moveobject"==a.action&&($(document).on("mousedown",function(b){if("processEdition_moveobject"==a.action)return a.movedrag.init(),a.movedrag.setOffsetPoint(GWTK.point(b.clientX,b.clientY)),$(document).bind("mousemove",
function(b){if("processEdition_moveobject"==a.action){var c=a.map.mapPane.getBoundingClientRect(),d=0,e=0;b.clientX<=c.left+10||b.clientY<=c.top+10||b.clientX>=c.right-10||b.clientY>=c.bottom-10?(a.drawpanel.style.cursor="default",b.clientX<=c.left+10&&(d=-10),b.clientY<=c.top+10&&(e=-10),b.clientX>=c.right-10&&(d=10),b.clientY>=c.bottom-10&&(e=10),a.movedrag.dx=d,a.movedrag.dy=e,a.movedrag.x+=d,a.movedrag.y+=e,a.drawpanel.style.left=a.movedrag.x+"px",a.drawpanel.style.top=a.movedrag.y+"px",a.map.move(-a.movedrag.dx,
-a.movedrag.dy),a.map.tiles._onMouseMove(-a.movedrag.dx,-a.movedrag.dy)):(a.movedrag.setOffset(b),a.drawpanel.style.left=a.movedrag.x+"px",a.drawpanel.style.top=a.movedrag.y+"px",a.drawpanel.style.cursor="move");return!1}}),!1}),$(document).on("mouseup",function(b){if("processEdition_moveobject"==a.action)return $(document).unbind("mousemove"),a.action="processEdition",a.drawpanel.style.cursor="default",a._updatepoints(a.movedrag.x,a.movedrag.y,!0),!1}))})}},processCreation:function(){var a=this;
this.ischange=!0;$(this.drawpanel).children().remove("#"+this.lineworkid);this.setdrawpanelMax();this.movedrag.init();this.drawpanel.style.cursor="crosshair";var b=this.drawpanel.getBoundingClientRect();$(this.drawpanel).on("mousedown",function(b){if("processCreation"==a.action){b=GWTK.getEvent(b);if(0<=b.target.id.indexOf("placemarkEximg_mop"))return 0>b.target.id.indexOf("center")&&a._popupmenu(b.target,b.target.parentElement._pos.x,b.target.parentElement._pos.y),!1;if(0<=b.target.id.indexOf("mapeditingPopupmenu"))return!1;
$("#mapeditingPopupmenu").remove();a._addpoint(b.clientX,b.clientY,!0);a.addmenu();"point"==a.editobjects[0].spatialposition&&a.complete();"vector"==a.editobjects[0].spatialposition&&2==a.points.length&&a.complete();return!1}});$(this.drawpanel).on("mousemove",function(c){if("processCreation"==a.action){if(0>=a.points.length)return!1;var d=a.map.mapPane.getBoundingClientRect(),e=0,f=0;if(c.clientX<=d.left+10||c.clientY<=d.top+10||c.clientX>=d.right-10||c.clientY>=d.bottom-10)a.drawpanel.style.cursor=
"default",c.clientX<=d.left+10&&(e=-10),c.clientY<=d.top+10&&(f=-10),c.clientX>=d.right-10&&(e=10),c.clientY>=d.bottom-10&&(f=10),a.movedrag.dx=e,a.movedrag.dy=f,a.movedrag.x+=e,a.movedrag.y+=f,a.drawpanel.style.left=a.movedrag.x+"px",a.drawpanel.style.top=a.movedrag.y+"px",a.map.move(-a.movedrag.dx,-a.movedrag.dy),a.map.tiles._onMouseMove(-a.movedrag.dx,-a.movedrag.dy),a._updatepoints(-e,-f,!0,!0),a.geometry.cleardraw(),a.geometry.drawcontour(a.drawpanel,a.geometry.drw_select,a.geometry.drw_points);
a.drawpanel.style.cursor="crosshair";$(a.drawpanel).children().remove("#"+a.lineworkid);c=GWTK.point(c.clientX-b.left,c.clientY-b.top);GWTK.routeUtil.drawLineWithIdToDivEx(a.drawpoints[a.drawpoints.length-1].realpoint,c,a.lineworkid,a.drawpanel,GWTK.point(0,0),"editing-line","editing-line-msie");return!1}});$(this.drawpanel).on("dblclick",function(b){a.complete();return!1});$(this.drawpanel).off("mousewheel DOMMouseScroll wheel MozMousePixelScroll");$(this.drawpanel).on("mousewheel DOMMouseScroll wheel MozMousePixelScroll",
function(b){$(a.drawpanel).off("dblclick");$(a.drawpanel).off("mousedown");$(a.drawpanel).off("mousemove");a.map.handlers.mousewheelscaling(b);a.processCreation()})},complete:function(){"processCreation"==this.action&&("polygon"==this.editobjects[0].spatialposition&&!this.closeobject(!1)?alert("\u041e\u0431\u044a\u0435\u043a\u0442 \u0441\u043e\u0434\u0435\u0440\u0436\u0438\u0442 \u043c\u0435\u043d\u0435\u0435 3 \u0442\u043e\u0447\u0435\u043a!"):(this.setExPropertys(this.editobjects[0]),this.geometry.cleardraw(),
this.geometry.drawcontour(this.drawpanel,this.geometry.drw_select,this.geometry.drw_points,this.geometry.drw_centerpoints),$(this.drawpanel).off("mousedown"),$(this.drawpanel).off("mousemove"),$(this.drawpanel).off("mousewheel DOMMouseScroll wheel MozMousePixelScroll"),$(this.drawpanel).children().remove("#"+this.lineworkid),this.map.overlayRefresh(),this.processEdition()))},closeobject:function(a){var b=!0;if(void 0==this.geometry||null==this.geometry)return b;var c=this.geometry.count();if(0==c||
this.geometry.points[0].x==this.geometry.points[c-1].x&&this.geometry.points[0].y==this.geometry.points[c-1].y)return b;a?(c=new GWTK.Point3D(this.geometry.points[0].x,this.geometry.points[0].y,this.geometry.points[0].h),b=this.geometry.closeobject(a),this.history.add("update",0,null,c,this.geometry.points[0])):(b=this.geometry.closeobject(a),a=this.geometry.count()-1,this.history.add("insert",a,null,null,this.geometry.points[a]));b&&(this.ischange=!0);return b},_ondrag:function(a,b){if(void 0==a||
null==a)return!1;var c;if(0<a.id.indexOf("mop"))c="point";else if(0<a.id.indexOf("lop"))c="line";else return!1;"point"==c&&(0>=a.id.indexOf("center")?this._movepoint(a,this.editobjects[0].spatialposition,b):this._movepointcenter(a,b));return!1},_onstop:function(a,b){if(void 0==a||null==a)return!1;var c;if(0<a.id.indexOf("mop"))c="point";else if(0<a.id.indexOf("lop"))c="line";else return;"point"==c&&(0>=a.id.indexOf("center")?this._updatepoint(a,this.editobjects[0].spatialposition,b):this._updatepoint(a,
this.editobjects[0].spatialposition,b,!0))},_getnumber:function(a){if(void 0==a||null==a)return-1;a=a.split("_");if(!(null==a||6>a.length))return parseInt(a[5])},_movepoint:function(a,b,c){$(this.drawpanel).children().remove("#addlines1");$(this.drawpanel).children().remove("#addlines2");var d=this._getnumber(a.id);if(0>d)return!1;switch(b){case "polygon":d==this.points.length-1?(this._drawline(this.geometry._setLineIdByPointId(a.id,"curr"),c,a.id,"last"),a=this.drawpoints[0].geopoint().id,this._drawline(this.geometry._setLineIdByPointId(a,
"next"),c,a,"first")):0!=d?(this._drawline(this.geometry._setLineIdByPointId(a.id,"curr"),c,a.id,"last"),this._drawline(this.geometry._setLineIdByPointId(a.id,"next"),c,a.id,"first")):(this._drawline(this.geometry._setLineIdByPointId(a,"next"),c,a.id,"first"),a=this.drawpoints[this.drawpoints.length-1].geopoint().id,this._drawline(this.geometry._setLineIdByPointId(a,"curr"),c,a,"last"));break;case "linestring":case "curve":0==d?this._drawline(this.geometry._setLineIdByPointId(a.id,"next"),c,a.id,
"first"):d==this.points.length-1?(a=this.drawpoints[this.drawpoints.length-1].geopoint().id,this._drawline(this.geometry._setLineIdByPointId(a,"curr"),c,a,"last")):(this._drawline(this.geometry._setLineIdByPointId(a.id,"curr"),c,a.id,"last"),this._drawline(this.geometry._setLineIdByPointId(a.id,"next"),c,a.id,"first"));break;case "point":this._movepoints(a,c)}},offsetCenter:function(a){var b=[];b[0]=$("#"+a)[0].clientWidth;b[0]=void 0!=b[0]?b[0]/2:0;b[1]=$("#"+a)[0].clientHeight;b[1]=void 0!=b[1]?
b[1]/2:0;return b},_updatepoint:function(a,b,c,d){$(this.drawpanel).children().remove("#addlines1");$(this.drawpanel).children().remove("#addlines2");b=this._getnumber(a.id);if(0>b)return!1;a=this.offsetCenter(a.id);c=GWTK.point(c.position.left+a[0],c.position.top+a[1]);c=this.map.tiles.getLayersPointProjected(c);c=GWTK.projection.xy2geo(GWTK.maphandlers.map.options.crs,c.y,c.x);d?(c=new GWTK.Point3D(c[0],c[1]),3==parseInt(this.dimension)&&(d=this.points[b+1].h,a=this.points[number1].h,c.h=void 0!=
a&&void 0!=d?a+(d-a):0),this.points.splice(b,0,c),this.history.add("insert",b,null,null,this.points[b])):(d=new GWTK.Point3D(this.points[b].x,this.points[b].y,this.points[b].h),this.points[b].x=c[0],this.points[b].y=c[1],"polygon"==this.editobjects[0].spatialposition&&(b==this.points.length-1?(this.points[0].x=c[0],this.points[0].y=c[1]):0==b&&(this.points[this.points.length-1].x=c[0],this.points[this.points.length-1].y=c[1])),this.history.add("update",b,null,d,this.points[b]));this.ischange=!0;this.updatedrawcontur()},
_drawline:function(a,b,c,d){a=this.offsetCenter(c);switch(d){case "first":b=GWTK.point(b.position.left+a[0],b.position.top+a[1]);c=this._finddrawpointsById(this._setPointIdByPointId(c,"next"));if(void 0==c)return;d=c.realpoint;c="addlines1";break;case "last":d=GWTK.point(b.position.left+a[0],b.position.top+a[1]);c=this._finddrawpointsById(this._setPointIdByPointId(c,"prev"));if(void 0==c)return;b=c.realpoint;c="addlines2";break;default:return}$(this.drawpanel).children().remove("#"+c);GWTK.routeUtil.drawLineWithIdToDivEx(b,
d,c,this.drawpanel,GWTK.point(0,0),"editing-line","editing-line-msie")},_movepointcenter:function(a,b,c){$(this.drawpanel).children().remove("#addlines1");$(this.drawpanel).children().remove("#addlines2");var d=this.offsetCenter(a.id);c=this._finddrawpointsById(this._setPointIdByPointId(a.id,"prev"));void 0!=c&&(c=c.realpoint,b=GWTK.point(b.position.left+d[0],b.position.top+d[1]),GWTK.routeUtil.drawLineWithIdToDivEx(c,b,"addlines1",this.drawpanel,GWTK.point(0,0),"editing-line","editing-line-msie"),
c=this._finddrawpointsById(this._setPointIdByPointId(a.id,"curr")),void 0!=c&&(c=c.realpoint,GWTK.routeUtil.drawLineWithIdToDivEx(c,b,"addlines2",this.drawpanel,GWTK.point(0,0),"editing-line","editing-line-msie")))},_setPointIdByPointId:function(a,b,c){if(!(void 0==a||null==a))if(a=a.split("_"),!(null==a||6>a.length)){var d=parseInt(a[5]);switch(b){case "curr":break;case "prev":d-=1;break;case "next":d+=1;break;default:return}b=a[0]+"_mop_"+a[2]+"_"+a[3]+"_"+a[4]+"_"+d.toString();c&&(b+="_center");
return b}},_finddrawpointsById:function(a){if(!(null==this.drawpoints||void 0==this.drawpoints))for(var b=this.drawpoints.length,c=0;c<b;c++)if(this.drawpoints[c].geopoint().id==a)return this.drawpoints[c]},_movepoints:function(a,b){$(this.drawpanel).children().remove("#addlines1");var c=this.offsetCenter(a.id),d=this._finddrawpointsById(a.id);void 0!=d&&(d=GWTK.point(d.realpoint),c=GWTK.point(b.position.left+c[0],b.position.top+c[1]),GWTK.routeUtil.drawLineWithIdToDivEx(d,c,"addlines1",this.drawpanel,
GWTK.point(0,0),"editing-line","editing-line-msie"))},_updatepoints:function(a,b,c){0>this.action.indexOf("Creation")&&this.geometry._restoredrawpanel();var d=GWTK.point(this.drawpoints[0].realpoint.x+a,this.drawpoints[0].realpoint.y+b),d=this.map.tiles.getLayersPointProjected(d),e=GWTK.projection.xy2geo(GWTK.maphandlers.map.options.crs,d.y,d.x),d=[];d[0]=e[0]-this.drawpoints[0].latlong[0];d[1]=e[1]-this.drawpoints[0].latlong[1];for(var e=this.points.length,f=0;f<e;f++)this.points[f].x+=d[0],this.points[f].y+=
d[1];this.ischange=!0;c&&this.history.add("offset",null,GWTK.point(a,b),null);0>this.action.indexOf("Creation")&&this.updatedrawcontur()},_addpoint:function(a,b,c){if(!(null==this.geometry||void 0==this.geometry)){var d=this.drawpanel.getBoundingClientRect();a=GWTK.point(a-d.left,b-d.top);a=this.map.tiles.getLayersPointProjected(a);a=GWTK.projection.xy2geo(GWTK.maphandlers.map.options.crs,a.y,a.x);a=new GWTK.Point3D(a[0],a[1]);b=this.geometry.count();this.geometry.appendpoint(a.x,a.y);c&&this.history.add("insert",
b,null,null,this.points[b]);this.ischange=!0;this.geometry.cleardraw();this.geometry.drawcontour(this.drawpanel,this.geometry.drw_select,this.geometry.drw_points);return b}},restorehistory:function(a){void 0!=this.drawpanel&&$(this.drawpanel).children().remove("#"+this.lineworkid);if(!(void 0==a||null==a||"prev"!=a&&"next"!=a)){var b;b="prev"==a?this.history.prev():this.history.next();if(!(null==b||void 0==b||null==b.type||void 0==b.type)){this.ischange=0>this.history.current&&null!=this.mapeditor|
void 0!=this.mapeditor?!1:!0;var c=b.number;if(!("offset"!=b.type&&"all"!=b.type&&"changedirection"!=b.type&&(void 0==c||null==c))){switch(b.type){case "insert":"prev"==a?this.points.splice(c,1):this.points.splice(c,0,new GWTK.Point3D(b.coord_new.x,b.coord_new.y,b.coord_new.h));break;case "delete":"prev"==a?this.points.splice(c,0,new GWTK.Point3D(b.coord_old.x,b.coord_old.y,b.coord_old.h)):this.points.splice(c,1);break;case "update":a="prev"==a?new GWTK.Point3D(b.coord_old.x,b.coord_old.y,b.coord_old.h):
new GWTK.Point3D(b.coord_new.x,b.coord_new.y,b.coord_new.h);this.points.splice(c,1,a);"polygon"==this.editobjects[0].spatialposition&&c==this.points.length-1&&(this.points[0].x=a.x,this.points[0].y=a.y);break;case "offset":c=b.offset.x;b=b.offset.y;"prev"==a&&(c=-c,b=-b);this._updatepoints(c,b);return;case "all":this.points.splice(0,this.points.length);if("prev"==a)for(a=0;a<b.points_old.length;a++)this.points.push(b.points_old[a].clone());else for(a=0;a<b.points_new.length;a++)this.points.push(b.points_new[a].clone());
break;case "changedirection":this.geometry.changedirection()}this.updatedrawcontur()}}}},updatedrawcontur:function(){this.geometry.cleardraw();this.geometry.drawcontour(this.drawpanel,this.geometry.drw_select,this.geometry.drw_points,this.geometry.drw_centerpoints);null==this.geometry||(void 0==this.geometry||null==this.drawpanel||void 0==this.drawpanel||null==this.points||void 0==this.points||0==this.points.length||null==this.drawpoints||void 0==this.drawpoints)||this.processEdition()},setdrawpanelMax:function(){var a=
GWTK.maphandlers.map.getWindowSize();this.drawpanel.style.left="0px";this.drawpanel.style.top="0px";this.drawpanel.style.width=a[0]+"px";this.drawpanel.style.height=a[1]+"px"},getLegend:function(){if(this.map.options&&this.map.options.layers){var a=this.map.options,b,c=a.layers.length;for(b=0;b<c;b++)if(a.layers[b].id==this.maplayerid){"url"in a.layers[b]&&""!=a.layers[b].url&&-1==a.layers[b].url.indexOf("http:")&&(a.layers[b].url=a.url+"?"+a.layers[b].url);var d=a.layers[b].url,e=a.layers[b].url.indexOf("?");
-1!==e&&(d=d.slice(0,e));e=GWTK.Util.getParamsFromURL(a.layers[b].url);if("layers"in e){e=e.layers;a=new WfsQueries(d);this.map.tiles.legendWfs.push(a);a.context=this;a.onDataLoad=GWTK.Util.onLegendDataLoaded;a.sendRequest({method:"createLegend",layer:e,width:"32",objlocal:"0,1,2,4"});break}}}},getlayer:function(a){for(var b=this.map.layers.length,c=0;c<b;c++)if(a==this.map.layers[c].options.id)return this.map.layers[c]},getrscobject:function(a){if(a){var b=this.getlayer(this.maplayerid);if(b)return b.classifier.getobject(a)}},
_restoredrawpanel:function(){void 0==this.drawpanel||null==this.drawpanel||(this.drawpanel.style.width="1px",this.drawpanel.style.height="1px",this.drawpanel.style.left="0px",this.drawpanel.style.top="0px",this.drawpanel.style.cursor="default",$(this.drawpanel).off("mousedown"),$(this.drawpanel).off("mousemove"),$(this.drawpanel).off("mousewheel DOMMouseScroll wheel MozMousePixelScroll"))},_readCookie:function(){var a=GWTK.cookie("VisiblePanels",GWTK.cookies.converter);void 0!==a&&$.each(a,function(a,
c){var d=c.shift(),e=0<c.length?c.shift():"",e=e.split(",");"panel_button-mapEditor"==d&&(button=$("#"+d),panel=button[0]._pane,"show"==e[0]&&($("#panel_button-mapEditor").click(),GWTK.maphandlers.map.setMapContentPanel()))})}};GWTK.mapEditor=function(a,b,c){b.mapEditor=GWTK._mapEditor=new GWTK.mapeditor(a,b,c);return GWTK._mapEditor};GWTK.geometryhistory=function(){this.current=-1;this.historys=[]};GWTK.geometryhistory.prototype={add:function(a,b,c,d,e,f,g){if(!(void 0==a||null==a)){var m=[];m.type=
a;m.number=b;c&&(m.offset=new GWTK.Point3D(c.x,c.y,c.h));d&&(m.coord_old=new GWTK.Point3D(d.x,d.y,d.h));e&&(m.coord_new=new GWTK.Point3D(e.x,e.y,e.h));if("all"==a)if(void 0!=f&&0<f.length&&void 0!=g&&0<g.length){m.points_old=[];for(a=0;a<f.length;a++)m.points_old.push(f[a].clone());m.points_new=[];for(a=0;a<g.length;a++)m.points_new.push(g[a].clone())}else return;this.historys.push(m);this.current=this.historys.length-1}},clear:function(){this.historys.splice(0,this.historys.length);this.current=
-1},next:function(){if(0!=this.historys.length)return this.current!=this.historys.length-1&&(this.current+=1),this.historys[this.current]},prev:function(){if(!(0>this.current)){var a=this.historys[this.current];0<=this.current&&(this.current-=1);return a}},count:function(){return this.historys.length}}};window.GWTK&&(GWTK.rscobject={code:"",local:"",segment:"",segmentname:"",segmentkey:"",scale:"",direct:"",bot:"",top:"",name:"",code:"",rscsemantics:[],image:"",cssimage:""},GWTK.rscsemantic={code:"",type:"",reply:"",enable:"",service:"",name:"",unit:"",minimum:"","default":"",maximum:"",size:"",decimal:"",shortname:"",value:"",image:""},GWTK.classifiersematic={code:"",key:"",reference:[]},GWTK.record={value:"",text:""},GWTK.classifier=function(a){this.layerid=this.name=null;this.layer=a;void 0==
a?void 0!=GWTK.maphandlers&&null!=GWTK.maphandlers&&(this.map=GWTK.maphandlers.map):this.map=this.layer.map;this.classifiersematiclist=[];this.rscobjects=[];this.legend=null;this.initialize()},GWTK.classifier.prototype={initialize:function(){if(void 0==this.layer||null==this.layer||!1==this.layer instanceof GWTK.Layer&&!1==this.layer instanceof GWTK.WmsLayer)return this;this.layerid=this.layer.options.id;return this},getlegend:function(){if(null==this.legend)this.initwfs();else return this.legend},
initwfs:function(){if(!(0<this.rscobjects.length)){var a=this.map.options.url;"url"in this.layer.options&&""!=this.layer.options.url&&-1==this.layer.options.url.indexOf("http:")&&(this.layer.options.url=this.map.options.url+"?"+this.layer.options.url);var a=this.layer.options.url,b=this.layer.options.url.indexOf("?");-1!==b&&(a=a.slice(0,b));a=new WfsQueries(a);a.context=this;a.onDataLoad=GWTK.Util.onLegendDataLoaded;a.sendRequest({method:"createLegend",layer:this.layerid,width:"32",objlocal:"0,1,2,4"})}},
loadObjects:function(a){if(void 0!=a){this.legend=a;this.name=a.imgpath;for(var b,c,d,e=0;e<a.items.length;e++)if(0!=a.items[e].nodes.length&&(d=a.items[e].id.split("_"),!(null==d||2>d.length))){c=d[1];for(var f=0;f<a.items[e].nodes.length;f++){b=a.items[e].nodes[f];var g={};g.code=b.code;g.local=b.local;g.segmentname=a.items[e].text;g.segmentkey=c;g.name=b.text;d=b.id.split("_");null==d||2>d.length||(g.key=d[0],g.image=b.img,g.cssimage=b.css,this.rscobjects.push(g))}}this.map.overlayPane&&$(this.map.overlayPane).trigger({type:"loadclassifier",
legend:this.legend})}},onDataLoaded:function(a,b){if(a&&b&&!1!=b instanceof GWTK.classifier)switch(a.restmetod){case "GetSemanticWithList":this.classifiersematiclist=JSON.parse(classifiersematiclist)}},getobject:function(a){for(var b=0;b<this.rscobjects.length;b++)if(this.rscobjects[b].key==a)return this.rscobjects[b]},loadclassifiersematic:function(a){for(var b=0;b<this.classifiersematiclist.length;b++)if(this.classifiersematiclist[b].key==a)return this.classifiersematiclist[b]}});GWTK.Bounds=function(a,b){if(a)for(var c=b?[a,b]:a,d=0,e=c.length;d<e;d++)this.extend(c[d])};
GWTK.Bounds.prototype={extend:function(a){a=GWTK.point(a);!this.min&&!this.max?(this.min=a.clone(),this.max=a.clone()):(this.min.x=Math.min(a.x,this.min.x),this.max.x=Math.max(a.x,this.max.x),this.min.y=Math.min(a.y,this.min.y),this.max.y=Math.max(a.y,this.max.y));return this},getCenter:function(a){return new GWTK.Point((this.min.x+this.max.x)/2,(this.min.y+this.max.y)/2,a)},getBottomLeft:function(){return new GWTK.Point(this.min.x,this.max.y)},getTopRight:function(){return new GWTK.Point(this.max.x,
this.min.y)},getTopLeft:function(){return new GWTK.Point(this.min.x,this.max.y)},getSize:function(){return this.max.subtract(this.min)},contains:function(a){var b;a="number"===typeof a[0]||a instanceof L.Point?GWTK.point(a):GWTK.bounds(a);a instanceof L.Bounds?(b=a.min,a=a.max):b=a;return b.x>=this.min.x&&a.x<=this.max.x&&b.y>=this.min.y&&a.y<=this.max.y},intersects:function(a){a=GWTK.bounds(a);var b=this.min,c=this.max,d=a.min;a=a.max;var e=a.y>=b.y&&d.y<=c.y;return a.x>=b.x&&d.x<=c.x&&e},isValid:function(){return!(!this.min||
!this.max)}};GWTK.bounds=function(a,b){return!a||a instanceof GWTK.Bounds?a:new GWTK.Bounds(a,b)};GWTK.Point=function(a,b,c){this.x=c?Math.round(a):a;this.y=c?Math.round(b):b};
GWTK.Point.prototype={clone:function(){return new GWTK.Point(this.x,this.y)},add:function(a){return this.clone()._add(GWTK.point(a))},_add:function(a){this.x+=a.x;this.y+=a.y;return this},subtract:function(a){return this.clone()._subtract(GWTK.point(a))},_subtract:function(a){this.x-=a.x;this.y-=a.y;return this},divideBy:function(a){return this.clone()._divideBy(a)},_divideBy:function(a){this.x/=a;this.y/=a;return this},multiplyBy:function(a){return this.clone()._multiplyBy(a)},_multiplyBy:function(a){this.x*=
a;this.y*=a;return this},round:function(){return this.clone()._round()},_round:function(){this.x=Math.round(this.x);this.y=Math.round(this.y);return this},floor:function(){return this.clone()._floor()},_floor:function(){this.x=Math.floor(this.x);this.y=Math.floor(this.y);return this},distanceTo:function(a){a=GWTK.point(a);var b=a.x-this.x;a=a.y-this.y;return Math.sqrt(b*b+a*a)},equals:function(a){a=GWTK.point(a);return a.x===this.x&&a.y===this.y},contains:function(a){a=GWTK.point(a);return Math.abs(a.x)<=
Math.abs(this.x)&&Math.abs(a.y)<=Math.abs(this.y)},toString:function(){return"Point("+GWTK.Util.formatNum(this.x)+", "+GWTK.Util.formatNum(this.y)+")"}};GWTK.point=function(a,b,c){return a instanceof GWTK.Point?a:GWTK.Util.isArray(a)?new GWTK.Point(a[0],a[1]):void 0===a||null===a?a:new GWTK.Point(a,b,c)};function WcsQueries(a){this.qoptions={SERVICE:"WCS",REQUEST:""};this.xmlDoc=new xmlDocument;this.mapsrv="";this.enabled=!1;this.qtimeout=6E4;var b,c;this.init=function(a){this.mapsrv=a;this.enabled=!0};"undefined"==typeof a?this.enabled=!1:(this.init(a),this.onDataLoad=null,this.sendRequest=function(a,e){if("undefined"!=typeof a){var f=this.mapsrv+"?",g;for(g in a){var m=a[g];"undefined"!=typeof m&&(f="dimensionsubsetx"==g||"dimensionsubsety"==g?f+("&dimensionsubset="+m):f+("&"+g+"="+m))}$.support.cors=
!0;$.browser.msie&&10>$.browser.version?(b=new XDomainRequest,b.timeout=this.qtimeout,b.ontimeout=this.onTimeout,b.onload=this.onSuccess,b.onerror=this.onError,b.ondataload=this.onDataLoad,b.open("get",f),b.send()):c="GetCoverage"==a.REQUEST?$.ajax({crossDomain:!0,type:"get",url:f,processData:!1,data:{},response:"text/xml",async:!0,context:this,error:this.onError,success:this.onSuccess,timeout:this.qtimeout}):$.ajax({crossDomain:!0,type:"get",url:this.mapsrv,data:a,response:"text/xml",async:!0,context:this,
error:this.onError,success:this.onSuccess,timeout:this.qtimeout})}},this.onSuccess=function(a){if(null!=c)this.xmlDoc=c.responseText,this.onDataLoad(this.xmlDoc);else if("text/xml"==this.contentType&&null!=this.wmts&&(this.wmts.xmlDoc=this.responseText),null!=this.ondataload)this.ondataload(this.responseText)},this.onError=function(a,b,f){a="Request Error. ";"undefined"!=typeof b&&(a+=b+". ");b='<?xml version="1.0" encoding="utf-8"?><ExceptionReport version="1.0.0" xmlns="http://www.opengis.net/ows/2.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://www.opengis.net/ows/2.0  owsExceptionReport.xsd" ><Exception><ExceptionText>'+
a+"</ExceptionText></Exception></ExceptionReport>";if(null!=c)if("undefined"!=typeof this.onDataLoad)this.onDataLoad(b);else if(null!=hdr&&"undefined"!=typeof this.ondataload)this.ondataload(b)},this.onTimeout=function(){if("undefined"!=typeof this.ondataload)b.ondataload('<?xml version="1.0" encoding="utf-8"?><ExceptionReport version="1.0.0" xmlns="http://www.opengis.net/ows/2.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://www.opengis.net/ows/2.0  owsExceptionReport.xsd" ><Exception><ExceptionText>timeout </ExceptionText></Exception></ExceptionReport>');
return'<?xml version="1.0" encoding="utf-8"?><ExceptionReport version="1.0.0" xmlns="http://www.opengis.net/ows/2.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://www.opengis.net/ows/2.0  owsExceptionReport.xsd" ><Exception><ExceptionText>timeout </ExceptionText></Exception></ExceptionReport>'},this.getcapabilities=function(){if(!(!1==this.enabled||0==this.mapsrv.length)){var a=this.qoptions;a.REQUEST="GetCapabilities";this.sendRequest(a)}},this.\u0441overagelist=
function(a){if(!(!1==this.enabled||0==this.mapsrv.length)){var b=this.qoptions;b.REQUEST="DescribeCoverage";b.COVERAGEID=a;this.sendRequest(b)}},this.\u0441overage=function(a){if(!(!1==this.enabled||0==this.mapsrv.length)){var b;if("object"!=typeof a)try{b=$.parseJSON(a)}catch(c){alert(c.message)}else b=a;"undefined"==typeof b||null==b.covarageid||(a=this.qoptions,a.REQUEST="GetCoverage",a.CoverageId=b.covarageid,null!=b.resolution&&(a.resolution=b.resolution),null!=b.dimsubsetx&&0!=b.dimsubsetx.length&&
(a.dimensionsubsetx=b.dimsubsetx),null!=b.dimsubsety&&0!=b.dimsubsety.length&&(a.dimensionsubsety=b.dimsubsety),this.sendRequest(a))}})};function WfsQueries(a){this.qoptions={SERVICE:"WFS",REQUEST:"",OUTPUTFORMAT:"GML/XML"};this.xmlDoc=new xmlDocument;this.mapsrv="";this.enabled=!1;this.qtimeout=6E4;var b;this.context=this.hhr=null;this.init=function(a){this.mapsrv=a;this.enabled=!0};"undefined"==typeof a?this.enabled=!1:(this.init(a),this.onDataLoad=null,this.sendRequest=function(a,d){if("undefined"!=typeof a){var e=this.mapsrv+"?",f="",g;for(g in a){var m=a[g];window.XDomainRequest&&(m=encodeURIComponent(m));"undefined"!=typeof m&&
(e+=f+g+"="+m,f="&")}e+="&dt="+(new Date).getMilliseconds().toString();$.support.cors=!0;window.XDomainRequest?(b=new XDomainRequest,b.timeout=this.qtimeout,b.ontimeout=this.onTimeout,b.onload=this.onSuccess,b.onerror=this.onError,b.ondataload=this.onDataLoad,b.sender=this,b.open("get",e),b.send()):this.hhr=$.ajax({crossDomain:!0,type:"get",url:this.mapsrv,data:a,response:"text/xml",async:!0,context:this,error:this.onError,success:this.onSuccess,timeout:this.qtimeout})}},this.sendRequestSync=function(a){if("undefined"!=
typeof a){var d=this.mapsrv+"?",e="",f;for(f in a){var g=a[f];window.XDomainRequest&&(g=encodeURIComponent(g));"undefined"!=typeof g&&(d+=e+f+"="+g,e="&")}$.support.cors=!0;window.XDomainRequest?(b=new XDomainRequest,b.timeout=this.qtimeout,b.ontimeout=this.onTimeout,b.onload=this.onSuccess,b.onerror=this.onError,b.ondataload=this.onDataLoad,b.sender=this,b.open("get",d),b.send()):this.hhr=$.ajax({crossDomain:!0,type:"get",url:this.mapsrv,data:a,response:"text/xml",async:!1,context:this,error:this.onError,
success:this.onSuccess,timeout:this.qtimeout})}},this.getfeaturetypenamelist=function(a){if(!(!1==this.enabled||0==this.mapsrv.length))return this.context=a,this.sendRequest({SERVICE:"WFS",REQUEST:"GetCapabilities"})},this.onSuccess=function(a){if(null!=a)this.xmlDoc=this.hhr.responseText,this.onDataLoad(this.xmlDoc,this.context),this.context=null;else if("text/xml"==this.contentType&&null!=this.sender&&(this.sender.xmlDoc=this.responseText),null!=this.ondataload)this.ondataload(this.responseText,
this.sender.context)},this.onError=function(a,b,e){if(null!=this.hhr)a=b,b!=e&&0<e.length&&(a+=". "+e+"."),this.xmlDoc=setExceptionResponse(a),this.onDataLoad(this.xmlDoc,this.context),this.context=null;else if(void 0!==typeof this.sender){this.sender.xmlDoc=setExceptionResponse("Request error");if(void 0!=typeof this.ondataload)this.ondataload(this.sender.xmlDoc,this.sender.context);this.sender.context=null}},this.onTimeout=function(){if("undefined"!=typeof this.ondataload)b.ondataload('<?xml version="1.0" encoding="utf-8"?><ExceptionReport version="1.0.0" xmlns="http://www.opengis.net/ows/2.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://www.opengis.net/ows/2.0  owsExceptionReport.xsd" ><Exception><ExceptionText>timeout </ExceptionText></Exception></ExceptionReport>');
return'<?xml version="1.0" encoding="utf-8"?><ExceptionReport version="1.0.0" xmlns="http://www.opengis.net/ows/2.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://www.opengis.net/ows/2.0  owsExceptionReport.xsd" ><Exception><ExceptionText>timeout </ExceptionText></Exception></ExceptionReport>'},this.featuretype=function(a){var b={SERVICE:"WFS",REQUEST:"DescribeFeatureType",TYPENAMES:""};"undefined"!=typeof a&&(b.TYPENAMES=a);return this.sendRequest(b)},this.liststoredqueries=
function(){return this.sendRequest({SERVICE:"WFS",REQUEST:"ListStoredQueries"})},this.feature=function(a,b){var e;if("object"!=typeof a)try{e=$.parseJSON(a)}catch(f){alert(f.message)}else e=a;if(null==e)return"";this.context=b;for(var g in e)"result"==g.toLowerCase()&&(e.RESULTTYPE=e[g],e[g]=null,e.RESULTTYPE=0==e.RESULTTYPE?"hits":"results");e.SERVICE="WFS";e.REQUEST="GetFeature";return this.sendRequest(e)},this.featurebyid=function(a,b){if("undefined"==typeof a)return"";var e={SERVICE:"WFS",REQUEST:"GetFeature",
STOREDQUERY_ID:"urn:ogc:def:query:OGC-WFS::GetFeatureById"};e.ID=a;if(void 0!=b||null!=b)e.LAYER_ID=b;return this.sendRequest(e)},this.geopoint=function(a,b,e,f){var g={METHOD:"GetPointGeo",SERVICE:"WFS",Layer:"",POINT1:"",CRS:""};g.Layer=a;g.POINT1=b;g.CRS=e;this.context=f;this.sendRequest(g)},this.planepoint=function(a,b,e,f){var g={METHOD:"GetPointPlane",SERVICE:"WFS",Layer:"",POINT1:"",CRS:""};g.Layer=a;g.POINT1=b;g.CRS=e;this.context=f;this.sendRequest(g)},this.transaction=function(a,d){var e=
this.mapsrv+"?SERVICE=WFS&REQUEST=Transaction";void 0!=d&&null!=d&&(e+="&LAYER_ID="+d);$.support.cors=!0;if(window.XDomainRequest){if(b=new XDomainRequest)b.timeout=this.qtimeout,b.ontimeout=this.onTimeout,b.onerror=this.onError,b.onload=this.onSuccess,b.ondataload=this.onDataLoad,b.sender=this,b.open("POST",e),b.send(a)}else this.hhr=$.ajax({crossDomain:!0,context:this,url:e,processData:!1,type:"POST",data:a,response:"text/xml",dataType:"xml",success:this.onSuccess,error:this.onError})},this.textsearch=
function(a,b,e,f,g){if(!(void 0==typeof a||0==a.length||void 0==typeof b||0==b.length)){var m={METHOD:"TEXTSEARCH",SERVICE:"WFS",Layer:"",TextFilter:"",OBJCENTER:"1",START_INDEX:"0",OBJLOCAL:"0,1,2,4"};m.Layer=a;m.TextFilter=b;void 0!=typeof e&&0<=e&&(m.START_INDEX=e);void 0!=typeof f&&0<f&&(m.FEATURE_COUNT=f);m.MapID=a;this.context=g;this.sendRequest(m)}},this.areaseek=function(a,d,e){if(!(void 0==a||void 0==d||void 0==e)){var f=this.mapsrv+"?SERVICE=WFS&METHOD=",f=f+(e+"&LAYER="+a);$.support.cors=
!0;if(window.XDomainRequest){if(b=new XDomainRequest)b.timeout=this.qtimeout,b.ontimeout=this.onTimeout,b.onerror=this.onError,b.onload=this.onSuccess,b.ondataload=this.onDataLoad,b.sender=this,b.open("POST",f),b.send(d)}else hhr=$.ajax({crossDomain:!0,context:this,url:f,processData:!1,type:"POST",data:d,response:"text/xml",dataType:"xml",success:this.onSuccess,error:this.onError})}},this.areaseekinside=function(a,d){if(!(void 0==a||void 0==d)){var e=this.mapsrv+"?SERVICE=WFS&METHOD=",e=e+("areaseekinside&LAYER="+
a);$.support.cors=!0;if(window.XDomainRequest){if(b=new XDomainRequest)b.timeout=this.qtimeout,b.ontimeout=this.onTimeout,b.onerror=this.onError,b.onload=this.onSuccess,b.ondataload=this.onDataLoad,b.sender=this,b.open("POST",e),b.send(d)}else hhr=$.ajax({crossDomain:!0,context:this,url:e,processData:!1,type:"POST",data:d,response:"text/xml",dataType:"xml",success:this.onSuccess,error:this.onError})}},this.transactionstimefilter=function(a,b,e){if(!(void 0==a||null==a||0==a.length))if(!(void 0==b||
null==b)){if(void 0==e||null==e)e="00:00:00";var f={SERVICE:"WFS",METHOD:"GetTransaction",LAYER:"",DATE:"",TIME:""};f.LAYER=a;f.DATE=b;f.TIME=e;this.sendRequest(f,!0)}},this.spline=function(a,b,e){if(!(void 0==a||null==a||0==a.length)){void 0==typeof b&&(b="smooth");"smooth"!=b&&"bend"!=b&&(b="smooth");var f={SERVICE:"WFS",METHOD:"SPLINEBEND",LAYER:""};"smooth"==b&&(f.METHOD="SPLINECASHION");f.LAYER=a;this.postRequest(f,e)}},this.postRequest=function(a,d){if(!(void 0==typeof a||void 0==d)){var e=
this.mapsrv+"?",f;for(f in a){var g=a[f];"undefined"!=typeof g&&(e+="&"+f+"="+g)}$.support.cors=!0;if(window.XDomainRequest){if(b=new XDomainRequest)b.timeout=this.qtimeout,b.ontimeout=this.onTimeout,b.onerror=this.onError,b.onload=this.onSuccess,b.ondataload=this.onDataLoad,b.sender=this,b.open("POST",e),b.send(d)}else this.hhr=$.ajax({crossDomain:!0,context:this,url:e,processData:!1,type:"POST",data:d,response:"text/xml",dataType:"xml",success:this.onSuccess,error:this.onError})}},this.areafeature=
function(a,b){a&&b&&this.postRequest({SERVICE:"Wfs",METHOD:"GetArea",LAYER:a},b)})};function WmsQueries(a){this.qoptions={SERVICE:"WMS",VERSION:"1.3.0",REQUEST:""};this.qtimeout=6E4;this.xmlDoc=new xmlDocument;this.mapsrv="";this.enabled=!1;var b,c;this.init=function(a){this.mapsrv=a;this.enabled=!0};"undefined"==typeof a?this.enabled=!1:(this.init(a),this.onDataLoad=null,this.sendRequest=function(a){if("undefined"!=typeof a){var e=this.mapsrv+"?",f;for(f in a){var g=a[f];"undefined"!=typeof g&&(e+="&"+f+"="+g)}window.XDomainRequest?(b=new XDomainRequest,b.timeout=this.qtimeout,
b.ontimeout=this.onTimeout,b.onload=this.onSuccess,b.onerror=this.onError,b.ondataload=this.onDataLoad,b.wms=this,b.open("get",e),b.send()):($.support.cors=!0,c=$.ajax({crossDomain:!0,context:this,type:"get",url:this.mapsrv,data:a,response:"text/xml",async:!0,timeout:this.qtimeout,error:this.onError,success:this.onSuccess}))}},this.onSuccess=function(a){if(null!=c)this.xmlDoc=c.responseText,this.onDataLoad(this.xmlDoc);else if("undefined"===typeof a&&"text/xml"===this.contentType&&(this.wms.xmlDoc=
this.responseText),null!=this.ondataload)this.ondataload(this.responseText)},this.onError=function(a,b,f){if(null!=c)a=b,b!=f&&0<f.length&&(a+=". "+f+"."),this.xmlDoc=setExceptionResponse(a),this.onDataLoad(this.xmlDoc);else if("undefined"!==typeof this.wms&&(this.wms.xmlDoc=setExceptionResponse("error")),"undefined"!==typeof this.ondataload&&null!=this.ondataload)this.ondataload(this.wms.xmlDoc)},this.onTimeout=function(){this.wms.xmlDoc=setExceptionResponse("timeout");if("undefined"!=typeof this.ondataload)b.ondataload(b.wms.xmlDoc)},
this.getcapabilities=function(){if(!(!1==this.enabled||0==this.mapsrv.length)){var a=this.qoptions;a.REQUEST="GetCapabilities";return this.sendRequest(a)}},this.mapurl=function(a){var b="";if(null==this.mapsrv||null==a)return b;a="object"!=typeof a?$.parseJSON(a):a;if(null==a||null==a.layers||0==a.layers.length||null==a.crs||0==a.crs.length||null==a.bbox||0==a.bbox.length||null==a.width||0==a.width.length||null==a.height||0==a.height.length)return b;if(null==a.style||0==a.style.length)a.style="default";
null==a.format&&(a.format="");return b=this.mapsrv+"?SERVICE="+this.qoptions.SERVICE+"&VERSION="+this.qoptions.VERSION+"&REQUEST=GetMap&LAYERS="+a.layers+"&STYLE="+a.style+"&FORMAT="+a.format+"&crs="+a.crs+"&bbox="+a.bbox+"&width="+a.width+"&height="+a.height},this.featureinfo=function(a){if(null==a)return"";a="object"!=typeof a?$.parseJSON(a):a;if(null==a||null==a.layers||0==a.layers.length||null==a.query_layers||0==a.query_layers.length||null==a.crs||0==a.crs.length||null==a.bbox||0==a.bbox.length||
null==a.width||0==a.width.length||null==a.height||0==a.height.length||isNaN(a.i)||isNaN(a.j))return"";if(null==a.style||0==a.style.length)a.style="default";null==a.format&&(a.format="");if(null==a.info_format||""==a.info_format)a.info_format="text/xml";if(null==a.feature_count||0==a.feature_count.length)a.feature_count=10;a.request="GetFeatureInfo";a.service="WMS";a.version="1.3.0";return this.sendRequest(a)})};function WmtsQueries(a){this.gtile="?SERVICE=WMTS&VERSION=1.0.0";this.qoptions={SERVICE:"WMTS",VERSION:"1.0.0",REQUEST:""};this.qtimeout=6E4;this.xmlDoc=new xmlDocument;this.response;this.mapsrv="";this.enabled=!1;var b,c;this.context=null;this.init=function(a){this.mapsrv=a;this.enabled=!0};"undefined"==typeof a?this.enabled=!1:(this.init(a),this.onDataLoad=null,this.sendRequest=function(a){if("undefined"!=typeof a){var e=this.mapsrv+"?";"url"in a&&0!=a.url.length&&(e=a.url+"?");for(var f in a){var g=
a[f];"undefined"!=typeof g&&(e+="&"+f+"="+g)}$.support.cors=!0;window.XDomainRequest?(b=new XDomainRequest,b.timeout=this.qtimeout,b.ontimeout=this.onTimeout,b.onload=this.onSuccess,b.onerror=this.onError,b.ondataload=this.onDataLoad,b.wmts=this,b.open("get",e),b.send()):($.support.cors=!0,c=$.ajax({crossDomain:!0,context:this,type:"get",url:this.mapsrv,data:a,response:"text/xml",async:!0,timeout:this.qtimeout,error:this.onError,success:this.onSuccess}))}},this.onSuccess=function(a){if(a)this.xmlDoc=
c.responseText,this.onDataLoad(this.xmlDoc,this.context),this.context=null;else{"undefined"===typeof a&&"text/xml"===this.contentType&&(this.wmts.xmlDoc=this.responseText);if(null!=this.ondataload)this.ondataload(this.responseText,this.wmts.context);this.wmts.context=null}},this.onError=function(a,b,f){if(null!=c)a=b,b!=f&&0<f.length&&(a+=". "+f+"."),this.xmlDoc=setExceptionResponse(a),this.onDataLoad(this.xmlDoc,this.context),this.context=null;else{"undefined"!==typeof this.wmts&&(this.wmts.xmlDoc=
setExceptionResponse("error"));if("undefined"!=typeof this.ondataload)this.ondataload(this.wmts.xmlDoc,this.wmts.context);this.wmts.context=null}},this.onTimeout=function(){this.wmts.xmlDoc=setExceptionResponse("timeout");if("undefined"!=typeof this.ondataload)b.ondataload(b.wmts.xmlDoc,this.wmts.context);this.wmts.context=null},this.getcapabilities=function(a){!1==this.enabled||0==this.mapsrv.length||(this.context=a,this.sendRequest({SERVICE:"WMTS",VERSION:"1.0.0",REQUEST:"GetCapabilities"}))},this.tileurl=
function(a){if(null==this.mapsrv||null==a)return null;var b=[];a="object"!=typeof a?$.parseJSON(a):a;if(null==a||null==a.layer||0==a.layer.length||null==a.matrix||0==a.matrix.length)return b;-1==a.matrix.indexOf("urn:ogc:def:wkss:OGC:1.0:")&&(a.matrix="urn:ogc:def:wkss:OGC:1.0:"+a.matrix);if(null==a.style||0==a.style.length)a.style="default";null==a.format&&(a.format="");var c=this.mapsrv;void 0!=a.url&&(c=a.url);c=c+this.gtile+"&REQUEST=GetTile&LAYER="+a.layer+"&STYLE="+a.style+"&FORMAT="+a.format+
"&tilematrixset="+a.matrix+"&tilematrix="+a.zoom;if(null==a.min||2!=a.min.length)return b;if("undefined"===typeof a.max||2!=a.max.length){var g=c+"&tilerow="+a.min[1]+"&tilecol="+a.min[0];b.push(g);return b}if(a.min[0]>a.max[0]||a.min[1]>a.max[1])return b;for(var m=a.min[1];m<=a.max[1];m++)for(var h=a.min[0];h<=a.max[0];h++)g=c+"&tilerow="+m+"&tilecol="+h,b.push(g);return b},this.tileimage=function(a,b){if(null==this.mapsrv||null==a)return"";this.context=b;var c=$.parseJSON(a);if(null==c||null==c.layer||
0==c.layer.length||null==c.matrix||0==c.matrix.length)return"";-1==c.matrix.indexOf("urn:ogc:def:wkss:OGC:1.0:")&&(c.matrix="urn:ogc:def:wkss:OGC:1.0:"+c.matrix);if(null==c.style||0==c.style.length)c.style="default";if(null==c.min||2!=c.min.length)return"";null==c.format&&(c.format="");var g=this.qoptions;g.REQUEST="GetTile";g.layer=c.layer;g.style=c.style;g.tilematrixset=c.matrix;g.tilematrix=c.zoom;g.tilerow=c.min[1];g.tilecol=c.min[0];g.format=c.format;this.sendRequest(g)},this.featureinfo=function(a,
b){if(null==a)return"";this.context=b;var c;c="object"!=typeof a?$.parseJSON(a):a;if(null==c||null==c.layer||0==c.layer.length||null==c.tilematrixset||0==c.tilematrixset.length)return"";-1==c.tilematrixset.indexOf("urn:ogc:def:wkss:OGC:1.0:")&&(c.tilematrixset="urn:ogc:def:wkss:OGC:1.0:"+c.tilematrixset);if(null==c.style||0==c.style.length)c.style="default";null==c.format&&(c.format="");if(null==c.tilerow||null==c.tilecol)return"";if(null==c.info_format||""==c.info_format)c.info_format="text/xml";
if(isNaN(c.i)||isNaN(c.j))return"";c.REQUEST="GetFeatureInfo";c.SERVICE="WMTS";c.VERSION="1.0.0";c.MapID=c.layer;return this.sendRequest(c)},this.str2arraybuffer=function(a){if(!window.ArrayBuffer)return null;for(var b=new ArrayBuffer(2*a.length),c=new Uint16Array(b),g=0;g<a.length;g++)c[g]=a.charCodeAt(g);return b})};function xmlDocument(){if(window.DOMParser)return new DOMParser;var a=new ActiveXObject("Microsoft.XMLDOM");a.async="false";return a}function xmlLoad(a){if(!(null==a||0==a.length)){var b=xmlDocument();window.DOMParser?b=b.parseFromString(a,"application/xml"):b.loadXML(a);return b}}
setExceptionResponse=function(a){var b='<?xml version="1.0" encoding="utf-8"?><ExceptionReport version="1.0.0" xmlns="http://www.opengis.net/ows/2.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://www.opengis.net/ows/2.0 owsExceptionReport.xsd" ><Exception><ExceptionText>';"undefined"!=typeof a&&(b+=a);return b+"</ExceptionText></Exception></ExceptionReport>"};function MapMath(a){this.options_wfs={SERVICE:"WFS",REQUEST:"",OUTPUTFORMAT:"GML/XML"};this.options_wmts={SERVICE:"WMTS",VERSION:"1.0.0",REQUEST:""};this.xmlDoc=new xmlDocument;this.mapsrv="";this.enabled=!1;this.qtimeout=6E4;var b,c;this.context=null;this.init=function(a){this.mapsrv=a;this.enabled=!0};this.init(a);this.onDataLoad=null;this.sendRequest=function(a){if("undefined"!=typeof a){var e=this.mapsrv+"?",f;for(f in a){var g=a[f];"undefined"!=typeof g&&(e+="&"+f+"="+g)}window.XDomainRequest?
(b=new XDomainRequest,b.timeout=this.qtimeout,b.ontimeout=this.onTimeout,b.onload=this.onSuccess,b.onerror=this.onError,b.ondataload=this.onDataLoad,b.sender=this,b.open("get",e),b.send()):($.support.cors=!0,c=$.ajax({crossDomain:!0,context:this,type:"get",url:this.mapsrv,data:a,response:"text/xml",async:!0,timeout:this.qtimeout,error:this.onError,success:this.onSuccess}))}};this.onSuccess=function(a){if(null!=c)this.xmlDoc=c.responseText,this.onDataLoad(this.xmlDoc,this.context),this.context=null;
else{"undefined"===typeof a&&"text/xml"===this.contentType&&(this.sender.xmlDoc=this.responseText);if(null!=this.ondataload)this.ondataload(this.responseText,this.sender.context);this.sender.context=null}};this.onError=function(a,b,f){if(null!=c)a=b,b!=f&&0<f.length&&(a+=". "+f+"."),this.xmlDoc=setExceptionResponse(a),this.onDataLoad(this.xmlDoc,this.context),this.context=null;else if(void 0!==typeof this.sender){this.sender.xmlDoc=setExceptionResponse("Request error");if(void 0!=typeof this.ondataload)this.ondataload(this.sender.xmlDoc,
this.sender.context);this.sender.context=null}};this.onTimeout=function(){this.sender.xmlDoc=setExceptionResponse("timeout");if("undefined"!=typeof this.ondataload)b.ondataload(b.sender.xmlDoc,this.sender.context);this.sender.context=null};this.dimentionfeatures=function(a,b){if(null==a)return"";this.context=b;var c;c="object"!=typeof a?$.parseJSON(a):a;if(null==c||null==c.layer||0==c.layer.length||null==c.tilematrixset||0==c.tilematrixset.length)return"";-1==c.tilematrixset.indexOf("urn:ogc:def:wkss:OGC:1.0:")&&
(c.tilematrixset="urn:ogc:def:wkss:OGC:1.0:"+c.tilematrixset);if(null==c.style||0==c.style.length)c.style="default";null==c.format&&(c.format="");if(null==c.tilerow||null==c.tilecol)return"";if(null==c.info_format||""==c.info_format)c.info_format="text/xml";if(isNaN(c.i)||isNaN(c.j))return"";c.REQUEST="GetFeatureInfo";c.SERVICE="WMTS";c.VERSION="1.0.0";this.sendRequest(c);return"1"};this.dimentions=function(a,b,c){this.context=c;if(void 0==b||null==b){if(this.xmlDoc=setExceptionResponse("Request parameters error. Locator=id"),
null!=this.onDataLoad)this.onDataLoad(this.xmlDoc,c)}else c={SERVICE:"WFS",REQUEST:"GetFeature",STOREDQUERY_ID:"urn:ogc:def:query:OGC-WFS::GetFeatureById"},c.ID=b,c.LAYER=a,c.AREA="1",c.LENGTH="1",this.sendRequest(c)};this.area=function(a,b,c){this.context=c;if(void 0==b||null==b){if(this.xmlDoc=setExceptionResponse("Request parameters error. Locator=id"),null!=this.onDataLoad)this.onDataLoad(this.xmlDoc,c)}else c={SERVICE:"WFS",REQUEST:"GetFeature",STOREDQUERY_ID:"urn:ogc:def:query:OGC-WFS::GetFeatureById"},
c.ID=b,c.LAYER=a,c.AREA="1",c.LENGTH="0",c.SEMANTIC="0",c.METRIC="1",this.sendRequest(c)};this.length=function(a,b,c){this.context=c;if(void 0==b||null==b){if(this.xmlDoc=setExceptionResponse("Request parameters error. Locator = id"),null!=this.onDataLoad)this.onDataLoad(this.xmlDoc,c)}else c={SERVICE:"WFS",REQUEST:"GetFeature",STOREDQUERY_ID:"urn:ogc:def:query:OGC-WFS::GetFeatureById"},c.ID=b,void 0!=a&&null!=a&&(c.LAYER=a),c.AREA="0",c.LENGTH="1",c.SEMANTIC="0",c.METRIC="1",this.sendRequest(c)};
this.azimuth=function(a,b,c,g,m,h){this.context=h;var p="";if(void 0==a||null==a)p="layer";else if(void 0==b||null==b)p="point1";else if(void 0==c||null==c)p="point2";else if(void 0==g||null==g)p="crs";if(0!=p.length){if(this.xmlDoc=setExceptionResponse("Request parameters error. Locator = "+p),null!=this.onDataLoad)this.onDataLoad(this.xmlDoc,h)}else h={SERVICE:"WFS",METHOD:"SIDEAZIMUTH"},h.LAYER=a,h.POINT1=[b.x,b.y],h.POINT2=[c.x,c.y],h.CRS=g,h.HANDLE=m,this.sendRequest(h)};this.directionalangle=
function(a,b,c,g,m,h){var p="";if(void 0==a||null==a)p="layer";else if(void 0==b||null==b)p="point1";else if(void 0==c||null==c)p="point2";else if(void 0==g||null==g)p="crs";if(0!=p.length){if(this.xmlDoc=setExceptionResponse("Request parameters error. Locator = "+p),null!=this.onDataLoad)this.onDataLoad(this.xmlDoc,h)}else p={SERVICE:"WFS",METHOD:"SIDEDIRECTION"},p.LAYER=a,p.POINT1=[b.x,b.y],p.POINT2=[c.x,c.y],p.CRS=g,p.HANDLE=m,this.context=h,this.sendRequest(p)};this.mapdistance=function(a,b,c,
g,m,h){this.context=h;var p="";if(void 0==a||null==a)p="layer";else if(void 0==b||null==b)p="point1";else if(void 0==c||null==c)p="point2";else if(void 0==g||null==g)p="crs";if(0!=p.length){if(this.xmlDoc=setExceptionResponse("Request parameters error. Locator = "+p),null!=this.onDataLoad)this.onDataLoad(this.xmlDoc,h)}else h={SERVICE:"WFS",METHOD:"SIDELENGTH"},h.LAYER=a,h.POINT1=[b.x,b.y],h.POINT2=[c.x,c.y],h.CRS=g,h.HANDLE=m,this.sendRequest(h)};this.mappolygoncenter=function(a,b,c){this.context=
c;if(void 0==a||null==a){if(this.xmlDoc=setExceptionResponse("Request parameters error. Locator = Layer"),null!=this.onDataLoad)this.onDataLoad(this.xmlDoc,c)}else if(void 0==b||null==b){if(this.xmlDoc=setExceptionResponse("Request parameters error. Locator=id"),null!=this.onDataLoad)this.onDataLoad(this.xmlDoc,c)}else c={SERVICE:"WFS",REQUEST:"GetFeature",STOREDQUERY_ID:"urn:ogc:def:query:OGC-WFS::GetFeatureById"},c.ID=b,c.LAYER=a,c.OBJCENTER="1",this.sendRequest(c)};this.intersection=function(a,
b,c,g){this.context=g;if(void 0==a||null==a){if(this.xmlDoc=setExceptionResponse("Request parameters error. Locator = Layer"),null!=this.onDataLoad)this.onDataLoad(this.xmlDoc,g)}else if(void 0==b||null==b){if(this.xmlDoc=setExceptionResponse("Request parameters error. Locator=id"),null!=this.onDataLoad)this.onDataLoad(this.xmlDoc,g)}else g={SERVICE:"WFS",METHOD:""},g.METHOD=0==c?"crossline":"crosslinesquare",g.LAYER=a,g.ID=b,this.sendRequest(g)};this.intersectionsquare=function(a,b,c){this.context=
c;if(void 0==a||null==a){if(this.xmlDoc=setExceptionResponse("Request parameters error. Locator = Layer"),null!=this.onDataLoad)this.onDataLoad(this.xmlDoc,c)}else if(void 0==b||null==b){if(this.xmlDoc=setExceptionResponse("Request parameters error. Locator=id"),null!=this.onDataLoad)this.onDataLoad(this.xmlDoc,c)}else c={SERVICE:"WFS",METHOD:"crosssquare"},c.LAYER=a,c.ID=b,this.sendRequest(c)};this.merging=function(a,b,c){this.context=c;if(void 0==typeof a||null==a){if(this.xmlDoc=setExceptionResponse("Request parameters error. Locator = Layer"),
null!=this.onDataLoad)this.onDataLoad(this.xmlDoc,c)}else if(void 0==typeof b||null==b){if(this.xmlDoc=setExceptionResponse("Request parameters error. Locator=id"),null!=this.onDataLoad)this.onDataLoad(this.xmlDoc,c)}else c={SERVICE:"WFS",METHOD:"UNION"},c.LAYER=a,c.ID=b,this.sendRequest(c)};this.spline=function(a,b,c){if(!(void 0==a||null==a||0==a.length)){void 0==typeof b&&(b="smooth");"smooth"!=b&&"bend"!=b&&(b="smooth");var g={SERVICE:"WFS",METHOD:"SPLINEBEND",LAYER:""};"smooth"==b&&(g.METHOD=
"SPLINECASHION");g.LAYER=a;this.postRequest(g,c)}};this.postRequest=function(a,e){if(!(void 0==typeof a||void 0==e)){var f=this.mapsrv+"?",g;for(g in a){var m=a[g];"undefined"!=typeof m&&(f+="&"+g+"="+m)}$.support.cors=!0;if(window.XDomainRequest){if(b=new XDomainRequest)b.timeout=this.qtimeout,b.ontimeout=this.onTimeout,b.onerror=this.onError,b.onload=this.onSuccess,b.ondataload=this.onDataLoad,b.sender=this,b.open("POST",f),b.send(e)}else c=$.ajax({crossDomain:!0,context:this,url:f,processData:!1,
type:"POST",data:e,response:"text/xml",dataType:"xml",success:this.onSuccess,error:this.onError})}};this.areafeature=function(a,b){};this.lengthfeature=function(a,b){};this.distance=function(a,b,c){};this.polygoncenter=function(a,b){}};var hexcase=0,b64pad="",chrsz=8;function hex_md5(a){return binl2hex(core_md5(str2binl(a),a.length*chrsz))}function b64_md5(a){return binl2b64(core_md5(str2binl(a),a.length*chrsz))}function str_md5(a){return binl2str(core_md5(str2binl(a),a.length*chrsz))}function hex_hmac_md5(a,b){return binl2hex(core_hmac_md5(a,b))}function b64_hmac_md5(a,b){return binl2b64(core_hmac_md5(a,b))}function str_hmac_md5(a,b){return binl2str(core_hmac_md5(a,b))}
function md5_vm_test(){return"900150983cd24fb0d6963f7d28e17f72"==hex_md5("abc")}
function core_md5(a,b){a[b>>5]|=128<<b%32;a[(b+64>>>9<<4)+14]=b;for(var c=1732584193,d=-271733879,e=-1732584194,f=271733878,g=0;g<a.length;g+=16)var m=c,h=d,p=e,q=f,c=md5_ff(c,d,e,f,a[g+0],7,-680876936),f=md5_ff(f,c,d,e,a[g+1],12,-389564586),e=md5_ff(e,f,c,d,a[g+2],17,606105819),d=md5_ff(d,e,f,c,a[g+3],22,-1044525330),c=md5_ff(c,d,e,f,a[g+4],7,-176418897),f=md5_ff(f,c,d,e,a[g+5],12,1200080426),e=md5_ff(e,f,c,d,a[g+6],17,-1473231341),d=md5_ff(d,e,f,c,a[g+7],22,-45705983),c=md5_ff(c,d,e,f,a[g+8],7,
1770035416),f=md5_ff(f,c,d,e,a[g+9],12,-1958414417),e=md5_ff(e,f,c,d,a[g+10],17,-42063),d=md5_ff(d,e,f,c,a[g+11],22,-1990404162),c=md5_ff(c,d,e,f,a[g+12],7,1804603682),f=md5_ff(f,c,d,e,a[g+13],12,-40341101),e=md5_ff(e,f,c,d,a[g+14],17,-1502002290),d=md5_ff(d,e,f,c,a[g+15],22,1236535329),c=md5_gg(c,d,e,f,a[g+1],5,-165796510),f=md5_gg(f,c,d,e,a[g+6],9,-1069501632),e=md5_gg(e,f,c,d,a[g+11],14,643717713),d=md5_gg(d,e,f,c,a[g+0],20,-373897302),c=md5_gg(c,d,e,f,a[g+5],5,-701558691),f=md5_gg(f,c,d,e,a[g+
10],9,38016083),e=md5_gg(e,f,c,d,a[g+15],14,-660478335),d=md5_gg(d,e,f,c,a[g+4],20,-405537848),c=md5_gg(c,d,e,f,a[g+9],5,568446438),f=md5_gg(f,c,d,e,a[g+14],9,-1019803690),e=md5_gg(e,f,c,d,a[g+3],14,-187363961),d=md5_gg(d,e,f,c,a[g+8],20,1163531501),c=md5_gg(c,d,e,f,a[g+13],5,-1444681467),f=md5_gg(f,c,d,e,a[g+2],9,-51403784),e=md5_gg(e,f,c,d,a[g+7],14,1735328473),d=md5_gg(d,e,f,c,a[g+12],20,-1926607734),c=md5_hh(c,d,e,f,a[g+5],4,-378558),f=md5_hh(f,c,d,e,a[g+8],11,-2022574463),e=md5_hh(e,f,c,d,a[g+
11],16,1839030562),d=md5_hh(d,e,f,c,a[g+14],23,-35309556),c=md5_hh(c,d,e,f,a[g+1],4,-1530992060),f=md5_hh(f,c,d,e,a[g+4],11,1272893353),e=md5_hh(e,f,c,d,a[g+7],16,-155497632),d=md5_hh(d,e,f,c,a[g+10],23,-1094730640),c=md5_hh(c,d,e,f,a[g+13],4,681279174),f=md5_hh(f,c,d,e,a[g+0],11,-358537222),e=md5_hh(e,f,c,d,a[g+3],16,-722521979),d=md5_hh(d,e,f,c,a[g+6],23,76029189),c=md5_hh(c,d,e,f,a[g+9],4,-640364487),f=md5_hh(f,c,d,e,a[g+12],11,-421815835),e=md5_hh(e,f,c,d,a[g+15],16,530742520),d=md5_hh(d,e,f,
c,a[g+2],23,-995338651),c=md5_ii(c,d,e,f,a[g+0],6,-198630844),f=md5_ii(f,c,d,e,a[g+7],10,1126891415),e=md5_ii(e,f,c,d,a[g+14],15,-1416354905),d=md5_ii(d,e,f,c,a[g+5],21,-57434055),c=md5_ii(c,d,e,f,a[g+12],6,1700485571),f=md5_ii(f,c,d,e,a[g+3],10,-1894986606),e=md5_ii(e,f,c,d,a[g+10],15,-1051523),d=md5_ii(d,e,f,c,a[g+1],21,-2054922799),c=md5_ii(c,d,e,f,a[g+8],6,1873313359),f=md5_ii(f,c,d,e,a[g+15],10,-30611744),e=md5_ii(e,f,c,d,a[g+6],15,-1560198380),d=md5_ii(d,e,f,c,a[g+13],21,1309151649),c=md5_ii(c,
d,e,f,a[g+4],6,-145523070),f=md5_ii(f,c,d,e,a[g+11],10,-1120210379),e=md5_ii(e,f,c,d,a[g+2],15,718787259),d=md5_ii(d,e,f,c,a[g+9],21,-343485551),c=safe_add(c,m),d=safe_add(d,h),e=safe_add(e,p),f=safe_add(f,q);return[c,d,e,f]}function md5_cmn(a,b,c,d,e,f){return safe_add(bit_rol(safe_add(safe_add(b,a),safe_add(d,f)),e),c)}function md5_ff(a,b,c,d,e,f,g){return md5_cmn(b&c|~b&d,a,b,e,f,g)}function md5_gg(a,b,c,d,e,f,g){return md5_cmn(b&d|c&~d,a,b,e,f,g)}
function md5_hh(a,b,c,d,e,f,g){return md5_cmn(b^c^d,a,b,e,f,g)}function md5_ii(a,b,c,d,e,f,g){return md5_cmn(c^(b|~d),a,b,e,f,g)}function core_hmac_md5(a,b){var c=str2binl(a);16<c.length&&(c=core_md5(c,a.length*chrsz));for(var d=Array(16),e=Array(16),f=0;16>f;f++)d[f]=c[f]^909522486,e[f]=c[f]^1549556828;c=core_md5(d.concat(str2binl(b)),512+b.length*chrsz);return core_md5(e.concat(c),640)}function safe_add(a,b){var c=(a&65535)+(b&65535);return(a>>16)+(b>>16)+(c>>16)<<16|c&65535}
function bit_rol(a,b){return a<<b|a>>>32-b}function str2binl(a){for(var b=[],c=(1<<chrsz)-1,d=0;d<a.length*chrsz;d+=chrsz)b[d>>5]|=(a.charCodeAt(d/chrsz)&c)<<d%32;return b}function binl2str(a){for(var b="",c=(1<<chrsz)-1,d=0;d<32*a.length;d+=chrsz)b+=String.fromCharCode(a[d>>5]>>>d%32&c);return b}function binl2hex(a){for(var b=hexcase?"0123456789ABCDEF":"0123456789abcdef",c="",d=0;d<4*a.length;d++)c+=b.charAt(a[d>>2]>>8*(d%4)+4&15)+b.charAt(a[d>>2]>>8*(d%4)&15);return c}
function binl2b64(a){for(var b="",c=0;c<4*a.length;c+=3)for(var d=(a[c>>2]>>8*(c%4)&255)<<16|(a[c+1>>2]>>8*((c+1)%4)&255)<<8|a[c+2>>2]>>8*((c+2)%4)&255,e=0;4>e;e++)b=8*c+6*e>32*a.length?b+b64pad:b+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(d>>6*(3-e)&63);return b};window.GWTK&&(GWTK.placemark.prototype.onmouseover=function(a){},GWTK.placemark.prototype.onmouseout=function(a){},GWTK.ruler=function(a){null!=a&&(this.map=a,this.rulerPane,this.rulerPaneLines=null,this.distance=this.rulerlength=0,this.points=[],this._cookieKey=GWTK.cookies.getKey()+"_ruler",this.initialize())},GWTK.ruler.prototype={initialize:function(){if(!1==this.map instanceof GWTK.Map)return this;var a=this.map.overlayPane,b=$(a).find(".ruler-panel");0<b.length?this.canvas?this._createCanvas():
$(b[0]).empty():(this.rulerPane=GWTK.DomUtil.create("div","ruler-panel",a),this.rulerPane.id="rulerPane"+GWTK.Util.randomInt(1,1E4),this._createCanvas(),a.appendChild(this.rulerPane))},_createCanvas:function(){if(0<$(this.rulerPane).find("#canvas_ruler").length)this.canvas.getContext("2d").clearRect(0,0,this.canvas.width,this.canvas.height);else{var a=document.createElement("canvas");void 0!=a.getContext&&(a.id="canvas_ruler",a.className="ruler-line",this.canvas=a,this.rulerPane.appendChild(this.canvas),
a=this.map.getWindowSize(),this.canvas.width=a[0],this.canvas.height=a[1])}},addPoint:function(a,b){var c=GWTK.DomEvent.getMousePosition(a,GWTK.maphandlers.map.panes.eventPane),c=GWTK.maphandlers.map.tiles.getLayersPointProjected(c),d=GWTK.projection.xy2geo(GWTK.maphandlers.map.options.crs,c.y,c.x),e=GWTK.DomEvent.getMousePosition(a,this.rulerPane),f="",c=null;if(0<this.points.length){var c=this.points[this.points.length-1],f=this._distanceTo(c.latlong,d),f=this.points.length+1+") "+f,g=this.points[this.points.length-
1].geopoint(),m=$(".ruler-point-hint");0!=m.length&&g.removeChild(m[0])}else f="1) 0 m",this.distance=0;d=this._setRulerMark(e,d,f);this.points.push(d);2==this.points.length&&this.setupCanvas();c&&(c=this.getCanvasPosition(c.origin.clone()),d=this.getCanvasPosition(d.origin.clone()),GWTK.Util.drawLineWithIdToDiv(c,d,"line"+this.points.length,this.rulerPane,this.canvas));this._writeCookie()},_writeCookie:function(){var a=this.getPathCoord();0<a.length&&GWTK.cookie(this._cookieKey,a,{expires:1,path:"/"})},
_setRulerMark:function(a,b,c){if(null==b||void 0==b)return null;b=new GWTK.placemark(b,"",c,GWTK.imgRedPoint);b.img.className="placemark-img-size-small";b.setSize([10,10]);b.position(a);a=b.geopoint();a.title=c;this.setPointHint(a);this.rulerPane.appendChild(a);return b},_distanceTo:function(a,b){if(!1==a instanceof GWTK.LatLng)return"";var c=GWTK.toLatLng(b);this.distance=c=a.distanceTo(c)+this.distance;1E3<=c?c=(c/1E3).toFixed(2)+" km":c=c.toFixed(2)+" m";return c},pathEnabled:function(){return 0<
this.rulerPane.childNodes.length},removePath:function(a){GWTK.removeCookie(a);this.clear();this.activate()},clear:function(){$(this.rulerPane).empty();this.points.splice(0,this.points.length);this.initialize()},destroy:function(){this.inactivate();this.clear();GWTK.maphandlers.path_point_click=function(a){}},getPathCoord:function(){if(0==this.points.length)return[];var a=[],b,c=this.points.length;for(b=0;b<c;b++)a[b]=this.points[b].latlong.toString(6);return a.join(",")},refresh:function(){if(0!=
this.points.length){var a,b=this.points.length;for(a=0;a<b;a++){var c=GWTK.tileView.geo2pixelOffset(this.map,this.points[a].latlong);this.points[a].position(c)}a=$(this.rulerPane).find(".ruler-line-msie");if(0!=a.length&&this.rulerPane.childNodes.length)for(b=0;b<a.length;b++)this.rulerPane.removeChild(a[b]);this._drawPath();this.inactivate();$(this.rulerPane).fadeIn("slow",function(){})}},inactivate:function(){this.canvas&&($(this.canvas).off(),$(this.canvas).on("click",GWTK.maphandlers.mapclick),
$(this.canvas).on("mousewheel DOMMouseScroll wheel MozMousePixelScroll",GWTK.maphandlers.mousewheelscaling),$(this.canvas).on("mousedown",GWTK.maphandlers.mapmousedown),$(this.canvas).on("mouseup",GWTK.maphandlers.mapmouseup),$(this.canvas).on("mousemove",GWTK.maphandlers.mapmove),$(this.canvas).on("mouseout",GWTK.maphandlers.mouseout))},activate:function(){this.canvas&&($(this.canvas).off(),$(this.canvas).on("click",GWTK.maphandlers.path_point_click))},getCanvasPosition:function(a){if(!this.canvas)return a;
var b=this.canvas,c=b.getBoundingClientRect(),d=GWTK.maphandlers.map.container.getBoundingClientRect();return new GWTK.Point(Math.floor(a.x-c.left-b.clientLeft+d.left),Math.floor(a.y-c.top-b.clientTop+d.top))},setPointHint:function(a){var b=GWTK.DomUtil.create("div","ruler-point-hint ui-widget-content",a);b.innerHTML='<span style="color:Gray;">'+a.title+'</span>&nbsp;<img class="ruler-point-close" title="\u0423\u0434\u0430\u043b\u0438\u0442\u044c \u043f\u0443\u0442\u044c" src="'+GWTK.imgClose+'" align="absmiddle" onclick="javascript: GWTK.maphandlers.ruler_removePath();"></img>';
$(b).draggable({distance:5})},_drawPath:function(){if(this.points&&!(2>this.points.length)){this._createCanvas();this.canvas&&(this.canvas.getContext("2d").clearRect(0,0,this.canvas.width,this.canvas.height),this.setupCanvas());for(var a=this.points.length-1,b=0;b<a;b++){var c=this.points[b].origin.clone(),d=this.points[b+1].origin.clone();this.canvas&&(c=this.getCanvasPosition(c),d=this.getCanvasPosition(d));GWTK.Util.drawLineWithIdToDiv(c,d,"line"+b,this.rulerPane,this.canvas)}}},restore:function(a){this.points.splice(0,
this.points.length);a=this.parseCoord(a);if(null!=a){$(this.rulerPane).empty();var b="1) 0 m";for(this.distance=0;0<a.length;){var c=0<a.length?a.shift():null;if(null==c)break;0<this.points.length&&(b=this._distanceTo(this.points[this.points.length-1].latlong,c),b=this.points.length+1+") "+b);var c=new GWTK.placemark(c,"",b,GWTK.imgRedPoint),d=GWTK.tileView.geo2pixelOffset(this.map,c.latlong);c.img.className="placemark-img-size-small";c.setSize([10,10]);c.geopoint().title=b;c.position(d);this.rulerPane.appendChild(c.geopoint());
this.points.push(c)}1>=this.points.length||(this.setPointHint(this.points[this.points.length-1].geopoint()),this._drawPath(),this.inactivate())}},getRulerBounds:function(){if(1>=this.points.length)return{};for(var a=this.points[0].vertex.clone(),b=this.points[1].vertex.clone(),c=0;c<this.points.length;c++)a.x=Math.min(a.x,this.points[c].vertex.x),a.y=Math.min(a.y,this.points[c].vertex.y),b.x=Math.max(b.x,this.points[c].vertex.x),b.y=Math.max(b.y,this.points[c].vertex.y);a.x-=10;a.y-=10;c=GWTK.maphandlers.map.getWindowSize();
a.x=Math.min(a.x,0);a.y=Math.min(a.y,0);b.x=Math.max(b.x,c[0]);b.y=Math.max(b.y,c[1]);c=Math.abs(b.x-a.x)+10;b=Math.abs(b.y-a.y)+10;return{top:a.y,left:a.x,width:c,height:b}},setupCanvas:function(){if(this.canvas&&void 0!=this.canvas.getContext){var a=this.getRulerBounds();this.canvas.style.left=a.left+"px";this.canvas.style.top=a.top+"px";this.canvas.width=a.width;this.canvas.height=a.height}},parseCoord:function(a){if(!a||null==a||0==a.length)return null;a=a.split(",");if(2>a.length)return null;
for(var b=[];0<a.length;){var c=[a.shift(),0<a.length?a.shift():null];if(null==c[0]||null==c[1])break;b.push(c)}return b}});window.GWTK&&(GWTK.polygon=function(a){var b=new GWTK.ruler(a);b.rulerPane||(b.rulerPane=GWTK.DomUtil.create("div","ruler-panel",a.overlayPane),b.rulerPane.id="rulerPane"+GWTK.Util.randomInt(1,1E4),b._createCanvas(),a.overlayPane.appendChild(b.rulerPane));$(b.rulerPane).attr("polygonarea",1);b._area=0;b._cookieKey=GWTK.cookies.getKey()+"_polyarea";b.addPolygonPoint=function(a){3<=this.points.length?this.removeLastSegment():2==this.points.length&&(this._createTempCanvas(),this.copyImage(this.canvasCopy,
this.canvas));this.addPoint(a);this.drawLastSegment(this.canvasCopy);this.points[this.points.length-1].geopoint();$(".ruler-point-hint");3>this.points.length||(this.closeline(),this.getArea())};b.setPolygonHint=function(a){a.title="";var b=GWTK.DomUtil.create("div","ruler-point-hint ui-widget-content",a);2>this.points.length?$(b).html('<span class="control-hint-grey"></span>&nbsp;<img class="ruler-point-close" title="\u0423\u0434\u0430\u043b\u0438\u0442\u044c" src="'+GWTK.imgClose+'" align="absmiddle" ></img>'):
($(a).click(function(){GWTK.maphandlers.map.polygonArea.getArea()}),$(b).html('<span class="control-hint-grey"> S = ? </span>&nbsp;<img class="ruler-point-close" title="\u0423\u0434\u0430\u043b\u0438\u0442\u044c" src="'+GWTK.imgClose+'" align="absmiddle" ></img>'));$(b).find(".ruler-point-close").click(function(){GWTK.maphandlers.map.polygonArea.removePath(GWTK.maphandlers.map.polygonArea._cookieKey)})};b.setPointHint=function(a){this.setPolygonHint(a)};b.destroy=function(){var a=$(GWTK.maphandlers.map.overlayPane).find(".ruler-panel"),
b;for(b=0;b<a.length;b++)$(a[b]).attr("polygonarea")&&(this.inactivate(),$(a[b]).empty(),this.points.splice(0,this.points.length),this.initialize(),GWTK.maphandlers.map.overlayPane.removeChild(a[b]))};var c=b.refresh;b.refresh=function(){c.call(this);this.drawLastSegment(this.canvas);this._createTempCanvas();this.copyImage(this.canvasCopy,this.canvas);this.closeline()};b._createTempCanvas=function(){if(0<$(this.rulerPane).find("#canvas_ruler_copy").length)this.canvasCopy.getContext("2d").clearRect(0,
0,this.canvasCopy.width,this.canvasCopy.height);else{var a=document.createElement("canvas");void 0!=a.getContext&&(a.id="canvas_ruler_copy",a.className="ruler-line",this.canvasCopy=a,this.rulerPane.appendChild(this.canvasCopy),this.canvasCopy.width=this.canvas.width,this.canvasCopy.height=this.canvas.height,$(this.canvasCopy).hide())}};b.area=function(){return _area};b.getArea=function(){var a=this.points.length;if(3>a)return!1;var c=b.getPathCoord(),a=c.split(",");a.push(a[0]);a.push(a[1]);c=a.join(" ");
a=this.points.length+1;a='<?xml version="1.0" encoding="utf-8"?><wfs:FeatureCollection version="2.0.0" xmlns:bsd="http://www.gisinfo.net/bsd" xmlns:wfs="http://www.opengis.net/wfs/2.0" xmlns:fes="http://www.opengis.net/fes/2.0"  xmlns:gml="http://www.opengis.net/gml/3.2.1" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://www.gisinfo.net/bsd http://www.gisinfo.net/bsd/topomap.xsd http://www.opengis.net/wfs/2.0 http://schemas.opengis.net/wfs/2.0.0/wfs.xsd http://www.opengis.net/gml/3.2 http://www.opengis.net/gml/3.2.1/gml.xsd" timeStamp="25.06.2015 16:20:32" numberMatched="1" numberReturned="1"><wfs:member><gml:Value><gml:Polygon srsName="urn:ogc:def:crs:EPSG:4326"><gml:exterior><gml:LineString><gml:posList srsDimension="2" count="'+
a+'">'+c+"</gml:posList></gml:LineString></gml:exterior></gml:Polygon></gml:Value></wfs:member></wfs:FeatureCollection>";c=GWTK.maphandlers.map.tiles.getSelectableLayers();c=c.split(",");c=c[0];this.wfsQuery.areafeature(c,a)};b.areaResponse=function(a,b){var c=$.parseXML(a),g=$(c).context.documentElement,c=$(g).find("ObjectCenter");$(c).text();$(g).find("Length");var m,c=" m\u00b2";m=$(g).find("Area");g=$(".control-hint-grey");0!=g.length&&0!=m.length&&(m=$(m).text(),m=parseFloat(m),1E6<m&&(m/=1E6,
c=" km\u00b2"),m=w2utils.formatNumber(Number(m).toFixed(3)," ")+c,$(g[0]).text(" S = "+m))};b.wfsQuery=new WfsQueries(a.options.url,a);b.wfsQuery.onDataLoad=b.areaResponse;b.drawLastSegment=function(a){if(a&&a.getContext){var b=this.points.length;a=a.getContext("2d");if(!(3>b)){var c=this.points[b-2],b=this.getCanvasPosition(this.points[b-1].origin.clone()),g=this.getCanvasPosition(c.origin.clone()),c=parseInt(g.x,10),g=parseInt(g.y,10),m=parseInt(b.x,10),b=parseInt(b.y,10);a.lineWidth=2;a.strokeStyle=
"rgba(255, 0, 0, 0.8)";a.beginPath();a.moveTo(m,b);a.lineTo(c,g);a.stroke()}}};b.closeline=function(){if(!(3>this.points.length)){var a=this.points[0],b=this.points[this.points.length-1];a&&b&&(b=this.getCanvasPosition(b.origin.clone()),a=this.getCanvasPosition(a.origin.clone()),GWTK.Util.drawLineWithIdToDiv(b,a,"line"+this.points.length,this.rulerPane,this.canvas))}};b.copyImage=function(a,b){if(a&&b&&void 0!=a.getContext){var c=a.getContext("2d");c.clearRect(0,0,a.width,a.height);c.drawImage(b,
0,0)}};b.removeLastSegment=function(){if(!(3>this.points.length))if(this.canvas&&void 0!=this.canvas.getContext)this.copyImage(this.canvas,this.canvasCopy);else{var a=$(this.rulerPane).find(".ruler-line-msie"),b=a.length;0<b&&this.rulerPane.removeChild(a[b-1])}};b.constructor=arguments.callee;return b});if(window.GWTK){var touchCoordClass=function(){this.l=this.y=this.x=0},multiTouch=[],touchVarsClass=function(){this.maximumTargets=2;this.originalCenter=new touchCoordClass;this.currentCenter=new touchCoordClass;this.dy=this.dx=this.y0=this.x0=this.y=this.x=0;this.zoom=1;this.noZoomOut=this.noZoomIn=!1;this.shiftTop=this.shiftLeft=0},touchVars=new touchVarsClass;GWTK.Handlers=function(a){this.map=a;this.y=this.x=0;this.dragend=this.dragstart=!1;this.movedrag=new GWTK.MapDragData;this.dsize=25};GWTK.Handlers.prototype=
{mapclick:function(a){a||(a=window.event);if(!0==GWTK.maphandlers.movedrag.drag)return GWTK.movedrag().init(),a.preventDefault(),GWTK.maphandlers.map._writeCookie(),!1;$(this).off("mousemove",GWTK.maphandlers.mapdrag);GWTK.maphandlers.map.placemarkRemove();var b=GWTK.DomEvent.getMousePosition(a,GWTK.maphandlers.map.panes.eventPane),c=GWTK.maphandlers.map.tiles.getLayersPointProjected(b),d=GWTK.projection.xy2geo(GWTK.maphandlers.map.options.crs,c.y,c.x),e=GWTK.DomEvent.getMousePosition(a,GWTK.maphandlers.map.panes.overlayPane);
GWTK.maphandlers.map.overlayAppend(d,e,!1);GWTK.maphandlers.iseditorAction()||GWTK.maphandlers.map.getFeatureInfo(b);GWTK.maphandlers.map.overlayPane&&$(GWTK.maphandlers.map.overlayPane).trigger({type:"mapclick",point:b,coord:c,geo:d});a.preventDefault();a.stopPropagation();return!1},_scalecallback:function(){setTimeout(function(){$(GWTK.maphandlers.map.mapPane).removeAttr("style").hide().fadeIn().addClass("map-pane")},1500)},mousewheelscaling:function(a){a||(a=window.event);var b=GWTK.maphandlers.map,
c=GWTK.DomEvent.getMousePosition(a,b.panes.eventPane),d=GWTK.DomEvent.getWheelDelta(a);b.zooming(d,c);a.preventDefault();a.stopPropagation();a.returnValue=!1},mapmousedown:function(a){if(!(a.shiftKey||1!==a.which&&1!==a.button&&!a.touches)){a.stopPropagation();var b=GWTK.movedrag();b.init();b.dragstart=!0;b.x_prev=a.clientX;b.y_prev=a.clientY;GWTK.maphandlers.map.tiles._onMouseDown(a);GWTK.DomUtil.addClass(GWTK.maphandlers.map.eventPane,"cursor-dragging")}},mapmouseup:function(a){GWTK.DomUtil.removeClass(GWTK.maphandlers.map.eventPane,
"cursor-dragging");$(GWTK.maphandlers.map.eventPane).css("cursor","default");var b=GWTK.maphandlers.map;if(null!=GWTK.movedrag()){if(GWTK.movedrag().isDragEnabled()){GWTK.maphandlers.mapdrag(a);$(this).off("mousemove",GWTK.maphandlers.mapdrag);var c=b.tiles.getLayersCenterProjected();null!=c&&b.setMapCenter(c);GWTK.movedrag().init();GWTK.maphandlers.movedrag.drag=!0;b.overlayRefresh();b.tiles.drawWmsLayers()}else GWTK.movedrag().init();a.stopPropagation();a.preventDefault();return!1}},mapmove:function(a){GWTK.DomEvent.getMouseGeoCoordinates(a);
if(GWTK.movedrag().isDragEnabled()||!GWTK.movedrag().dragstart)return!1;GWTK.movedrag().setDrag(a);if(GWTK.movedrag().isDragEnabled())return $(this).on("mousemove",GWTK.maphandlers.mapdrag),!1},mapdrag:function(a){if(void 0==GWTK.maphandlers)return!1;var b=GWTK.movedrag();if(!b.isDragEnabled())return!1;b.setOffset(a);a=GWTK.maphandlers.map;a.move(b.dx,b.dy);a.tiles._onMouseMove(b.dx,b.dy)},mouseout:function(a){if(!GWTK.movedrag().isDragEnabled())return!1;GWTK.maphandlers.mapmouseup(a);GWTK.maphandlers.movedrag.drag=
!1;a.preventDefault()},zoominclick:function(a){null!=GWTK.maphandlers.map&&GWTK.maphandlers.map.zoomIn();return!1},zoomoutclick:function(a){null!=GWTK.maphandlers.map&&GWTK.maphandlers.map.zoomOut();return!1},layer_visible:function(a){var b=a.currentTarget;if(!b)if(a.srcElement)b=a.srcElement;else return!1;a=!1;for(var c=0;c<GWTK.maphandlers.map.layers.length;c++)if(null!=GWTK.maphandlers.map.layers[c]&&GWTK.maphandlers.map.layers[c].xId==b.value){GWTK.maphandlers.map.layers[c].visible?GWTK.maphandlers.map.layers[c].hide():
GWTK.maphandlers.map.layers[c].show();a=GWTK.maphandlers.map.layers[c].visible;break}a?GWTK.maphandlers.map.tiles.forceupdate():GWTK.maphandlers.map.tiles.wmsUpdate();GWTK.maphandlers.map._writeCookie()},mapresize:function(a){if(null!=GWTK.maphandlers.map){var b=$(GWTK.maphandlers.map.container).width(),c=$(GWTK.maphandlers.map.container).height();GWTK.maphandlers.map.getWindowSize();GWTK.maphandlers.map.setWindowSize(b,c);GWTK.maphandlers.map.tiles.scaleChange=!0;GWTK.maphandlers.map.tilePane.className=
"tile-panel";GWTK.maphandlers.map.showMap();GWTK.maphandlers.map.overlayRefresh()}a.preventDefault();return!1},panel_mousedown:function(a){this.x=a.clientX;this.y=a.clientY},panel_mouseup:function(a){this.y=this.x=0;a.preventDefault();return!1},panel_move:function(a){var b=a.currentTarget;if(!b||!this.x||!this.y)return!1;var c=a.clientX-this.x,d=a.clientY-this.y;if(4>c&&4>d)return!1;var e=$(b).offset();e.left+=c;e.top+=d;$(b).offset(e);this.x=a.clientX;this.y=a.clientY;a.preventDefault();return!1},
panel_mouseout:function(a){(0!=this.x||0!=this.y)&&GWTK.maphandlers.panel_mouseup(a);a.preventDefault()},transition_end:function(a){$(GWTK.maphandlers.map.tilePane).removeClass("transition_panel")},ruler_button_click:function(a){$(a.currentTarget).hasClass("control-button-active")?($(a.currentTarget).removeClass("control-button-active"),$(GWTK.maphandlers.map.panes.eventPane).on("click",GWTK.maphandlers.mapclick),$(GWTK.maphandlers.map.panes.eventPane).off("click",GWTK.maphandlers.path_point_click),
GWTK.maphandlers.path_point_click=function(a){},GWTK.maphandlers.map.ruler.inactivate(),$(GWTK.maphandlers.map.ruler.rulerPane).on("touchstart",GWTK.maphandlers.touchStart),$(GWTK.maphandlers.map.ruler.rulerPane).on("touchmove",GWTK.maphandlers.touchMove),$(GWTK.maphandlers.map.ruler.rulerPane).on("touchend",GWTK.maphandlers.touchEnd)):(GWTK.maphandlers.clearAction(),GWTK.maphandlers.map.createRuler(),GWTK.maphandlers.path_point_click=function(a){if(GWTK.maphandlers.movedrag.drag)return!1;GWTK.maphandlers.map.ruler.addPoint(a)},
$(a.currentTarget).addClass("control-button-active"),$(GWTK.maphandlers.map.panes.eventPane).off("click",GWTK.maphandlers.mapclick),$(GWTK.maphandlers.map.panes.eventPane).on("click",GWTK.maphandlers.path_point_click),GWTK.maphandlers.map._readCookieOverlays(),GWTK.maphandlers.map.ruler.activate(),$(GWTK.maphandlers.map.ruler.rulerPane).off("touchstart",GWTK.maphandlers.touchStart),$(GWTK.maphandlers.map.ruler.rulerPane).off("touchmove",GWTK.maphandlers.touchMove),$(GWTK.maphandlers.map.ruler.rulerPane).off("touchend",
GWTK.maphandlers.touchEnd))},ruler_removePath:function(a){a=GWTK.maphandlers.map;GWTK.removeCookie(GWTK.rulercookiename());if(null==a.ruler)return!1;a.removePathRuler()},ruler_point_click:function(a){a.preventDefault();if(GWTK.maphandlers.movedrag.drag)return!1;var b=GWTK.maphandlers.map;if(null==b.ruler)return!1;b.ruler.addPoint(a)},path_point_click:function(a){GWTK.maphandlers.map.ruler&&GWTK.maphandlers.map.ruler.addPoint(a)},polygonArea_button_click:function(a){$(a.currentTarget).hasClass("control-button-active")?
($(a.currentTarget).removeClass("control-button-active"),$(GWTK.maphandlers.map.panes.eventPane).on("click",GWTK.maphandlers.mapclick),$(GWTK.maphandlers.map.panes.eventPane).off("click",GWTK.maphandlers.path_point_click),GWTK.maphandlers.map.polygonArea&&(GWTK.maphandlers.map.polygonArea.destroy(),GWTK.maphandlers.map.polygonArea=null),GWTK.maphandlers.map._readCookieOverlays()):(GWTK.maphandlers.clearAction(),GWTK.maphandlers.map.polygonArea=new GWTK.polygon(GWTK.maphandlers.map),GWTK.maphandlers.path_point_click=
function(a){if(GWTK.maphandlers.movedrag.drag)return!1;GWTK.maphandlers.map.polygonArea.addPolygonPoint(a)},$(a.currentTarget).addClass("control-button-active"),$(GWTK.maphandlers.map.panes.eventPane).off("click",GWTK.maphandlers.mapclick),$(GWTK.maphandlers.map.panes.eventPane).on("click",GWTK.maphandlers.path_point_click),GWTK.maphandlers.map.polygonArea.activate(),$(GWTK.maphandlers.map.polygonArea.rulerPane).off("touchstart",GWTK.maphandlers.touchStart),$(GWTK.maphandlers.map.polygonArea.rulerPane).off("touchmove",
GWTK.maphandlers.touchMove),$(GWTK.maphandlers.map.polygonArea.rulerPane).off("touchend",GWTK.maphandlers.touchEnd))},objectsPane_close_click:function(a){a=GWTK.maphandlers.map;$(a.objectsPane).fadeOut("slow",function(){});a.placemarkRemove();GWTK.Util.clearselectedFeatures()},touchStart:function(a){a.preventDefault();var b=document.getElementById(GWTK.maphandlers.map.divID);multiTouch=[];touchVars=new touchVarsClass;touchVars.x=parseInt(b.style.left,10);isNaN(touchVars.x)&&(touchVars.x=0);touchVars.y=
parseInt(b.style.top,10);isNaN(touchVars.y)&&(touchVars.y=0);b=GWTK.Util.uiFindPos(b);touchVars.x0=b[0]+touchVars.x;touchVars.y0=b[1]+touchVars.y;for(b=0;b<a.targetTouches.length&&!(multiTouch[b]=new touchCoordClass,multiTouch[b].x=a.targetTouches[b].pageX-touchVars.x0,multiTouch[b].y=a.targetTouches[b].pageY-touchVars.y0,0<b&&(multiTouch[b].l=GWTK.Util.getLengthEx(multiTouch[b-1].x,multiTouch[b-1].y,multiTouch[b].x,multiTouch[b].y)),b>=touchVars.maximumTargets-1);b++);null!=multiTouch[1]&&(touchVars.originalCenter.x=
parseInt((multiTouch[0].x+multiTouch[1].x)/2,10),touchVars.originalCenter.y=parseInt((multiTouch[0].y+multiTouch[1].y)/2,10),touchVars.originalCenter.l=multiTouch[1].l);GWTK.maphandlers.fireMouseEvent(a);return!1},touchMove:function(a){a.preventDefault();for(var b,c,d=0;d<a.targetTouches.length&&!(b=a.targetTouches[d].pageX-touchVars.x0-multiTouch[d].x,c=a.targetTouches[d].pageY-touchVars.y0-multiTouch[d].y,multiTouch[d].x+=b,multiTouch[d].y+=c,0<d&&(multiTouch[d].l=GWTK.Util.getLengthEx(multiTouch[d-
1].x,multiTouch[d-1].y,multiTouch[d].x,multiTouch[d].y)),d>=touchVars.maximumTargets-1);d++);if(2<=a.targetTouches.length)return touchVars.currentCenter.x=parseInt((multiTouch[0].x+multiTouch[1].x)/2,10),touchVars.currentCenter.y=parseInt((multiTouch[0].y+multiTouch[1].y)/2,10),touchVars.currentCenter.l=multiTouch[1].l,touchVars.zoom=touchVars.currentCenter.l/touchVars.originalCenter.l,1<touchVars.zoom&&touchVars.noZoomIn&&(touchVars.zoom=1,touchVars.originalCenter.l=touchVars.currentCenter.l),1>
touchVars.zoom&&touchVars.noZoomOut&&(touchVars.zoom=1,touchVars.originalCenter.l=touchVars.currentCenter.l),touchVars.dx=parseInt(touchVars.currentCenter.x-touchVars.originalCenter.x*touchVars.zoom),touchVars.dy=parseInt(touchVars.currentCenter.y-touchVars.originalCenter.y*touchVars.zoom),GWTK.Util.setMapPanelScale(touchVars.dx,touchVars.dy,touchVars.zoom),!1;touchVars.shiftLeft=b;touchVars.shiftTop=c;GWTK.maphandlers.fireMouseEvent(a);return!1},touchEnd:function(a){a.preventDefault();if("undefined"!=
typeof multiTouch[1])return GWTK.maphandlers.zoomByTouch(a),!1;GWTK.maphandlers.fireMouseEvent(a);return!1},zoomByTouch:function(a){1<touchVars.zoom?(delta=Math.round(touchVars.zoom/2),GWTK.maphandlers.map.zoomIn(delta)):(delta=Math.round(1/touchVars.zoom-1),GWTK.maphandlers.map.zoomOut(delta));GWTK.Util.setMapPanelScale(touchVars.dx,touchVars.dy,0);ep=document.getElementById(GWTK.maphandlers.map.divID);ep.onmouseup(a)},mouseCoords:function(a){return ev.pageX||ev.pageY?{x:ev.pageX,y:ev.pageY}:{x:ev.clientX+
document.documentElement.scrollLeft,y:ev.clientY+document.documentElement.scrollTop}},fireMouseEvent:function(a){var b=a.changedTouches[0],c="";switch(a.type){case "touchstart":c="mousedown";break;case "touchmove":c="mousemove";break;case "touchend":c="click";break;default:return}var d=document.createEvent("MouseEvent");d.initMouseEvent(c,!0,!0,window,1,b.screenX,b.screenY,b.clientX,b.clientY,!1,!1,!1,!1,0,null);b.target.dispatchEvent(d);a.preventDefault()},toggle_textsearchinmap:function(a,b){if(!(void 0===
a||null===a)){var c=$("#inputSearchButton");c.removeClass("hide");GWTK.maphandlers.map.overlayClear();if(a)$(c).off("click"),$(c).on("click",GWTK.maphandlers.textsearchinmap_click),GWTK.maphandlers.ontextsearch_next=GWTK.maphandlers.map.mapTextSearch.textSearchNext,GWTK.maphandlers.ontextsearch_prev=GWTK.maphandlers.map.mapTextSearch.textSearchPrev;else if($(c).off("click",GWTK.maphandlers.textsearchinmap_click),null!==b)$(c).on("click",b)}},featurelist_click:function(a){var b=a.target||a.srcElement;
if(!1==$(b).hasClass("panel-info-img-search"))return!1;var c=$(GWTK.maphandlers.map.objectsPane).attr("objselect");$(GWTK.maphandlers.map.objectsPane).removeAttr("objselect");var d=$(b).attr("objId"),e=GWTK.maphandlers.map.tiles.getLayerByGmlId(d);if(e&&(e=e.options.id)&&d){if(GWTK.maphandlers.iseditorAction(e,d))return a.preventDefault(),a.stopPropagation(),!1;GWTK.featureSearch.selectedFeatures.drawcontourById(e,d,!1,!0);GWTK.maphandlers.map.overlayPane&&$(GWTK.maphandlers.map.overlayPane).trigger({type:"featurelistclick",
layer:e,gid:d})}d=GWTK.maphandlers.map.placemarks;if(0==d.length)return!1;for(var e=null,f=!1,g=0;g<d.length;g++)if(b.id!=d[g].id)!f&&(c==d[g].id&&!f)&&(d[g].setImage(null,!0),f=!0);else if(d[g].setImage(null,!1),$(GWTK.maphandlers.map.objectsPane).attr("objselect",b.id),e=d[g].latlong,f)break;null!=e&&(GWTK.maphandlers.map.setViewport(e),GWTK.maphandlers.map.overlayRefresh());a.preventDefault();a.stopPropagation();return!1},textsearchinmap_click:function(a){a=$("#inputSearchText").val();if(void 0===
a||0===a.length)return!1;GWTK.maphandlers.ontextsearch_next=GWTK.maphandlers.map.mapTextSearch.textSearchNext;GWTK.maphandlers.ontextsearch_prev=GWTK.maphandlers.map.mapTextSearch.textSearchPrev;GWTK.maphandlers.map.mapTextSearch.textSearchStarting(a,0)},textsearch_prev_click:function(a){if(!1!=$(a.target||a.srcElement).hasClass("panel-pagination-button-left"))return GWTK.maphandlers.ontextsearch_prev(),a.preventDefault(),a.stopPropagation(),!1},textsearch_next_click:function(a){if(!1!=$(a.target||
a.srcElement).hasClass("panel-pagination-button-right"))return GWTK.maphandlers.ontextsearch_next(),a.preventDefault(),a.stopPropagation(),!1},ontextsearch_next:function(){},ontextsearch_prev:function(){},getevents:function(a){var b=[],c;(c=jQuery._data(a,"events"))&&b.push({element:a,events:c});return 0<b.length?b:null},clearAction:function(){for(var a=$(GWTK.maphandlers.map.panes.toolbarPane).find(".control-button"),b=!1,c=0;c<a.length;c++)$(a[c]).hasClass("control-button-radio")&&$(a[c]).hasClass("control-button-active")&&
($(a[c]).removeClass("control-button-active"),b=!0);if(b){$(GWTK.maphandlers.map.panes.eventPane).off("click",GWTK.maphandlers.path_point_click);$(GWTK.maphandlers.map.panes.eventPane).off("click",GWTK.maphandlers.ruler_point_click);$(GWTK.maphandlers.map.panes.eventPane).off("click",GWTK.maphandlers.mapclick);$(GWTK.maphandlers.map.panes.eventPane).on("click",GWTK.maphandlers.mapclick);if(a=GWTK.maphandlers.map.mapTool("selectAreaRect"))a.clearRectImage(),a.clear();GWTK.maphandlers.map.polygonArea&&
(GWTK.maphandlers.map.polygonArea.destroy(),GWTK.maphandlers.map.polygonArea=null);GWTK.maphandlers.map._readCookieOverlays()}},selectAreaRect_button_click:function(a){var b=GWTK.maphandlers.map.mapTool("selectAreaRect");null==b&&(GWTK.maphandlers.map.maptools.push(new GWTK.selectAreaRect),b=GWTK.maphandlers.map.mapTool("selectAreaRect"));void 0===GWTK.featureSearch&&GWTK.selectFeatures(GWTK.maphandlers.map);if(0==GWTK.maphandlers.map.tiles.getSelectableLayers().length)return GWTK.Util.error_report(),
b.clearRectImage(),!1;$(a.currentTarget).hasClass("control-button-active")?GWTK.maphandlers.clearAction():(GWTK.maphandlers.clearAction(),$(a.currentTarget).addClass("control-button-active"),b.setTool(GWTK.featureSearch.searchObjectsByAreaFrame))},toolbar_button_click:function(a){if(!a||!a.currentTarget||!a.currentTarget.id)return!1;a=$(a.currentTarget);var b=a[0]._pane;a.hasClass("control-button-active")?(a.removeClass("control-button-active"),b&&$("#"+b).hide()):(a.addClass("control-button-active"),
GWTK.maphandlers.map.setMapContentPanel(),b&&b&&$("#"+b).show())},iseditorAction:function(a,b){return void 0==GWTK._mapEditor||null==GWTK._mapEditor||!GWTK._mapEditor.isActionProcess()?!1:!GWTK._mapEditor.issetnewobject(a,b)?!0:!1}};GWTK.MapDragData=function(){this.y_prev=this.x_prev=this.y=this.x=0;this.ddy=this.ddx=4;this.dy=this.dx=0;this.dragstart=this.drag=!1;this.point_=GWTK.point(0,0);this.init=function(){this.dy=this.dx=this.y_prev=this.x_prev=this.y=this.x=0;this.dragstart=this.drag=!1;this.point_.x=
0;this.point_.y=0};this.getOffsetPoint=function(){this.point_.x=this.x_prev;this.point_.y=this.y_prev;return this._point};this.setOffsetPoint=function(a){void 0==a||null==a?this.y_prev=this.x_prev=0:(this.x_prev=a.x,this.y_prev=a.y)};this.setOffset=function(a){void 0==a||null==a||(this.dx=a.clientX-this.x_prev,this.dy=a.clientY-this.y_prev,this.x_prev=a.clientX,this.y_prev=a.clientY,this.x+=this.dx,this.y+=this.dy)};this.isDragEnabled=function(){return this.drag&this.dragstart};this.setDrag=function(a){this.drag=
!1;if(void 0!=a){var b=new GWTK.Point(a.clientX,a.clientY);b._subtract(GWTK.point(this.x_prev,this.y_prev));if(Math.abs(b.x)>=this.ddx||Math.abs(b.y)>=this.ddy)this.drag=!0,this.y=this.x=0,this.setOffset(a)}}};GWTK.handlers=function(a){GWTK.maphandlers=new GWTK.Handlers(a);return GWTK.maphandlers};GWTK.movedrag=function(){return void 0==GWTK.maphandlers||null==GWTK.maphandlers||void 0==GWTK.maphandlers.movedrag||null==GWTK.maphandlers.movedrag?null:GWTK.maphandlers.movedrag};GWTK.selectFeatures=function(a){GWTK.featureSearch=
new GWTK.objectsSearch(a);return GWTK.featureSearch}};window.GWTK&&(GWTK.WmsManager=function(a){this.map=a;this.ids=[];this.containerName="div_wms_";this.imgName="img_wms_";this.panel=document.createElement("div");this.panel.id="wmsPane";this.panel.className="wms-panel";this.map.panes.tilePane.appendChild(this.panel);this.parent=this.panel;this.tempContainer=document.createElement("div");this.tempContainer.id="wms_temp_Image";this.tempContainer.className="wms-panel";this.map.panes.tilePane.appendChild(this.tempContainer);this.adjustPosition();this.panel.style.left=
this.tempContainer.style.left;this.panel.style.top=this.tempContainer.style.top;this.moved=this.view_refresh=!1;this.yOffset=this.xOffset=0;"errorTileUrl"in this.map.options?this.errorImage=this.map.options.errorTileUrl:(this.errorImage=GWTK.imgEmpty,this.getErrorSrc())},GWTK.WmsManager.prototype={count:function(){return this.ids.length},move:function(a,b){this.moved=!0;this.xOffset+=a;this.yOffset+=b;this.adjustPosition()},registerLayer:function(a){if(!a||!a.wms)return!1;var b;b=this.getRecord(a.server);
var c={layer:a.id,xId:a.xId};if(b&&b.div){var d=this.parent.getElementById(b.div);a.layerContainer=d;b.list.push(c)}else{b=a.xId;d=document.createElement("div");d.id=this.containerName+b;d.className="wms-panel";var e=document.createElement("img");e.id=this.imgName+b;e.className="wms-image";e.onerror=this._onError.bind(this);e.onload=function(){GWTK.maphandlers.map.tiles.wmsManager.clearTempImage(this.id)};e.xid=a.xId;d.appendChild(e);a.layerContainer=d;this.ids.push({serv:a.server,div:this.containerName+
b,list:[c]});this.panel.appendChild(d);this.createTempImage(b)}return!0},getRecord:function(a){if(0==this.count())return null;for(var b=0,c=this.count(),b=0;b<c;b++)if(this.ids[b].serv==a)return[b+1,this.ids[b]];return null},wmsDrawing:function(a){if(0!=this.count()){this.tempContainer._scaling=a;a=-parseInt(this.map.panes.tilePane.style.left);var b=-parseInt(this.map.panes.tilePane.style.top);this.moved?(this.tempContainer.style.left=this.xOffset+a+"px",this.tempContainer.style.top=this.yOffset+
b+"px",this.copyToTempImage(),this.yOffset=this.xOffset=0):(this.tempContainer.style.left=a+"px",this.tempContainer.style.top=b+"px",this.copyToTempImage());$(this.panel).find(".wms-image").toggle(!1);for(var c=0,d=this.count(),e,f,c=0;c<d;c++)if(e=this.ids[c].list,this.getLayersParam(c),f=$(this.parent).find("#"+this.ids[c].div),0!=f.length&&(f=f.find(".wms-image"),0!=f.length&&(e=this.map.tiles.getLayerByxId(e[0].xId))))e=e.buildGetMap(),0==e.length&&(e=this.s),f[0].src=e;this.view_refresh?(this.view_refresh=
!1,this.adjustPosition(),this.panel.style.left=this.tempContainer.style.left,this.panel.style.top=this.tempContainer.style.top):(this.moved=!1,this.parent.style.top=b+"px",this.parent.style.left=a+"px",this.parent.lt=GWTK.point(a,b))}},copyToTempImage:function(a,b){if(this.tempContainer){var c=$(this.panel).find(".wms-image"),d=c.length,e,f;for(e=0;e<d;e++)f=$("#"+c[e].id+"_temp"),0!=f.length&&(f[0].src=c[e].src)}},clearTempImage:function(a){if(a&&this.tempContainer){var b=$("#"+a),c=$("#"+a+"_temp");
a=$(this.panel).find(".wms-image");var d;if(this.tempContainer._scaling){d=$(this.panel).find(".wms-image:hidden");a.length>=d.length&&(1>this.tempContainer._scaling?window.setTimeout(function(a,b){return function(){w2utils.transition(a,b,"pop-in",GWTK.maphandlers.map.tiles.wmsManager.clearCss)}}(c[0],b[0]),500):window.setTimeout(function(a,b){return function(){w2utils.transition(a,b,"pop-out",GWTK.maphandlers.map.tiles.wmsManager.clearCss)}}(c[0],b[0]),500));a=$(this.tempContainer).find(".wms-image");
c=a.length;for(d=0;d<c;d++)a[d].src=this.errorImage;b.toggle(!0)}else b.toggle(!0),c[0].src=this.errorImage}},clearCss:function(){var a=$(GWTK.maphandlers.map.tiles.wmsManager.panel).find(".wms-image"),b,c=a.length;for(b=0;b<c;b++)a[b].style.cssText="display:block;";a=$(GWTK.maphandlers.map.tiles.wmsManager.tempContainer).find(".wms-image");c=a.length;for(b=0;b<c;b++)a[b].style.cssText="display:block;",a[b].parentNode.style.cssText="display:block;"},adjustPosition:function(){var a=-parseInt(this.map.panes.tilePane.style.left),
b=-parseInt(this.map.panes.tilePane.style.top);this.tempContainer.style.left=a+"px";this.tempContainer.style.top=b+"px";this.tempContainer._pos=GWTK.point(a,b)},getLayersParam:function(a){if(!this.map||!this.ids||0>a||this.ids.length<=a)return null;a=this.ids[a].list;for(var b=[],c=0,d=a.length,c=0;c<d;c++)if(a[c].layer){var e=this.map.tiles.getLayerByxId(a[c].xId);e&&e.getVisibility()&&b.push(a[c].layer)}return b.toString()},createTempImage:function(a){a||(a="");var b=this.containerName+a+"_temp";
if(!(1<=$(this.temContainer).find("#"+b).length)){var c=document.createElement("div");c.id=b;c.className="wms-panel";b=document.createElement("img");b.className="wms-image draggable";b.id=this.imgName+a+"_temp";b.xid=a;c.appendChild(b);c._pict=b;this.tempContainer.appendChild(c)}},scaleTempImage:function(a,b){},_onError:function(a){var b=null;a||(a=window.event);if((b=a.srcElement?a.srcElement:a.target)&&!1!="src"in b)$("#"+b.id+"_temp")[0].src=this.errorImage,$(b).toggle(!0)},getErrorSrc:function(){var a=
window.location.pathname;a.substring(0,a.lastIndexOf("/"));return this.errorImage=GWTK.imgEmpty}});window.GWTK&&(GWTK.LayerOnClient=function(){this.xId="";this.updated=!1},GWTK.layerOnClient=function(){return new GWTK.LayerOnClient},GWTK.legendItem={id:"",text:"",img:"",expanded:"",nodes:[],code:"",local:""},GWTK.legend={id:"",url:"",items:[]},GWTK.LayersControl=function(a){this.map=a;this.wmsManager=null;this.count=0;this.scaleChange=!1;this.tileWidth=this.tileHeight=256;this.oldScale=this.yOffset=this.xOffset=0;this.timerMosaicRedraw=null;this.timerMosaicRedrawInterval=400;this.freeTileObjects=
[];this.viewOrder=[];this.legends=[];this.legendWfs=[];this.init()},GWTK.LayersControl.prototype={init:function(){this.oldScale=this.map.options.tilematrix;this.mapmove=GWTK.movedrag()},getLayerByxId:function(a){if(null==a||""==a)return null;var b,c=this.map.layers.length;for(b=0;b<c;b++)if(null!=this.map.layers[b]&&this.map.layers[b].xId==a)return this.map.layers[b];return null},indexOfxIdInArray:function(a,b){if(null==a||0==a.length||null==b)return-1;for(var c in a)if(null!=a[c]&&a[c].xId==b)return c;
return-1},getLayerLegendByxId:function(a){if(!a||""==a||0==this.legends.length)return null;var b,c=this.legends.length;for(b=0;b<c;b++)if(this.legends[b].id==a)return this.legends[b];return null},hide:function(){for(var a=0;a<this.map.layers.length;a++)null!=this.map.layers[a]&&this.map.layers[a].hide()},show:function(){for(var a=0;a<this.map.layers.length;a++)null!=this.map.layers[a]&&this.map.layers[a].show()},destroy:function(){for(var a=0;a<this.map.layers.length;a++)null!=this.map.layers[a]&&
this.map.layers[a].destroy();this.count=0;this.map.layers=[]},drawWmsLayers:function(){null!=this.wmsManager&&this.wmsManager.wmsDrawing()},update:function(){this.oldScale!=this.map.options.tilematrix&&(this.scaleChange=!0);var a=parseInt(this.map.options.tilematrix,10),b=parseInt(this.oldScale),a=this.map.getZoomScale(a),b=this.map.getZoomScale(b),a=a/b;1==a&&(a=0);for(var c,d=0,e=0;e<this.map.layers.length;e++)this.map.layers[e].wms||(this.map.layers[e].update(),void 0!=this.map.layers[e].x&&void 0!=
this.map.layers[e].y&&(b=this.map.layers[e].x,c=this.map.layers[e].y,0==d&&(GWTK.DomUtil.setPosition(this.map.panes.tilePane,GWTK.point(b,c)),d=1,this.wmsManager&&this.wmsManager.wmsDrawing(a))));this.scaleChange=!1;this.oldScale=this.map.options.tilematrix;this.map._writeCookie()},wmsUpdate:function(){this.wmsManager&&this.wmsManager.wmsDrawing(0)},forceupdate:function(){this.scaleChange=!0;this.update()},setWms:function(){this.wmsManager||(this.wmsManager=new GWTK.WmsManager(this.map))},getVisibleLayers:function(){var a=
[],b=$.isArray(this.map.tiles.viewOrder)&&0!=this.map.tiles.viewOrder.length?!0:!1,c,d,e=null,f;c=f=0;for(d=this.map.layers.length;c<d;c++)e=b?this.map.tiles.getLayerByxId(this.map.tiles.viewOrder[c]):this.map.layers[c],null!=e&&e.visible&&(a[f]={xId:e.xId,alias:e.alias},f++);return a},setVisibleLayers:function(a,b){if($.isArray(a)&&0!=a.length)if(Boolean(b)){this.hide();for(c=0;c<a.length;c++)d=this.getLayerByxId(a[c]),null!=d&&d.show()}else{this.show();for(var c=0;c<a.length;c++){var d=this.getLayerByxId(a[c]);
null!=d&&d.hide()}}},getTileLayer:function(){if(null==this.map)return null;var a,b=this.map.layers.length;for(a=0;a<b;a++)if(!this.map.layers[a].wms)return this.map.layers[a];return null},getSelectableLayers:function(){var a=[];if(null==this.map)return a;var b,c;for(b=0;b<this.map.layers.length;b++)this.map.layers[b].visible&&(null!=this.map.layers[b].selectObject&&1==this.map.layers[b].selectObject)&&(c=GWTK.Util.getParamsFromURL(this.map.layers[b].options.url),c=this.map.layers[b].wms?c.layers:
c.layer,-1==GWTK.Util.indexOf(a,c,0)&&a.push(c));return a.toString()},getTextSearchLayers:function(){var a=[];if(null==this.map)return a;var b;for(b=0;b<this.map.layers.length;b++)if(this.map.layers[b].isTextSearch&&this.map.layers[b].isTextSearch()){var c=GWTK.Util.getParamsFromURL(this.map.layers[b].options.url);a.push(c.layer)}return a.toString()},getTextSearchOptions:function(){var a={list:[]};if(null==this.map)return a;var b,c;for(b=0;b<this.map.layers.length;b++)if(this.map.layers[b].isTextSearch&&
this.map.layers[b].isTextSearch()){c=GWTK.Util.getParamsFromURL(this.map.layers[b].options.url);var d={layer:"",keys:[]};d.layer=c.layer;d.keys=this.map.layers[b].keysTextSearch;c=a.list.length;1<c&&c--;a.list[c]=d}return a},getLayerByIdService:function(a){if(null==this.map||!a||0==a.length)return"";var b="";for(i=0;i<this.map.layers.length;i++)if(b=this.map.layers[i].idLayerWMTS?this.map.layers[i].idLayerWMTS:this.map.layers[i].id,b==a)return this.map.layers[i];return""},getLayerByGmlId:function(a){if(!this.map||
!a||0==a.length)return null;a=a.split(":");if(2!=a.length)return null;a=a[0].toLowerCase();for(i=0;i<this.map.options.layers.length;i++)if(this.map.options.layers[i].sheet&&this.map.layers[i].options.sheet.toLowerCase()==a)return this.map.layers[i];return null},_onMouseDown:function(a){this.yOffset=this.xOffset=0;this.wmsManager&&(this.wmsManager.xOffset=0,this.wmsManager.yOffset=0,this.wmsManager.adjustPosition());return!1},_onMouseUp:function(a){return!1},_onMouseMove:function(a,b){this.xOffset+=
a;this.yOffset+=b;GWTK.browserSafariForiOS?(null!=this.timerMosaicRedraw&&(clearTimeout(this.timerMosaicRedraw),this.timerMosaicRedraw=null),this.timerMosaicRedraw=setTimeout("GWTK.maphandlers.map.tiles.postponedMouseMove();",this.timerMosaicRedrawInterval)):this.postponedMouseMove();return!1},postponedMouseMove:function(){void 0==this.mapmove&&(this.mapmove=GWTK.movedrag());this.shift();this.wmsManager&&this.wmsManager.move(this.xOffset,this.yOffset);this.yOffset=this.xOffset=0},shift:function(){var a=
this.map;if(null==a||null==a.layers)return!1;for(var b=!1,c=0;c<a.layers.length;c++)null!=a.layers[c]&&(a.layers[c].wms||a.layers[c].setShift(this.xOffset,this.yOffset)&&(b=!0));return b},getLayersCenterProjected:function(){if(null==this.map||null==this.getTileLayer())return null;var a=this.map.getWindowSize();a[0]=parseFloat(a[0]/2);a[1]=parseFloat(a[1]/2);a=this.getLayersPointTile(GWTK.point(a));return GWTK.tileView.tile2unit(a,this.map)},getLayersPointTile:function(a){if(null==this.map||null==
GWTK.tileView)return null;var b=this.getTileLayer();if(null==b)return null;b=[b.coll,b.row,-1*b.x,-1*b.y];return b=GWTK.tileView.shiftTiles(b,a)},getLayersPointProjected:function(a){a=this.getLayersPointTile(a);var b=new GWTK.MapsProjection;b.init(this.map.options.tilematrix);b=b.pixel2Geo(GWTK.point(a[4],a[5]));GWTK.projection.geo2xy(this.map.options.crs,b.x,b.y);return GWTK.tileView.tile2unit(a,this.map)},getLayersPointOffset:function(a){if(null==this.map||null==GWTK.tileView)return null;var b=
this.getTileLayer();if(null==b)return null;var c=[-1*b.x,-1*b.y],b=GWTK.point(b.coll*this.tileWidth+c[0],b.row*this.tileHeight+c[1]);a=GWTK.point(a[4],a[5]);a._subtract(b);return a}},GWTK.layersControl=function(a){return new GWTK.LayersControl(a)});window.GWTK&&(GWTK.TileRect=function(){this.collEnd=this.collBegin=this.rowEnd=this.rowBegin=0;this.tileBufferBottom=this.tileBufferRight=this.tileBufferTop=this.tileBufferLeft=1},GWTK.TileRect.prototype={setRect:function(a,b,c,d){!isNaN(a)&&(!isNaN(b)&&!isNaN(c)&&!isNaN(d))&&(this.rowBegin=a-this.tileBufferTop,this.rowEnd=b+this.tileBufferBottom,this.collBegin=c-this.tileBufferLeft,this.collEnd=d+this.tileBufferRight)},shiftRect:function(a,b){!isNaN(a)&&!isNaN(b)&&(this.rowBegin+=a,this.rowEnd+=
a,this.collBegin+=b,this.collEnd+=b)},enlargeRect:function(a,b){!isNaN(a)&&!isNaN(b)&&(0>a&&(this.rowBegin+=a),0<a&&(this.rowEnd+=a),0>b&&(this.collBegin+=b),0<b&&(this.collEnd+=b))},setTileBuffer:function(a,b,c,d){isNaN(a)||(this.tileBufferLeft=a);isNaN(b)||(this.tileBufferTop=b);isNaN(c)||(this.tileBufferRight=c);isNaN(d)||(this.tileBufferBottom=d)}},GWTK.tileRect=function(){return new GWTK.TileRect},GWTK.Layer=function(a,b){void 0==a||null==a||(this.options=this.map=null,this.url=this.alias=this.xId=
"",this.format="png",this.iconUrl="",this.minZoomView=0,this.maxZoomView=23,this.style="default",this.matrixSet=[],this.visible=!0,this.areaSeek=this.selectObject=0,this.keysTextSearch="",this.id="tileLayer_"+Math.random(),this.matrix=a.tilePane,this.layerContainer=null,this.alias=this.name=this.idLayerWMTS="",this.collCount=this.rowCount=this.collMax=this.rowMax=this.collTotal=this.rowTotal=this.y=this.x=this.PicY=this.PicX=this.coll=this.row=this.windowWidth=this.windowHeight=this.auton=0,this.wmtsQueries=
this.bounds=null,this.serverUrl=this.tilematrixset=this.wmtsLayerId="",this.errorImage=GWTK.imgEmpty,this.isBottomLayer=!1,this.coll_ox=this.row_oy=0,this.visibleRect=GWTK.tileRect(),this.zIndex=parseInt(a.tiles.indexOfxIdInArray(a.layers,this.xId),10),this.visible=!0,this.scaleBottom=this.scaleTop=-1,this.classifier=null,this.init(a,b),a.layers.push(this))},GWTK.Layer.prototype={init:function(a,b){this.map=a;this.options=b;var c=this.map.getWindowSize();this.windowWidth=parseInt(c[0],10);this.windowHeight=
parseInt(c[1],10);this.rowMax=Math.ceil(this.windowHeight/this.map.tiles.tileHeight);this.collMax=Math.ceil(this.windowWidth/this.map.tiles.tileWidth);this.rowCount=this.rowMax;this.collCount=this.collMax;"errorTileUrl"in this.map.options?this.errorImage=this.map.options.errorTileUrl:(this.errorImage=GWTK.imgEmpty,this.getErrorSrc());this.classifier=new GWTK.classifier(this)},onAdd:function(){this.setOptions()?(this.row_oy=this.row,this.coll_ox=this.coll,this.firstDraw()):this.hide()},onRemove:function(){null!=
this.matrix&&null!=this.layerContainer&&(this.matrix.removeChild(this.layerContainer),this.xmlDoc=this.layerContainer=null)},show:function(){null!=this.layerContainer&&$(this.layerContainer).show();this.visible=!0},hide:function(){null!=this.layerContainer&&$(this.layerContainer).hide();this.visible=!1},setType:function(){},getVisibility:function(){return this.visible},getMinZoomView:function(){},getMaxZoomView:function(){},setTileBounds:function(){var a=this.map.getWindowSize();this.windowWidth=
parseInt(a[0],10);this.windowHeight=parseInt(a[1],10);this.rowMax=Math.ceil(this.windowHeight/this.map.tiles.tileHeight);this.collMax=Math.ceil(this.windowWidth/this.map.tiles.tileWidth);this.rowCount=this.rowMax;this.collCount=this.collMax},setOptions:function(){this.xId=this.options.id;this.name=this.alias=this.options.alias;this.serverUrl=this.options.url;this.auton=0;this.tilematrixset=this.map.options.tilematrixset;this.idLayerWMTS=GWTK.Util.getParamsFromURL(this.serverUrl);this.idLayerWMTS=
this.idLayerWMTS.layer;var a=GWTK.tileView.getTileLayerData(this.map.options.tilematrix,this.map);this.coll=a[0];this.row=a[1];this.x=-a[2];this.y=-a[3];this.PicX=a[4];this.PicY=a[5];this.setBounds();this.elem=document.getElementById("inText");var a=this.serverUrl.split("?"),b=GWTK.Util.getParamsFromURL(this.serverUrl);2<=a.length&&b.service&&b.layer&&"wmts"==b.service.toLowerCase()?(this.wmtsQueries=new WmtsQueries(a[0]),this.wmtsLayerId=b.layer):(this.wmtsQueries=null,this.wmtsLayerId="");this.rowTotal=
Math.pow(2,this.map.options.tilematrix);this.collTotal=Math.pow(2,this.map.options.tilematrix);this.rowMax>this.rowTotal&&0!=this.map.options.tilematrix&&(this.rowMax=this.rowTotal);this.collMax>this.collTotal&&0!=this.map.options.tilematrix&&(this.collMax=this.collTotal);this.rowCount>this.rowTotal&&(this.rowCount=this.rowTotal);this.collCount>this.collTotal&&(this.collCount=this.collTotal);this.selectObject=this.options.selectObject;this.selectsearch=this.options.selectsearch;this.keysTextSearch=
[];if(void 0!=this.options.keyssearchbyname&&0!=this.options.keyssearchbyname.length)for(a=0;a<this.options.keyssearchbyname.length;a++)0!=this.options.keyssearchbyname[a].length&&this.keysTextSearch.push(this.options.keyssearchbyname[a]);return!0},setBounds:function(){this.bounds=null;if(!(null==this.options||void 0==this.options))if(!(!1=="bbox"in this.options||4!=this.options.bbox.length)){var a=GWTK.projection.geo2xy(this.map.options.crs,this.options.bbox[0],this.options.bbox[1]),a=GWTK.point(a[1],
a[0]),b=GWTK.tileView.getTileLayerData(this.map.options.tilematrix,this.map,a),a=GWTK.projection.geo2xy(this.map.options.crs,this.options.bbox[2],this.options.bbox[3]),a=GWTK.point(a[1],a[0]),a=GWTK.tileView.getTileLayerData(this.map.options.tilematrix,this.map,a);this.bounds={colls:[],rows:[]};this.bounds.colls=b[0]<a[0]?[b[0],a[0]]:[a[0],b[0]];this.bounds.rows=b[1]<a[1]?[b[1],a[1]]:[a[1],b[1]]}},checkBounds:function(){if(null==this.bounds)return!0;var a,b=[this.visibleRect.collBegin,this.visibleRect.collEnd];
b[0]>b[1]&&(a=b[0],b[0]=b[1],b[1]=a);a=[this.visibleRect.rowBegin,this.visibleRect.rowEnd];return b[1]<this.bounds.colls[0]||b[0]>this.bounds.colls[1]||a[1]<this.bounds.rows[0]||a[0]>this.bounds.rows[1]?!1:!0},firstDraw:function(){null!=this.matrix&&(this.layerContainer=document.createElement("div"),this.layerContainer.id="div_"+this.xId,this.layerContainer.className="draggable-no-z-index",this.layerContainer.style.zIndex=this.zIndex,this.matrix.appendChild(this.layerContainer),0==this.rowTotal&&
0==this.collTotal?this.drawErrorScreen():(-1==this.coll&&(this.coll=0,this.x=-1*this.PicX),-1==this.row&&(this.row=0,this.y=-1*this.PicY),this.visibleRect.setRect(this.row,this.row+this.rowMax,this.coll,this.coll+this.collMax),this.redrawMosaic(),GWTK.DomUtil.setPosition(this.map.panes.tilePane,GWTK.point(this.x,this.y,!0))))},update:function(){if(this.setOptions()){this.row_oy=this.row;this.coll_ox=this.coll;this.setTileBounds();if(this.map.tiles.scaleChange)for(;this.layerContainer.childNodes.length;)this.map.tiles.freeTileObjects[this.map.tiles.freeTileObjects.length]=
this.layerContainer.removeChild(this.layerContainer.firstChild);this.visibleRect.setRect(this.row,this.row+this.rowMax,this.coll,this.coll+this.collMax);this.cleanMosaic();this.redrawMosaic()}else this.hide()},checkVisibility:function(){var a=!0;if(-1!=this.scaleBottom||-1!=this.scaleTop)this.map.options.tilematrix<this.scaleTop?a=!1:this.map.options.tilematrix>this.scaleBottom&&(a=!1);a?this.show():this.hide()},setShift:function(a,b){var c=0,d=0,e=Math.abs(this.x+a),f=this.x+a;0!=a&&(0>a?f<=-this.map.tiles.tileWidth&&
(d=1,f+=this.map.tiles.tileWidth*d):0<=f&&(d=-1,f>this.map.tiles.tileWidth?(e=parseInt(e/this.map.tiles.tileWidth,10),d=-1*e,f=this.map.tiles.tileWidth*e-f):f=-1*(this.map.tiles.tileWidth-f)),this.coll+=d,this.x=f);Math.abs(this.y+b);f=this.y+b;0!=b&&(e=-this.map.tiles.tileHeight,f<=e?(c=1,f+=this.map.tiles.tileHeight*c):0<f&&(c=-1,f+=e),this.row+=c,this.y=f);return 0!=c||0!=d?(this.visibleRect.shiftRect(c,d),this.cleanMosaic(),this.redrawMosaic(),!0):!1},redrawMosaic:function(){if(this.visible&&
null!=this.visibleRect&&null!=this.layerContainer){var a,b,c=document.createDocumentFragment(),d=null;for(a=this.visibleRect.rowBegin;a<this.visibleRect.rowEnd;a++)for(b=this.visibleRect.collBegin;b<this.visibleRect.collEnd;b++)d=this.getTile(a,b),null!=d&&c.appendChild(d);this.layerContainer.appendChild(c)}},cleanMosaic:function(){if(!(null==this.visibleRect||null==this.layerContainer||0==this.layerContainer.childNodes))for(var a=this.layerContainer.childNodes,b=a.length,c,d,e=0;e<b;e++)c=a[e],void 0!=
c&&(d=c.id,null!=d&&(d=d.split("__"),"mapTile"==d[0]&&(c=parseInt(d[2],10),d=parseInt(d[3],10),c>=this.visibleRect.rowBegin&&c<=this.visibleRect.rowEnd&&d>=this.visibleRect.collBegin&&d<=this.visibleRect.collEnd||(this.freeTile(c,d),e--,b--))))},freeTile:function(a,b){if(!(null==a||null==b)){var c=GWTK.DomUtil.get("mapTile__"+this.xId+"__"+a+"__"+b+"__"+this.map.options.tilematrix);null!=c&&(this.map.tiles.freeTileObjects[this.map.tiles.freeTileObjects.length]=c.parentNode.removeChild(c))}},getTile:function(a,
b){if(null==this.layerContainer||isNaN(a)||isNaN(b)||0>a||a>=this.rowTotal||0>b||b>=this.collTotal)return null;if(0==this.map.tiles.freeTileObjects.length)return this.addTile(a,b),null;var c=this.map.tiles.freeTileObjects.pop();c.id="mapTile__"+this.xId+"__"+a+"__"+b+"__"+this.map.options.tilematrix;c.style.visibility="hidden";c.onload=function(){c.style.visibility="visible"};c.onerror="";c.removeAttribute("src");c.onerror=this._onError.bind(this);c.style.width=this.map.tiles.tileWidth+"px";c.style.height=
this.map.tiles.tileHeight+"px";GWTK.DomUtil.setPosition(c,new GWTK.Point((b-this.coll_ox)*this.map.tiles.tileWidth,(a-this.row_oy)*this.map.tiles.tileHeight));c.src=this.getFileName(a,b);return c},createTile:function(a,b){if(0>a||a>=this.rowTotal||0>b||b>=this.collTotal)return null;var c="mapTile__"+this.xId+"__"+a+"__"+b+"__"+this.map.options.tilematrix;if(null!=GWTK.DomUtil.get(c))return this.showTile(a,b),null;var d=document.createElement("img");d.id=c;d.className="draggable";d.style.width=this.map.tiles.tileWidth+
"px";d.style.height=this.map.tiles.tileHeight+"px";d.style.visibility="hidden";d.onload=function(){d.style.visibility="visible"};d.ondragstart="return false;";d.style.zIndex=this.zIndex;GWTK.DomUtil.setPosition(d,new GWTK.Point((b-this.coll_ox)*this.map.tiles.tileWidth,(a-this.row_oy)*this.map.tiles.tileHeight));d.src=this.getFileName(a,b);d.onerror=this._onError.bind(this);return d},addTile:function(a,b){if(null==this.layerContainer)return null;var c=this.createTile(a,b);null!=c&&this.layerContainer.appendChild(c)},
getFileName:function(a,b){if(null!=this.bounds&&(a<this.bounds.rows[0]||a>this.bounds.rows[1]||b<this.bounds.colls[0]||b>this.bounds.colls[1]))return this.errorImage;if(null!=this.wmtsQueries)return this.wmtsQueries.tileurl({layer:this.wmtsLayerId,matrix:this.tilematrixset,style:"default",format:"image/png",zoom:this.map.options.tilematrix,min:[b,a]})[0];var c=this.serverUrl.replace(/%x/,b),c=c.replace(/%y/,a),c=c.replace(/%z/,this.map.options.tilematrix);return c=c.replace(/%tilematrixset/,this.tilematrixset)},
drawErrorScreen:function(){for(var a=null,b=parseInt(this.windowHeight/this.map.tiles.tileHeight,10)+1,c=parseInt(this.windowWidth/this.map.tiles.tileWidth,10)+1,d=0;d<b;d++)for(var e=0;e<c;e++)a=getElement("mapTile__"+this.xId+"__"+d+"__"+e+"__"+this.map.options.tilematrix),null==a?this.addTile(d,e):(a.src=this.getErrorSrc(),a.style.display="none")},getErrorSrc:function(){var a=window.location.pathname;a.substring(0,a.lastIndexOf("/"));return this.errorImage=GWTK.imgEmpty},_onError:function(a){var b=
null;a||(a=window.event);b=a.srcElement?a.srcElement:a.target;null==b||!1=="src"in b||(b.src=this.errorImage)},showTile:function(a,b){if(!isNaN(a)&&!isNaN(b)){var c=GWTK.DomUtil.get("mapTile__"+this.xId+"__"+a+"__"+b+"__"+this.map.options.tilematrix);null!=c&&(0>a||a>=this.rowTotal?c.style.display="none":0>b||b>=this.collTotal?c.style.display="none":(c.src=this.getFileName(a,b),c.style.display=""))}},hideTile:function(a,b){if(!(null==a||null==b)){var c=getElement("mapTile__"+this.xId+"__"+a+"__"+
b+"__"+this.map.options.tilematrix);null!=c&&(c.style.display="none")}},rowsMin:function(){return null==this.bounds?0:this.bounds.rows[0]+1},rowsMax:function(){return null==this.bounds?this.rowTotal:this.bounds.rows[1]+1},colsMin:function(){return null==this.bounds?0:this.bounds.colls[0]+1},colsMax:function(){return null==this.bounds?this.collTotal:this.bounds.colls[1]+1},isTextSearch:function(){return!this.getVisibility()?!1:GWTK.Util.isArray(this.keysTextSearch)&&0<this.keysTextSearch.length&&0<
this.keysTextSearch[0].length?!0:!1},getTextFilterKeys:function(){if(!this.isTextSearch)return"";for(var a=[],b=0,c=0;c<this.keysTextSearch.length;c++)void 0!=this.keysTextSearch[c]&&(null!=this.keysTextSearch[c]&&0<this.keysTextSearch[c].length)&&(a[b]=this.keysTextSearch[c]),b++;return a.toString()}},GWTK.layer=function(a,b){return new GWTK.Layer(a,b)});window.GWTK&&(GWTK.WmsLayer=function(a,b){void 0==a||null==a||(this.options=this.map=null,this.url=this.alias=this.xId=this.server="",this.format="png",this.iconUrl="",this.style="default",this.selectObject=0,this.keysTextSearch="",this.layerContainer=this.parent=null,this.visible=!0,this.name=this.id="",this.auton=0,this.wms=!1,this.classifier=null,this.init(a,b))},GWTK.WmsLayer.prototype={init:function(a,b){this.map=a;this.options=b;this.parent=a.tilePane;"errorTileUrl"in this.map.options?this.errorImage=
this.map.options.errorTileUrl:(this.errorImage=GWTK.imgEmpty,this.getErrorSrc());this.classifier=new GWTK.classifier(this)},onAdd:function(){this.setOptions();if(this.wms)return this.map.tiles.wmsManager.registerLayer(this)&&this.map.layers.push(this),!0},onRemove:function(){},getErrorSrc:function(){var a=window.location.pathname;a.substring(0,a.lastIndexOf("/"));return this.errorImage=GWTK.imgEmpty},setOptions:function(a){if(this.map&&this.options&&(a&&(this.options=a),a=this.options.url.indexOf("?"),
!(0>=a))){this.server=this.options.url.slice(0,a);a=GWTK.Util.getParamsFromURL(this.options.url);if(!a.service)return!1;a.service=a.service.toLowerCase();this.wms="wms"==a.service;if(this.wms="wms"==a.service)this.id=a.layers,this.id||(this.id="*"),this.xId=this.options.id,this.alias=this.options.alias,this.selectObject=this.options.selectObject,this.keysTextSearch=this.options.keyssearchbyname}},buildGetMap:function(){if(this.map&&this.options){if(!this.visible)return"";var a=this.map.getMapBBox(),
a=a.min.toString()+","+a.max.toString(),b=this.map.getWindowSize(),c=this.options.url;if(0==b[0]||0==b[1])return"";c=c.replace(/%bbox/,a);c=c.replace(/%w/,b[0]);c=c.replace(/%h/,b[1]);c=c.replace(/%crs/,"EPSG:"+this.map.options.crs);return c=c.replace(/%dt/,(new Date).getMilliseconds().toString())}},update:function(){},show:function(){this.layerContainer&&(this.visible=!0,this.map.tiles.wmsManager.view_refresh=!0)},hide:function(){this.layerContainer&&(this.visible=!1,this.map.tiles.wmsManager.view_refresh=
!0)},getVisibility:function(){return this.visible},destroy:function(){},setShift:function(a,b){},_onError:function(a){var b=null;a||(a=window.event);b=a.srcElement?a.srcElement:a.target;null==b||!1=="src"in b||(b.src=this.errorImage)}});window.GWTK&&(GWTK.mapobject=function(a,b,c,d,e,f){this.map=a;if(void 0==this.map||null==this.map)this.map=GWTK.maphandlers.map;this.gid=b;this.id=null;this.maplayerid=c;this.geometry=this.maplayername=null;if(void 0!=d&&null!=d){this.geometry=new GWTK.mapgeometry(null,0,d.points,d.dimension,d.srsName);for(a=0;a<d.subjects;a++)this.geometry.addsubject(d.subjects[a],a+1)}this.semantic=e;this.wfsQuery_save=this.wfsQuery=this.spatialposition=this.layername=this.classifiername=this.crs=this.bbox=this.name=
this.code=null;this.mapobjects=f;this.overlayPane=null;this.drw_centerpoints=this.drw_select=this.drw_points=!1;this.sWfs=null;this.initialize()},GWTK.mapobject.prototype={initialize:function(){if(!1==this.map instanceof GWTK.Map||null==this.gid||void 0==this.gid)return this;this.setgid(this.gid);if(null==this.geometry||void 0==this.geometry)this.geometry=new GWTK.mapgeometry(this,0);else{this.geometry.mapobject=this;for(var a=0;a<this.geometry.subjects;a++)this.geometry.subjects[a].mapobject=this}for(var b=
this.map.options.url,c=this.map.options.layers.length,a=0;a<c;a++)if(this.map.options.layers[a].id==this.maplayerid){"url"in this.map.options.layers[a]&&""!=this.map.options.layers[a].url&&-1==this.map.options.layers[a].url.indexOf("http:")&&(this.map.options.layers[a].url=this.map.options.url+"?"+this.map.options.layers[a].url);b=this.map.options.layers[a].url;a=this.map.options.layers[a].url.indexOf("?");-1!==a&&(b=b.slice(0,a));break}this.wfsQuery=new WfsQueries(b);this.wfsQuery.context=this;this.wfsQuery.onDataLoad=
this.onDataLoaded;this.wfsQuery_save=new WfsQueries(b);this.wfsQuery_save.context=this;this.wfsQuery_save.onDataLoad=this.onDataLoaded_save;return this},initwfs:function(a){null==a&&void 0!=a&&this.setgid(a);this.wfsQuery.featurebyid(this.gid,this.maplayerid)},clone:function(){return new GWTK.mapobject(this.mapobject,this.gid,this.maplayerid,this.geometry,this.semantic,this.mapobjects)},createcopy:function(a){if(!(void 0==a||null==a||!1==a instanceof GWTK.mapobject)){var b=new GWTK.mapobject(a.map,
a.gid,a.maplayerid,a.geometry,a.semantic);b.maplayername=a.maplayername;b.code=a.code;b.name=a.name;b.crs=a.crs;b.classifiername=a.classifiername;b.layername=a.layername;b.spatialposition=a.spatialposition;b.sWfs=a.sWfs;return b}},setgid:function(a){null==a||void 0==a||(this.gid=a,a=a.split(":"),1<=a.length&&(this.maplayername=a[0],this.id=a[1]))},onDataLoaded:function(a,b){if(!(void 0==a||null==a||void 0==b||null==b)){b.loaddata(a);var c=document.getElementById("mapPane");(void 0!=c||null!=c)&&$(c).trigger({type:"mapobjectloadWfs",
layer:b.maplayerid,gid:b.gid})}},loaddata:function(a){var b=$.parseXML(a),c=$(b);if(!c)return["wfs_featurecollection",""];b=c.context.documentElement.nodeName.toLowerCase();if(-1==b.indexOf("featurecollection"))return["wfs_featurecollection",""];b=c.context.documentElement.childNodes;if(null==b||void 0==b||0==b.length)return["wfs_featurecollection",""];var c=a.indexOf("<wfs:member>"),d=a.indexOf("</wfs:member>");0<=c&&0<=d&&(this.sWfs=a.substring(c+12,d));for(var e,d=0;d<b.length;d++){a=b[d];switch(a.nodeName.toLowerCase()){case "wfs:member":c=
a.childNodes;if(null==c||void 0==c||0==c.length)continue;for(e=0;e<c.length;e++)this.loadobjectXmlElem(c[e]);break;case "bsd:classifiername":$(a).text()}a.nodeName.toLowerCase()}null!=this.waitdrawobject&&void 0!=this.waitdrawobject?(this.waitdrawobject._drawcontour(this.mapdiv),this.waitdrawobject=null):null!=this.mapobjects&&void 0!=this.mapobjects&&this.mapobjects.splice(this.mapobjects.length,0,this)},loadobjectXmlElem:function(a){if(!(null==a||void 0==a||0==a.length)){var b=a.nodeName;a=a.childNodes;
if(!(null==a||void 0==a||0==a.length)){var c;if(0<=b.indexOf("bsd")){b=b.split(":");1<=b.length&&(this.layername=b[1]);for(c=0;c<a.length;c++)if(b=a[c],!(0<=b.nodeName.toLowerCase().indexOf("bsd:sem")))if(0<=b.nodeName.toLowerCase().indexOf("bsd:")&&0<=b.nodeName.toLowerCase().indexOf("code"))this.code=this.loadtextXmlElem(b);else switch(b.nodeName.toLowerCase()){case "gml:name":this.name=this.loadtextXmlElem(b);break;default:this.loadspatialpositionXmlElem(b)}}}}},loadtextXmlElem:function(a){if(!(null==
a||void 0==a||0==a.length))return $(a).text()},loadattrXmlElem:function(a,b){if(!(null==a||void 0==a||0==a.length)){var c=a.attributes;if(!(null==c||void 0==c||0==c.length))for(var d=0;d<c.length;d++)if(c[d].nodeName.toLowerCase()==b)return c[d].nodeValue}},loadspatialpositionXmlElem:function(a){if(!(null==a||void 0==a||0==a.length)){var b=a.nodeName.toLowerCase();this.geometry.setSrsName(this.loadattrXmlElem(a,"srsname"));switch(b){case "gml:polygon":this.spatialposition="polygon";a=a.childNodes;
for(var c=b=0;c<a.length;c++)"gml:exterior"==a[c].nodeName.toLowerCase()&&this.loadgeometryXmlElem(a[c].childNodes,0),"gml:interior"==a[c].nodeName.toLowerCase()&&(b++,this.loadgeometryXmlElem(a[c].childNodes,b));break;case "gml:linestring":this.spatialposition="linestring";a=this.loadsinglegeometryXmlElem(a);this.loadpoints(a,0,this.geometry.dimension,this.geometry.countpoint);break;case "gml:curve ":this.spatialposition="curve";a=a.childNodes;for(c=b=0;c<a.length;c++)"gml:exterior"==a[c].nodeName.toLowerCase()&&
this.loadgeometryXmlElem(a[c].childNodes,0),"gml:interior"==a[c].nodeName.toLowerCase()&&(b++,this.loadgeometryXmlElem(a[c].childNodes,b));break;case "gml:point":this.spatialposition="point",a=this.loadsinglegeometryXmlElem(a),this.loadpoints(a,0,this.geometry.dimension,this.geometry.countpoint)}}},loadsinglegeometryXmlElem:function(a){if(!(null==a||void 0==a||0==a.length)){var b,c,d;switch(a.nodeName.toLowerCase()){case "gml:linestring":case "gml:point":a=a.childNodes;for(c=0;c<a.length;c++)if("gml:poslist"==
a[c].nodeName.toLowerCase()){b=a[c].attributes;if(null!=b&&void 0!=b&&0!=b.length)for(d=0;d<b.length;d++)"srsdimension"==b[d].nodeName.toLowerCase()&&(this.geometry.dimension=b[d].nodeValue),"count"==b[d].nodeName.toLowerCase()&&(this.geometry.countpoint=b[d].nodeValue);return data=$(a[c]).text()}}}},loadgeometryXmlElem:function(a,b){if(!(null==a||void 0==a||0==a.length))for(var c,d=0;d<a.length;d++)c=this.loadsinglegeometryXmlElem(a[d]),this.loadpoints(c,b,this.geometry.dimension,this.geometry.countpoint)},
loadpoints:function(a,b,c,d){if(!(void 0==a||null==a||null==c||void 0==c||null==d||void 0==d)){var e;a=a.split(" ");if(0<=a.length){c=parseInt(c);parseInt(d);for(d=0;d<a.length;d+=c)3==c&&(e=parseFloat(a[d+2])),this.geometry.appendpoint3D(parseFloat(a[d]),parseFloat(a[d+1]),e,b)}}},save:function(a){this.saveoperation=!1;if(!("create"!=a&&(null==this.sWfs||void 0==this.sWfs))){var b=this.geometry.pointsToXmlString(),c,d,e;switch(this.spatialposition){case "polygon":c="<gml:Polygon";e="</gml:Polygon>";
break;case "linestring":case "vector":c="<gml:LineString";e="</gml:LineString>";break;case "curve":case "point":c="<gml:Point",e="</gml:Point>"}var f="";"create"!=a&&(c=this.sWfs.indexOf(c),d=this.sWfs.indexOf(e),f=this.sWfs,0<=c&&0<=d&&(f=f.replace(f.substring(c,d+e.length),b)));response='<?xml version="1.0" encoding="utf-8" ?><wfs:Transaction version="2.0.0" service="WFS" handle="Transaction '+a+'"  xmlns:bsd="http://www.gisinfo.net/bsd" xmlns:wfs="http://www.opengis.net/wfs/2.0" xmlns:fes="http://www.opengis.net/fes/2.0" xmlns:gml="http://www.opengis.net/gml/3.2" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://www.gisinfo.net/bsd  http://www.gisinfo.net/bsd/topomap.xsd http://www.opengis.net/wfs/2.0 http://schemas.opengis.net/wfs/2.0.0/wfs.xsd http://www.opengis.net/gml/3.2 http://www.opengis.net/gml/3.2.1/gml.xsd" >';
switch(a){case "replace":b="<bsd:"+this.layername+' gml:id="'+this.gid+'">';c=f.indexOf(b);if(0>c)return;f=f.replace(b,"<bsd:"+this.layername+' gml:id="id'+this.id.toString()+'">');response+='<wfs:Replace handle="'+a+"_"+this.maplayerid.toString()+"_"+this.id.toString()+'"><fes:Filter><fes:ResourceId rid="'+this.gid+'"/></fes:Filter>'+f+"</wfs:Replace></wfs:Transaction>";"<bsd:"+this.layername+'gml:id="id'+this.id.toString()+'" >';break;case "delete":response+='<wfs:delete handle="'+a+"_"+this.maplayerid.toString()+
"_"+this.id.toString()+'" typeName="bsd:'+this.layername+'"><fes:Filter><fes:ResourceId rid="'+this.gid+'"/></fes:Filter></wfs:delete></wfs:Transaction>';break;case "create":response+='<wfs:Insert handle="'+a+"_"+this.maplayerid.toString()+"_"+this.id.toString()+'"><bsd:'+this.layername+' gml:id="'+this.maplayername+'"><bsd:'+this.layername+"Code>"+this.code+"</bsd:"+this.layername+"Code><gml:name>"+this.name+"</gml:name> "+b+"</bsd:"+this.layername+"></wfs:Insert></wfs:Transaction>"}this.wfsQuery_save.transaction(response,
this.maplayerid)}},drawcontour:function(a){this.cleardraw();void 0==this.geometry||null==this.geometry||(0==this.geometry.count()&&"0"!=this.gid?(this.waitdrawobject=this,this.initwfs(this.gid)):this._drawcontour(a))},setDrawParam:function(a,b,c){void 0!=a&&null!=a&&(this.drw_select=a);void 0!=b&&null!=b&&(this.drw_points=b);void 0!=c&&null!=c&&(this.drw_centerpoints=c);this.geometry.setDrawParam(a,b,c)},refreshdraw:function(){if(!(null==this.geometry||void 0==this.geometry)){this.geometry.refreshdraw();
for(var a=0;a<this.geometry.subjects;a++)this.geometry.subjects[a].refreshdraw()}},clear:function(){$(this.mapdiv).off("overlayRefresh");this.cleargeometry();this.clearsemantic();this._cleardrawpanel()},cleargeometry:function(){null!=this.geometry&&void 0!=this.geometry&&this.geometry.clear()},cleardraw:function(){(null!=this.geometry||void 0!=this.geometry)&&this.geometry.cleardraw();this._cleardrawpanel()},clearsemantic:function(){null!=this.semantic&&void 0!=this.semantic&&this.semantic.clear()},
initRes:function(a){},_drawcontour:function(a){if(!(void 0==this.geometry||null==this.geometry)){if(void 0==a||null==a)a=document.getElementById("overlayPane");this.mapdiv=a;this.overlayPane=GWTK.DomUtil.create("div","overlay-panel",this.mapdiv);this.overlayPane.id="mapobject-overlayPane_"+this.gid;this.geometry.draw(this.overlayPane,this.drw_select,this.drw_points,this.drw_centerpoints);var b=this;$(this.mapdiv).on("overlayRefresh",function(a){b.refreshdraw();return!1})}},_cleardrawpanel:function(a){null!=
this.overlayPane&&($(this.overlayPane).children().remove(),void 0!=this.mapdiv&&null!=this.mapdiv&&this.mapdiv.removeChild(this.overlayPane),this.overlayPane=null)},onDataLoaded_save:function(a,b){void 0==a||(null==a||void 0==b||null==b)||(b.saveoperation=!0,null!=b.geometry.mapeditor&&b.geometry.mapeditor.resetaftersave(b))}});this.geometry;
window.GWTK&&(GWTK.mapgeometry=function(a,b,c,d,e){this.mapobject=a;this.subject=0;null!=b&&(void 0!=b&&0<b)&&(this.subject=b);void 0==d&&(d=2);this.dimension=d;this.srsName=e;this.countpoint=0;this.points=[];if(void 0!=c||null!=c)for(a=0;a<c.length;a++)this.points.push(c[a].clone());this.subjects=[];this.drawpanel=null;this.drawpoints=[];this.imgpoint=GWTK.imgMarkerRedPoint;this.imgpointCurrent=GWTK.imgPrickBig;this.imgpointSelect=GWTK.imgPrickBig_select;this.imgpointFirst=GWTK.imgFirstPoint;this.imgpointLast=
GWTK.imgLastPoint;this.drw_centerpoints=this.drw_points=!1;this.viewobject="";this.cssLine_msie="draw-line-msie";this.cssLine="draw-line";this.cssLine_msie_select="selected-line-msie";this.cssLine_select="selected-line";this.cssLine_msie_editchange="editchange-line-msie";this.cssLine_editchange="editchange-line";this.mapeditor=null;this.initRes("RU");this.initialize()},GWTK.mapgeometry.prototype={initialize:function(){return this},count:function(a){return 0<a?this.subjects[a].points.length:this.points.length},
appendpoint:function(a,b,c){this._appendpoint(a,b,null,this.points.length,c)},insertpoint:function(a,b,c,d){this._appendpoint(a,b,null,c,d)},appendpoint3D:function(a,b,c,d){this._appendpoint(a,b,c,this.points.length,d)},insertpoint3D:function(a,b,c,d,e){this._appendpoint(a,b,c,d,e)},isdeletingpoint:function(){switch(this.mapobject.spatialposition){case "polygon":return 4>=this.points.length?!1:!0;case "linestring":return 2>=this.points.length?!1:!0;case "point":return!1}},deletepoint:function(a,b){void 0==
a||(null==a||0==this.points.length)||(void 0==b||null==b||0==b?this.points.splice(a,1):b<this.subjects.length&&this.subjects[b-1].points.splice(a,1))},closeobject:function(a){var b=this.count();if(a){if(4>b)return!1;this.points[0]=new GWTK.Point3D(this.points[b-1].x,this.points[b-1].y,this.points[b-1].h)}else{if(3>b)return!1;this._appendpoint(this.points[0].x,this.points[0].y,this.points[0].h,this.points.length,this.subject)}return!0},createcopy:function(a){if(!(!1==a instanceof GWTK.mapgeometry||
void 0==a||null==a)){for(var b=new GWTK.mapgeometry(a.mapobject,0,a.points),c=0;c<a.subjects;c++)b.addsubject(a.subjects[c],c+1);return b}},addsubject:function(a,b){if(!(!1==a instanceof GWTK.mapgeometry||void 0==a||null==a||void 0==b||null==b||0>=b)){var c=new GWTK.mapgeometry(a.mapobject,b,a.points,a.dimension,a.srsName);this.subjects.splice(b,0,c);return this}},clear:function(){this.points.splice(0,this.points.length);this.cleardraw();void 0!=this.mapdiv&&(null!=this.mapdiv&&null!=this.overlayPane)&&
($(this.drawpanel).children().remove(),void 0!=this.mapdiv&&null!=this.mapdiv&&this.mapdiv.removeChild(this.drawpanel),this.drawpanel=null)},cleardrawpoints:function(){if(this.drw_points)for(var a=0;a<this.drawpoints.length;a++)this.clearMark(this.drawpoints[a]);this.drawpoints.splice(0,this.drawpoints.length)},clearMark:function(a){null!=a&&(null!=this.drawpanel&&void 0!=this.drawpanel)&&this.drawpanel.removeChild(a.geopoint());return null},cutline:function(a,b){var c=this;void 0==b&&(b=0);0<b&&
this.subjects.length<=b&&(c=this.subjects[b-1]);var d=c.count();if(3<=c.count()&&1<a&&a<d&&c.points[0].x==c.points[d-1].x&&c.points[0].y==c.points[d-1].y){for(var d=[],e=a-1;e<c.count();e++)d.push(c.points[e].clone());for(e=1;e<a;e++)d.push(c.points[e].clone());c.points.splice(0,c.points.length);for(e=0;e<d.length;e++)c.points.push(d[e].clone())}},changedirection:function(a){var b=this;void 0==a&&(a=0);0<a&&this.subjects.length<=a&&(b=this.subjects[a]);b.count();a=[];for(var c=b.count()-1;0<=c;c--)a.push(b.points[c].clone());
b.points.splice(0,b.points.length);for(c=0;c<a.length;c++)b.points.push(a[c].clone())},cleardrawline:function(){var a=$("."+this.cssLine_msie);0!=a.length?$(this.drawpanel).children().remove("."+this.cssLine_msie):(a=$("."+this.cssLine),0!=a.length&&$(this.drawpanel).children().remove("."+this.cssLine));a=$("."+this.cssLine_msie_select);0!=a.length?$(this.drawpanel).children().remove("."+this.cssLine_msie_select):(a=$("."+this.cssLine_select),0!=a.length&&$(this.drawpanel).children().remove("."+this.cssLine_select));
a=$("."+this.cssLine_msie_editchange);0!=a.length?$(this.drawpanel).children().remove("."+this.cssLine_msie_editchange):(a=$("."+this.cssLine_editchange),0!=a.length&&$(this.drawpanel).children().remove("."+this.cssLine_editchange))},cleardraw:function(){this.cleardrawpoints();this.cleardrawline()},setDrawParam:function(a,b,c){void 0!=a&&null!=a&&(this.drw_select=a);void 0!=b&&null!=b&&(this.drw_points=b);void 0!=c&&null!=c&&(this.drw_centerpoints=c);for(var d=0;d<this.subjects;d++)this.subjects[d].setDrawParam(a,
b,c)},draw:function(a,b,c,d){this.drawcontour(a,b,c,d);for(var e=0;e<this.subjects;e++)this.subjects[e].drawcontour(a,b,c,d)},drawcontour:function(a,b,c,d){if(void 0==a||null==a)this.mapdiv=document.getElementById("overlayPane"),this.overlayPane=b?GWTK.DomUtil.create("div","selectobject-panel",this.mapdiv):GWTK.DomUtil.create("div","drawobject-panel",this.mapdiv),this.overlayPane.id="mosubject-overlayPane_"+this.subject,a=this.overlayPane;this.drawpanel=a;if(!(null==this.points||0==this.points.length)){if(void 0==
b||null==b)b=this.drw_select;if(void 0==c||null==c)c=this.drw_points;if(void 0==d||null==d)d=this.drw_centerpoints;a=[];var e=[],f,g,m,h,p=this.points.length,q=!0;if(4>p||this.points[0].x!=this.points[p-1].x||this.points[0].y!=this.points[p-1].y)q=!1;for(var r=0;r<p;r++){m=this.mapobject.maplayerid+"_"+this.mapobject.id+"_"+this.subject.toString()+"_"+r.toString();g="mop_"+m;a[0]=this.points[r].x;a[1]=this.points[r].y;f=GWTK.toLatLng(a);f=this._geo2pixelOffset(this.mapobject.map,f);g=0==r&&this.imgpointFirst&&
!q?new GWTK.placemarkEx(g,a,"","",this.imgpointFirst,GWTK.point(10,10),GWTK.point(-5,-8),this.imgpointCurrent):r==p-2&&q?new GWTK.placemarkEx(g,a,"","",this.imgpointLast,GWTK.point(10,10),GWTK.point(-5,-8),this.imgpointCurrent):r==p-1&&!q?new GWTK.placemarkEx(g,a,"","",this.imgpointLast,GWTK.point(10,10),GWTK.point(-5,-8),this.imgpointCurrent):r==p-1&&q?new GWTK.placemarkEx(g,a,"","",this.imgpointFirst,GWTK.point(10,10),GWTK.point(-5,-8),this.imgpointCurrent):new GWTK.placemarkEx(g,a,"","",this.imgpoint,
GWTK.point(10,10),GWTK.point(-5,-8),this.imgpointCurrent);g.position(f);f=h=null;0<this.drawpoints.length&&(h=this.drawpoints[this.drawpoints.length-1]);if(h){var s=h.realpoint,u=g.realpoint;d&&(e[0]=this.points[r-1].x+(this.points[r].x-this.points[r-1].x)/2,e[1]=this.points[r-1].y+(this.points[r].y-this.points[r-1].y)/2,h=this.calc_centerpoint(this.mapobject.map,e[0],e[1]),void 0!=h&&(m="mop_"+m+"_center",f=new GWTK.placemarkEx(m,e,"","",this.imgpointCenter,GWTK.point(10,10),GWTK.point(-5,-8),this.imgpointCurrent),
f.position(h)));m=this._setLineIdByPointId(g.geopoint().id,"curr");b&&(this.viewobject="select");null!=this.mapeditor&&this.mapeditor.ischange&&(this.viewobject="editchange");this._drawconturline(s,u,m,this.drawpanel,GWTK.point(0,0),this.viewobject)}c&&(0<this.drawpoints.length&&(d&&null!=f)&&this.drawpanel.appendChild(f.geopoint()),this.drawpanel.appendChild(g.geopoint()));0<this.drawpoints.length&&(d&&null!=f)&&this.drawpoints.push(f);this.drawpoints.push(g)}}},refreshdraw:function(){$("#mapeditingPopupmenu").hide();
if(!(null==this.drawpanel||void 0==this.drawpanel))if(this._restoredrawpanel(),0!=this.drawpoints.length){var a;a=[];var b=[],c,d=1;this.drw_centerpoints&&(d=2);for(var e=0;e<this.drawpoints.length;e+=d)a=this.drawpoints[e].latlong,a=GWTK.toLatLng(a),a=this._geo2pixelOffset(this.mapobject.map,a),this.drawpoints[e].position(a),2==d&&e>=d&&(a=this.drawpoints[e-d].latlong,c=this.drawpoints[e].latlong,b[0]=a[0]+(c[0]-a[0])/2,b[1]=a[1]+(c[1]-a[1])/2,a=this.calc_centerpoint(this.mapobject.map,b[0],b[1]),
void 0!=a&&this.drawpoints[e-1].position(a));this.cleardrawline();for(e=0;e<this.drawpoints.length-1;e+=d)a=this.drawpoints[e].realpoint,c=this.drawpoints[e+d].realpoint,b=this._setLineIdByPointId(this.drawpoints[e+d].geopoint().id,"curr"),this._drawconturline(a,c,b,this.drawpanel,GWTK.point(0,0),this.viewobject)}},calc_centerpoint:function(a,b,c){if(!(void 0==b||null==b||void 0==c||null==c))return a=[],a[0]=b,a[1]=c,b=GWTK.toLatLng(a),this._geo2pixelOffset(this.mapobject.map,b)},setSrsName:function(a){void 0==
a||null==a||(this.srsName=a)},pointsToXmlString:function(){if(0!=this.points.length){var a,b="",c,d=parseInt(this.dimension);switch(this.mapobject.spatialposition){case "polygon":for(var e=0;e<this.points.length;e++)b+=this.points[e].x.toString().replace(",",".")+" "+this.points[e].y.toString().replace(",",".")+" ",3==d&&(this.points[e].h||(this.points[e].h=0),b+=this.points[e].h.toString().replace(",",".")+" ");b=b.slice(0,-1);a='<gml:Polygon srsName="'+this.srsName+'"><gml:exterior><gml:LineString><gml:posList srsDimension="'+
this.dimension+'" count="'+this.points.length+'">'+b+"</gml:posList></gml:LineString></gml:exterior>";if(0<this.subjects.length)for(var f=0;f<this.subjects.length;f++)if(b="",c=this.subjects[f],!(void 0==v||null==c||0==c.points.length)){for(e=0;e<c.points.length;e++)b+=c.points[e].x.toString().replace(",",".")+" "+c.points[e].y.toString().replace(",",".")+" ",3==d&&(c.points[e].h||(c.points[e].h=0),b+=c.points[e].h.toString().replace(",",".")+" ");0!=b.length&&(b=b.slice(0,-1),a+='<gml:interior><gml:LineString><gml:posList srsDimension="'+
this.dimension+'" count="'+c.points.length+'">'+b+"</gml:posList></gml:LineString></gml:interior>")}a+="</gml:Polygon>";break;case "linestring":case "vector":for(e=0;e<this.points.length;e++)b+=this.points[e].x.toString().replace(",",".")+" "+this.points[e].y.toString().replace(",",".")+" ",3==d&&(this.points[e].h||(this.points[e].h=0),b+=this.points[e].h.toString().replace(",",".")+" ");b=b.slice(0,-1);a='<gml:LineString srsName="'+this.srsName+'"><gml:posList srsDimension="'+this.dimension+'" count="'+
this.points.length+'">'+b+"</gml:posList></gml:LineString>";break;case "curve":for(e=0;e<this.points.length;e++)b+=this.points[e].x.toString().replace(",",".")+" "+this.points[e].y.toString().replace(",",".")+" ",3==this.dimension&&(this.points[e].h||(this.points[e].h=0),b+=this.points[e].h.toString().replace(",",".")+" ");b=b.slice(0,-1);a='<gml:Curve srsName="'+this.srsName+'"><gml:segments><gml:LineStringSegment  srsDimension="'+this.dimension+'" count="'+this.points.length+'">'+b+"</gml:LineStringSegment>";
if(0<this.subjects.length)for(f=0;f<this.subjects.length;f++)if(b="",c=this.subjects[f],!(void 0==v||null==c||0==c.points.length)){for(e=0;e<c.points.length;e++)b+=c.points[e].x.toString().replace(",",".")+" "+c.points[e].y.toString().replace(",",".")+" ",3==d&&(c.points[e].h||(c.points[e].h=0),b+=c.points[e].h.toString().replace(",",".")+" ");0!=b.length&&(b=b.slice(0,-1),a+='<gml:LineStringSegment srsDimension="'+this.dimension+'" count="'+c.points.length+'">'+b+"</gml:LineStringSegment>")}a+="<gml:segments></gml:Curve>";
break;case "point":b=this.points[0].x.toString().replace(",",".")+" "+this.points[0].y.toString().replace(",","."),3==d&&(this.points[e].h||(this.points[e].h=0),b+=" "+this.points[0].h.toString().replace(",",".")),a='<gml:Point  srsName="'+this.srsName+'"><gml:pos srsDimension="'+this.dimension+'">'+b+"</gml:pos></gml:Point>"}return a}},initRes:function(a){switch(a){case "RU":this.res_close=window.close_RU}},_appendpoint:function(a,b,c,d,e){d=null==d||void 0==d||0>=d||d>=this.points.length?this.points.length:
d-1;a=new GWTK.Point3D(a,b,c);0<e?(e=e>=this.subjects.length?this.subjects.length:e-1,this.subjects[e]=new GWTK.mapgeometry(this,e),this.subjects[e].points.splice(d,0,a)):this.points.splice(d,0,a)},_drawconturline:function(a,b,c,d,e,f){var g;switch(f){case "select":f=this.cssLine_select;g=this.cssLine_msie_select;break;case "editchange":f=this.cssLine_editchange;g=this.cssLine_msie_editchange;break;default:f=this.cssLine,g=this.cssLine_msie}GWTK.routeUtil.drawLineWithIdToDivEx(a,b,c,d,e,f,g)},_restoredrawpanel:function(){this.drawpanel.style.width=
"1px";this.drawpanel.style.height="1px";this.drawpanel.style.left="0px";this.drawpanel.style.top="0px";this.drawpanel.style.cursor="default";$(this.drawpanel).mousedown=null;$(document).off("mousedown")},_isclosing:function(a){return"polygon"==this.mapobject.spatialposition&&(a==this.points.length-1||0==a)?!0:!1},_geo2pixelOffset:function(a,b){return GWTK.tileView.geo2pixelOffset(this.mapobject.map,b)},_setLineIdByPointId:function(a,b){if(!(void 0==a||null==a)){var c=a.split("_");if(!(null==c||6>
c.length)){var d;switch(b){case "curr":return a.replace("placemarkExdiv_mop","mol").replace("_center","");case "prev":d=parseInt(c[5])-1;break;case "next":d=parseInt(c[5])+1;break;default:return}return"mol_"+c[2]+"_"+c[3]+"_"+c[4]+"_"+d.toString()}}}},GWTK.extend=function(a,b){var c=function(){};c.prototype=b.prototype;a.prototype=new c;a.prototype.constructor=a;a.superclass=b.prototype},GWTK.getEvent=function(a){a||(a=window.event);a.srcElement&&(a.target=a.srcElement);return a},GWTK.Point3D=function(a,
b,c,d){this.x=d?Math.round(a):a;this.y=d?Math.round(b):b;void 0!=c&&null!=c&&(this.h=d?Math.round(c):c)},GWTK.extend(GWTK.Point3D,GWTK.Point),GWTK.Point3D.prototype={clone:function(){return new GWTK.Point3D(this.x,this.y,this.h)}},GWTK.point3D=function(a,b,c,d){return a instanceof GWTK.Point3D?a:GWTK.Util.isArray(a)?new GWTK.Point3D(a[0],a[1],a[2]):void 0===a||null===a?a:new GWTK.Point3D(a,b,c,d)});window.GWTK&&(GWTK.Map=function(a,b){this.divID=a;this.container={};this.options=b;this.mapLatLngBounds;this.mapcenter=this.mapBounds=null;this.layers=[];this.handlers=this.tiles=null;this.panes={};this.addressSearch=null;this.initialize();this.scaleUp=!1;this.placemarks=[];this.maptools=[]},GWTK.Map.prototype={initialize:function(){if(void 0==typeof this.divID)return this;this.initContainer(this.divID);null==GWTK.projection&&(GWTK.projection=GWTK.convert());null==GWTK.tileView&&(GWTK.tileView=GWTK.tileViewing());
if(!this.setOptions())return this;this.setWindowSize();this.initPanes();var a=new GWTK.LatLng(55.5635753,37.79762596),b=new GWTK.LatLng(56.20701529,38.91705927);this.mapLatLngBounds=GWTK.latLngBounds(a,b);this.setBounds();"maxBounds"in this.options&&this.setMaxBounds(this.options.maxBounds);this.initEvents();this._readCookie();if(!this.setView(null,this.options.center,this.options.tilematrix))return this;null==this.tiles&&(this.tiles=GWTK.layersControl(this));this.setAreaSearch();this.setLegend();
this.setLayers();this.setQueries();this.setScaleUI();this.setMapContentPanel();this.setTextSearch();this._readCookieOverlays();this._readCookiePanels();void 0!=$.browser&&($.browser.mozilla||$.browser.msie)&&$("input[type=text]").bind("mousedown.ui-disableSelection selectstart.ui-disableSelection",function(a){a.stopImmediatePropagation()});return this},setView:function(a,b,c){null!=b&&(this.options.center=GWTK.toLatLng(b));null!=c&&0<=c&&(this.options.tilematrix=c);null!=a&&this.setBounds(null,a);
this._setMapCenter();this.showMap();return!0},setViewport:function(a){null!=a&&(this.options.center=GWTK.toLatLng(a),this._setMapCenter(),this.showMap())},setMapCenter:function(a,b){if(!(void 0==a||null==a)){var c=GWTK.projection.xy2geo(this.options.crs,a.y,a.x);this.mapcenter=GWTK.point(a.x,a.y);this.options.center=GWTK.toLatLng(c);void 0!=b&&b&&this.showMap()}},_setMapCenter:function(){if(void 0==GWTK.projection||void 0==this.options)return null;var a=GWTK.projection.geo2xy(this.options.crs,this.options.center.lat,
this.options.center.lng);return this.mapcenter=GWTK.point(a[1],a[0])},_centeringPoint:function(a){if(void 0==a||null==a)return null},setZoom:function(a){null!=a&&(a=this.zoomLimit(a),this.options.tilematrix=a,this.setView(),this.overlayRefresh(),this.tilePane.className="tile-panel")},setScaleUI:function(){var a=parseInt(this.getZoomScale(this.options.tilematrix),10);this.panes.scalePane.innerHTML="1 : "+GWTK.Util.formatting(a,"")},getZoomScale:function(a){var b=0;if(void 0==a||null==a)return b;a=
this.zoomLimit(a);var c=GWTK.TileMatrixSets[this.options.tilematrixset];a<c.scales.length&&(b=c.scales[a]);return b},zooming:function(a,b){if(!(void 0==this.tiles||null==this.tiles)){if(0==a||void 0==a)a=1;if(void 0==b||null==b)return this.setZoom(parseInt(this.options.tilematrix,10)+a);var c=b,d=this.tiles.getLayersPointProjected(c),e=parseInt(this.options.tilematrix,10)+a,e=this.zoomLimit(e),f=this.getZoomScale(e);0!=f&&(GWTK.tileView.getpixelSpan(f,4326==this.options.crs),f=this.getWindowSize(),
f[0]/=2,f[1]/=2,GWTK.tileView.getTileLayerData(this.options.tilematrix,this,d),b=GWTK.tileView.getTileLayerData(e,this,d),a=GWTK.point(f[0]-c.x,f[1]-c.y),c=b[4]+a.x,d=b[5]+a.y,GWTK.tileView.shiftTiles(b,a),f=new GWTK.MapsProjection,f.init(e),c=f.pixel2Geo(GWTK.point(c,d)),c=[c.x,c.y],this.options.tilematrix=e,this.setViewport(c),this.overlayRefresh())}},zoomIn:function(a){return this.setZoom(parseInt(this.options.tilematrix,10)+parseInt(a||1,10))},zoomOut:function(a){return this.setZoom(parseInt(this.options.tilematrix,
10)-parseInt(a||1,10))},zoomLimit:function(a){if(void 0==this.options||void 0==this.options.tilematrixset)return null;var b=GWTK.TileMatrixSets[this.options.tilematrixset].scales.length,c=0;void 0!=this.options.maxzoom?b=this.options.maxzoom:b--;void 0!=this.options.minzoom?c=this.options.minzoom:c=0;a>b&&(a=b);a<c&&(a=c);return a},setMatrix:function(a){if(null!=a&&a in GWTK.TileMatrixSets){var b=GWTK.TileMatrixSets[a];this.options.tilematrixset=a;a=this.zoomLimit(this.options.zoom);this.setView(b.crs,
this.options.center,a)}},showMap:function(){this.tiles&&this.tiles.forceupdate();this.setScaleUI();return!0},setBounds:function(a,b){null==b&&null!=this.options.crs&&(b=this.options.crs);this.options.crs=b;null==a||void 0==typeof a?a=this.mapLatLngBounds:this.mapLatLngBounds=new GWTK.LatLngBounds(a);return this.mapBounds=null!=b?GWTK.projection.latLngBounds2Bounds(a,this.options.crs):null},setMaxBounds:function(a){null==a?this.options.maxBounds=null:(a=GWTK.latLngBounds(a),this.options.maxBounds=
a)},setOptions:function(){if(null==this.options||!("crs"in this.options&&"url"in this.options&&"tilematrixset"in this.options&&"tilematrix"in this.options&&"layers"in this.options&&"id"in this.options))return!1;this.options.center=GWTK.toLatLng(this.options.center);return!0},getMapTopLeft:function(){if(void 0==GWTK.tileView||null==GWTK.tileView)GWTK.tileView=GWTK.tileViewing();var a=this.getZoomScale(this.options.tilematrix),a=GWTK.tileView.getpixelSpan(a,4326==this.options.crs),b=this.getWindowSize();
return GWTK.point(this.mapcenter.x-b[0]*a/2,this.mapcenter.y+b[1]*a/2)},getMapBBox:function(){if(void 0==GWTK.tileView||null==GWTK.tileView)GWTK.tileView=GWTK.tileViewing();var a=this.getZoomScale(this.options.tilematrix),b=GWTK.tileView.getpixelSpan(a,4326==this.options.crs),c=this.getWindowSize(),a=c[0]*b/2,b=c[1]*b/2;return{min:[this.mapcenter.x-a,this.mapcenter.y-b],max:[this.mapcenter.x+a,this.mapcenter.y+b]}},setQueries:function(){if(null==this.options||!1=="url"in this.options)return!1;this.wmts=
new GWTK.wmts(this,this.onDataLoadedWmts);return!0},setWindowSize:function(a,b){if(void 0!=this.container){var c=$(this.container).width(),d=$(this.container).height();void 0==a||0==a?"width"in this.options?(a=this.options.width,$(this.container).width(a)):a=c:$(this.container).width(a);void 0==b||0==b?"height"in this.options?(b=this.options.height,$(this.container).height(b)):b=d:$(this.container).height(b);$(this.panes.eventPane).width(a);$(this.panes.mapPane).width(a);$(this.panes.eventPane).height(b);
$(this.panes.mapPane).height(b)}},getWindowSize:function(){return void 0==this.container?null:[$(this.container).width(),$(this.container).height()]},setLayers:function(){if(void 0==this.options||!this.options.layers)throw Error("Map layers not found.");var a,b=this.options.layers.length;if(0!=b){for(a=0;a<b;a++)"url"in this.options.layers[a]&&""!=this.options.layers[a].url&&(-1==this.options.layers[a].url.indexOf("http:")&&(this.options.layers[a].url=this.options.url+"?"+this.options.layers[a].url),
this.addLayer(this.options.layers[a]));this._readCookie("layers");this.tiles.drawWmsLayers()}},addLayer:function(a){var b=a.url.toLowerCase(),c="wms";0<=b.indexOf("%z")&&(0<=b.indexOf("%x")&&0<=b.indexOf("%y"))&&(c="wmts");"wms"==c?(this.tiles.setWms(),a=new GWTK.WmsLayer(this,a)):a=new GWTK.Layer(this,a);a.onAdd()},showLayersExclusively:function(a){if(a){var b=[],b=GWTK.Util.isArray(a)?b.concat(a):a.split(",");if(0!=b.length){for(a=0;a<this.layers.length;a++)if(null!=this.layers[a]){this.layers[a].hide();
void 0!=this.mapcontent&&null!=this.mapcontent&&this.mapcontent.setUnChecked(this.layers[a].xId);for(var c=0;c<b.length;c++)this.layers[a].idLayerWMTS==b[c]&&(this.layers[a].show(),void 0!=this.mapcontent&&null!=this.mapcontent&&this.mapcontent.setChecked(this.layers[a].xId))}this.tiles.forceupdate()}}},onDataLoadedWmts:function(a,b){var c=GWTK.maphandlers.map;if(void 0!=b&&"innerHTML"in b){b.innerHTML=a;var d=GWTK.Util.getResponseType(a);null!=d&&2==d.length&&"wmts_getfeatureinfo"==d[0]&&d[1]instanceof
HTMLDivElement?($(b).empty(),$(b).append('<div id="textsearch_container"><div id="textsearch_result"><span class="right:2px"></span><img class="panel-info-close  ui-widget-content" title="Close" src="'+GWTK.imgClose+'" onclick="javascript: GWTK.maphandlers.objectsPane_close_click();"></img></div>'),b.innerHTML+='<div id="featurelist" />'+d[1].outerHTML+"</div>",$(".panel-info-text-act").click(function(a){a&&a.currentTarget.href&&window.open(a.currentTarget.href,"_blank")}),$(c.objectsPane).fadeIn("slow",
function(){}),GWTK.DomUtil.removeClass(c.objectsPane,"hide"),c.overlayPane.appendChild(c.placemarks[0].geopoint())):($(c.objectsPane).fadeOut("slow",function(){}),b.innerHTML="",c.placemarks.splice(0,c.placemarks.length))}},setLegend:function(){if(this.options&&this.options.layers){var a,b=this.options.layers.length;for(a=0;a<b;a++)if(this.options.layers[a].legend){var c=this.options.layers[a].legend;"url"in this.options.layers[a]&&""!=this.options.layers[a].url&&-1==this.options.layers[a].url.indexOf("http:")&&
(this.options.layers[a].url=this.options.url+"?"+this.options.layers[a].url);var d=this.options.layers[a].url,e=this.options.layers[a].url.indexOf("?");-1!==e&&(d=d.slice(0,e));e=GWTK.Util.getParamsFromURL(this.options.layers[a].url);if("layer"in e)e=e.layer;else if("layers"in e)e=e.layers;else continue;d=new WfsQueries(d);this.tiles.legendWfs.push(d);d.context=this.options.layers[a].id;d.onDataLoad=GWTK.Util.onLegendDataLoaded;"*"!=c?d.sendRequest({method:"createLegend",layer:e,width:"16",objlocal:"0,1,2,4",
typenames:c}):d.sendRequest({method:"createLegend",layer:e,width:"16",objlocal:"0,1,2,4"})}}},setMapContentPanel:function(){if(0==$(this.mapContentPane).find("#MapContent").length&&(void 0==this.mapcontent||null==this.mapcontent))this.mapcontent=new GWTK.MapContentControl(this.mapContentPane)},initContainer:function(a){if(void 0==(this.container=document.getElementById(a)))throw Error("Map container not found.");},destroy:function(){this.container.removeChild(this.mapPane)},initPanes:function(){var a=
this.panes={};this.mapPane=a.mapPane=this.createPane("map-panel",this.container);this.mapPane.id="mapPane";this.tilePane=a.tilePane=this.createPane("tile-panel",this.mapPane);this.tilePane.id="tilePane";this.eventPane=a.eventPane=this.createPane("event-panel cursor-dragging",this.mapPane,"eventPane");this.eventPane.id="eventPane";this.eventPane.setAttribute("unselectable","on");a.scalerPane=this.createPane("panel-scaler",this.mapPane);var b=GWTK.DomUtil.create("div","control-button control-button-plus clickable",
a.scalerPane);b.id="scaler_button-plus";b.title="\u0423\u0432\u0435\u043b\u0438\u0447\u0438\u0442\u044c \u0438\u0437\u043e\u0431\u0440\u0430\u0436\u0435\u043d\u0438\u0435";b=GWTK.DomUtil.create("div","control-button control-button-minus clickable",a.scalerPane);b.id="scaler_button-minus";b.title="\u0423\u043c\u0435\u043d\u044c\u0448\u0438\u0442\u044c \u0438\u0437\u043e\u0431\u0440\u0430\u0436\u0435\u043d\u0438\u0435";a.toolbarPane=this.createPane("toolbar-panel",this.mapPane);$(this.panes.toolbarPane).draggable({containment:"parent",
distance:2});if("controls"in this.options)for(var c=0;c<this.options.controls.length;c++)"ruler"==this.options.controls[c]&&(b=GWTK.DomUtil.create("div","control-button control-button-ruler control-button-radio clickable",a.toolbarPane),b.id="panel_button-ruler",b.title="\u0418\u0437\u043c\u0435\u0440\u0438\u0442\u044c \u0440\u0430\u0441\u0441\u0442\u043e\u044f\u043d\u0438\u0435 \u043f\u043e \u043a\u0430\u0440\u0442\u0435");else this.options.controls=["ruler","textsearchinmap"];a.scalePane=this.createPane("panel-mapscale panel-leftbottom",
this.mapPane);a.coordPane=this.createPane("panel-mapcoord",this.mapPane);a.mapContentPane=this.createPane("map-contents-panel map-panel-def hide",a.mapPane);a.mapContentPane.id="contentPane";this.mapContentPane=a.mapContentPane;this.overlayPane=a.overlayPane=this.createPane("overlay-panel",a.mapPane);this.overlayPane.id="overlayPane";this.underlayPane=a.underlayPane=this.createPane("underlay-panel",a.mapPane);this.underlayPane.id="underlayPane";this.drawPane=this.createPane("draw-panel",a.mapPane);
this.drawPane.id="drawPane";a.textSearchPane=this.createPane("map-contents-panel map-panel-def hide",a.mapPane);this.textSearchPane=a.textSearchPane;this.textSearchPane.id="searchPane";this.objectsPane=a.objectsPane=this.createPane("objects-panel map-panel-def hide",this.mapPane);this.objectsPane.id="objPane";this.setTextSearchResPane()},createPane:function(a,b){return GWTK.DomUtil.create("div",a,b||this.panes.mapPane)},clearPanes:function(){this.container.removeChild(this.mapPane)},initEvents:function(){if(null==
this.handlers){this.handlers=GWTK.handlers(this);var a=this.panes.eventPane;if(null!=a){$(a).on("click",this.handlers.mapclick);$(a).on("mousewheel DOMMouseScroll wheel MozMousePixelScroll",this.handlers.mousewheelscaling);$(a).on("mousedown",this.handlers.mapmousedown);$(a).on("mouseup",this.handlers.mapmouseup);$(a).on("mousemove",this.handlers.mapmove);$(a).on("mouseout",this.handlers.mouseout);GWTK.browserSafariForiOS&&(a.setAttribute("ontouchstart","javascript: GWTK.maphandlers.touchStart(event);"),
a.setAttribute("ontouchmove","javascript:  GWTK.maphandlers.touchMove(event);"),a.setAttribute("ontouchend","javascript:  GWTK.maphandlers.touchEnd(event);"));a=$("#scaler_button-plus");$(a).on("click",this.handlers.zoominclick);a=$("#scaler_button-minus");$(a).on("click",this.handlers.zoomoutclick);$(window).resize(this.handlers.mapresize);if("controls"in this.options&&(a=$(this.panes.toolbarPane).find("#panel_button-ruler"),0!=a.length))a.on("click",this.handlers.ruler_button_click);a=GWTK.DomUtil.create("div",
"control-button control-button-polygon-area control-button-radio clickable",this.panes.toolbarPane);a.id="panel_button-polygonarea";a.title="\u041f\u043b\u043e\u0449\u0430\u0434\u044c \u043f\u043e\u043b\u0438\u0433\u043e\u043d\u0430";$(a).on("click",this.handlers.polygonArea_button_click);a=GWTK.DomUtil.create("div","control-button control-button-frame control-button-radio clickable",this.panes.toolbarPane);a.id="panel_button_select_rect";a.title="\u041f\u043e\u0438\u0441\u043a \u043f\u043e \u043e\u0431\u043b\u0430\u0441\u0442\u0438";
$(a).on("click",this.handlers.selectAreaRect_button_click);a=GWTK.DomUtil.create("div","control-button control-button-search clickable",this.panes.toolbarPane);a.id="panel_button_search";a.title="\u041f\u043e\u0438\u0441\u043a";$(a).on("click",this.handlers.toolbar_button_click);a._pane=this.panes.textSearchPane.id;a=GWTK.DomUtil.create("div","control-button control-button-content clickable",this.panes.toolbarPane);a.id="panel_button_content";a.title="\u0421\u043e\u0441\u0442\u0430\u0432 \u043a\u0430\u0440\u0442\u044b";
a._pane=this.panes.mapContentPane.id;$(a).on("click",this.handlers.toolbar_button_click);a=GWTK.DomUtil.create("div","control-button control-button-table clickable",this.panes.toolbarPane);a.id="panel_button_table";a.title="\u0412\u044B\u0432\u043E\u0434\u0020\u0442\u0430\u0431\u043B\u0438\u0446\u044B";$(a).on("click",this.handlers.toolbar_button_click);$(this.objectsPane).on("click",$(".panel-info-img-search"),this.handlers.featurelist_click);$(this.objectsPane).on("click",$(".panel-pagination-button-left"),this.handlers.textsearch_prev_click);$(this.objectsPane).on("click",$(".panel-pagination-button-right"),this.handlers.textsearch_next_click)}}},mapTool:function(a){if(!this.maptools||0==this.maptools.length)return null;for(i in this.maptools)if(void 0!==
this.maptools[i].toolname&&this.maptools[i].toolname==a)return this.maptools[i];return null},setAreaSearch:function(){var a,b=this.options.layers.length,c=!1;if(0!=b){for(a=0;a<b;a++)if("selectObject"in this.options.layers[a]&&1===this.options.layers[a].selectObject){c=!0;break}c||$(this.panes.toolbarPane).find("#panel_button_select_rect").hide()}},setTextSearch:function(){0==$(this.textSearchPane).find("#inputSearchText").length&&(new GWTK.TextSearchControl(this.textSearchPane),this.mapTextSearch=
new GWTK.mapTextSearch(this),"url_addresssearch"in this.options&&(2==this.options.url_addresssearch.length&&0!=this.options.url_addresssearch[0].length)&&(this.addressSearch=new GWTK.addressSearch(this),this.addressSearch.set_pane()))},setTextSearchResPane:function(){if(!(void 0==this.objectsPane||null==this.objectsPane)){var a=$(".panel-pagination-container");$(this.objectsPane).empty();$(this.objectsPane).append('<div id="textsearch_container"><div id="textsearch_result"><span class="right:2px"></span><img class="panel-info-close  ui-widget-content" title="Close" src="'+
GWTK.imgClose+'" onclick="javascript: GWTK.maphandlers.objectsPane_close_click();"></img></div><div id="featurelist" class="map-featurelist-panel" /></div>');0<a.length?$(this.objectsPane).append(a[0]):this.setTextSearchPagerPane()}},setTextSearchPagerPane:function(){var a=$(this.objectsPane).find("#textsearch_container");0!=a.length&&$(a[0]).append('<div class="panel-pagination-container" id="listlink" ><div id="pagination" class="panel-pagination"><span id="pagination_result">\u0420\u0435\u0437\u0443\u043b\u044c\u0442\u0430\u0442\u044b \u0441 <span>1</span> \u043f\u043e <span>10</span></span><span><span class="panel-pagination-button-left"> < </span><span class="panel-pagination-button-right"> > </span><a href="*" id="fulllist" class="panel-textsearch-full" onclick="GWTK.maphandlers.map.mapTextSearch.textSearchFull();">\u041f\u043e\u043a\u0430\u0437\u0430\u0442\u044c \u0432\u0441\u0435</a></span></div></div>')},
_readCookie:function(a){if(null!=this.options){var b=GWTK.cookie(GWTK.cookies.getKey(),GWTK.cookies.converter);if(void 0!==b){var c={};$.each(b,function(a,b){var f=b.shift(),g=0<b.length?b.shift():"";"id"===f?c.id=g:"center"===f?c.center=GWTK.toLatLng(g.split(",")):"z"===f?c.tilematrix=g:"layers"===f&&(c.ids=g.split(","))});if(0!=c.length&&!(!1=="id"in c||c.id!==this.options.id))!a||"layers"!==a?("tilematrix"in c&&(this.options.tilematrix=c.tilematrix),"center"in c&&(this.options.center=c.center),
(void 0!=c.tilematrix||void 0!=c.center)&&this.setView(null,this.options.center,this.options.tilematrix)):"layers"===a&&null!=this.tiles&&this.tiles.setVisibleLayers(c.ids)}}},_readCookieOverlays:function(){var a=GWTK.cookie(GWTK.rulercookiename(),GWTK.cookies.converter);$.isArray(a)&&(this.createRuler(),this.ruler.restore(a[0].shift()))},_readCookiePanels:function(){var a=GWTK.cookie("VisiblePanels",GWTK.cookies.converter);void 0!==a&&$.each(a,function(a,c){var d=c.shift(),e=0<c.length?c.shift():
"",e=e.split(",");button=$("#"+d);void 0!=button[0]&&(panel=button[0]._pane,"show"==e[0]?(button.addClass("control-button-active"),GWTK.maphandlers.map.setMapContentPanel(),panel&&$("#"+panel).show()):button.hasClass("control-button-active")&&(button.removeClass("control-button-active"),panel&&$("#"+panel).hide()),null!=e[1]&&($("#addressSearchAction")[0].checked=!0,d={},d.currentTarget=$("#addressSearchAction")[0],GWTK.addressSearch.prototype.addressSearchAction_change(d)))})},_writeCookiePanels:function(){var a=
$(".toolbar-panel .control-button"),b="";$.each(a,function(){"panel_button_search"==this.id&&(b=$(this).hasClass("control-button-active")?b+"&"+this.id+"=show":b+"&"+this.id+"=hide");"panel_button_content"==this.id&&(b=$(this).hasClass("control-button-active")?b+"&"+this.id+"=show":b+"&"+this.id+"=hide",!0==$("#addressSearchAction")[0].checked&&(b+=",cheked"));"panel_button-mapRoute"==this.id&&(b=$(this).hasClass("control-button-active")?b+"&"+this.id+"=show":b+"&"+this.id+"=hide");"panel_button-mapRosreestr"==
this.id&&(b=$(this).hasClass("control-button-active")?b+"&"+this.id+"=show":b+"&"+this.id+"=hide");"panel_button-mapEditor"==this.id&&(b=$(this).hasClass("control-button-active")?b+"&"+this.id+"=show":b+"&"+this.id+"=hide")});""!=b&&GWTK.cookie("VisiblePanels",b)},_writeCookie:function(){if(null!=this.options){var a,b=this.layers.length,c=[];for(a=0;a<b;a++)this.layers[a].getVisibility()||c.push(this.layers[a].xId);c=0<c.length?c.join(","):"-1";a=["id="+this.options.id,"center="+[this.options.center.lat,
this.options.center.lng].join(),"z="+this.options.tilematrix,"layers="+c];a=a.join("&");GWTK.cookie("",a,{expires:5,path:"/"})}},_getFeatureInfo:function(a,b,c,d,e,f){this.wmts.enabled&&this.wmts.getFeatureInfo(a,b,c,d,e,f)},getFeatureInfo:function(a){if(this.wmts.enabled){a=this.tiles.getLayersPointTile(a);var b=this.tiles.getSelectableLayers();if(0===b.length)return!1;this.wmts.getFeatureInfo(b,a[0],a[1],a[2],a[3])}},overlayAppend:function(a,b,c,d,e,f){a=new GWTK.placemark(a);e?a.setImage(b,e,f):
a.position(b);void 0!=c&&c&&null!=this.overlayPane&&this.overlayPane.appendChild(a.geopoint());void 0!=d&&0!=d.length&&(a.id=d);this.placemarks.push(a)},overlayClear:function(){for(var a=0;a<this.overlayPane.childNodes.length;a++)if("placemark"===this.overlayPane.childNodes[a].className||"placemark placemark-topmost"===this.overlayPane.childNodes[a].className)this.overlayPane.removeChild(this.overlayPane.childNodes[a]),a--;this.panes.overlayPane.style.left="0px";this.panes.overlayPane.style.top="0px"},
overlayRefresh:function(){this.overlayClear();if(this.placemarks&&0!=this.placemarks.length){for(var a in this.placemarks){var b=this.placemarks[a].latlong;void 0!==b&&(b=GWTK.tileView.geo2pixelOffset(this,b),this.placemarks[a].position(b),this.overlayPane.appendChild(this.placemarks[a].geopoint()))}$(this.overlayPane).slideDown()}this.polygonArea?this.polygonArea.refresh():this.ruler&&this.ruler.refresh();this.overlayPane&&$(this.overlayPane).trigger({type:"overlayRefresh"})},placemarkRemove:function(){for(var a=
0;a<this.overlayPane.childNodes.length;a++)if("placemark"===this.overlayPane.childNodes[a].className||"placemark placemark-topmost"===this.overlayPane.childNodes[a].className)this.overlayPane.removeChild(this.overlayPane.childNodes[a]),a--;this.placemarks.splice(0,this.placemarks.length)},overlayRemove:function(){this.overlayClear();this.placemarks.splice(0,this.placemarks.length);null!=this.ruler&&this.ruler.clear()},move:function(a,b){var c=parseInt(this.panes.tilePane.style.left,10);isNaN(c)&&
(c=0);var d=parseInt(this.panes.tilePane.style.top,10);isNaN(d)&&(d=0);this.panes.tilePane.style.left=c+a+"px";this.panes.tilePane.style.top=d+b+"px";c=parseInt(this.panes.overlayPane.style.left,10);isNaN(c)&&(c=0);d=parseInt(this.panes.overlayPane.style.top,10);isNaN(d)&&(d=0);this.panes.overlayPane.style.left=c+a+"px";this.panes.overlayPane.style.top=d+b+"px";c=parseInt(this.panes.underlayPane.style.left,10);isNaN(c)&&(c=0);d=parseInt(this.panes.underlayPane.style.top,10);isNaN(d)&&(d=0);this.panes.underlayPane.style.left=
c+a+"px";this.panes.underlayPane.style.top=d+b+"px"},createRuler:function(){"ruler"in this&&null!=this.ruler||(this.ruler=new GWTK.ruler(this))},removePathRuler:function(){this.ruler&&null!=this.ruler&&(this.ruler.clear(),this.ruler.activate())},destroyRuler:function(){this.ruler=null},resetMap:function(a,b){if(!a||!a.layers||0==a.layers.length)return!1;var c=this.layers.length,d,e=[],f,c=a.layers.length;for(d=0;d<c;d++)(f=this.tiles.getLayerByxId(a.layers[d].id))?this.refreshLayer(a.layers[d]):(this.options.layers.push(a.layers[d]),
this.addLayer(a.layers[d]));if(b){"*"===b&&this.getLayersId();e=GWTK.Util.isArray(b)?b:[b];c=e.length;for(d=0;d<c;d++)if(f=this.tiles.getLayerByxId(e[d]))f.onRemove(),f=GWTK.Util.indexOf(this.layers,f),-1!==f&&(this.layers.splice(f,1),this.options.layers.splice(f,1))}a.center&&(this.options.center=GWTK.toLatLng(a.center),this._setMapCenter());a.tilematrix&&(this.options.tilematrix=a.tilematrix);this.tiles.forceupdate();this.setLegend();"url"in a&&(this.options.url=a.url,this.wmts=null,this.setQueries(),
void 0!==GWTK.featureSearch&&(GWTK.featureSearch=null),GWTK.selectFeatures(this),this.setAreaSearch(),this.mapTextSearch=null,$(this.textSearchPane).empty(),this.setTextSearch());this.options.mapcontenttree=a.mapcontenttree?a.mapcontenttree:"";0!=$(this.mapContentPane).find("#MapContent").length&&(this.mapcontent.destroy(),$(this.mapContentPane).empty(),this.mapcontent=null);this.setMapContentPanel()},getLayersId:function(){var a=[],b=this.layers.length;if(0===b)return a;for(;n<b;n++)a.push(this.layers[0].xId);
return a.toString()},refreshLayer:function(a){var b=-1,c;for(c in this.options.layers)if(null!=this.options.layers[c]&&this.options.layers[c].id==a.id){b=c;break}if(-1!=b)if(this.options.layers[b]=a,c=a.url.toLowerCase(),b="wms",maplay=this.tiles.getLayerByxId(a.id),maplay.options=a,0<=c.indexOf("%z")&&(0<=c.indexOf("%x")&&0<=c.indexOf("%y"))&&(b="wmts"),"wms"==b){if(this.tiles.setWms(),maplay.setOptions(),0!=this.tiles.wmsManager.count()){$(this.tiles.wmsManager.panel).find(".wms-image").toggle(!1);
a=this.tiles.wmsManager.count();var d;for(c=0;c<a;c++)if(d=this.tiles.wmsManager.ids[c].list,this.tiles.wmsManager.getLayersParam(c),b=$(this.tiles.wmsManager.parent).find("#"+this.tiles.wmsManager.ids[c].div),0!=b.length&&(b=b.find(".wms-image"),0!=b.length&&(d=this.tiles.wmsManager.map.tiles.getLayerByxId(d[0].xId))))d=d.buildGetMap(),0==d.length&&(d=this.tiles.wmsManager.errorImage),b[0].src=d;this.tiles.wmsManager.view_refresh=!1;this.tiles.wmsManager.adjustPosition();this.tiles.wmsManager.panel.style.left=
this.tiles.wmsManager.tempContainer.style.left;this.tiles.wmsManager.panel.style.top=this.tiles.wmsManager.tempContainer.style.top;this.tiles.wmsManager.copyToTempImage()}}else maplay.setOptions()}});
